# AIアシスタント設定変更方法

## 概要
AIアシスタントの動作や口調を変更したい場合の編集方法を説明します。

## 編集するファイル

**ファイルパス**: `functions/src/index.ts`

**編集する箇所**: `chatWithGemini`関数内の`systemPrompt`変数

## 編集手順

### 1. ファイルを開く
```
functions/src/index.ts
```

### 2. `systemPrompt`変数を探す
約206行目あたりに以下のようなコードがあります：

```typescript
const systemPrompt = `あなたは社内の人事・給与システムに関する質問に答えるAIアシスタントです。

【重要】このアプリで対応している機能と対応していない機能を正確に理解し、回答してください。
...
`;
```

### 3. プロンプトを編集
`systemPrompt`変数内のテキストを編集することで、AIアシスタントの動作を変更できます。

### 4. ビルドとデプロイ
編集後、以下のコマンドでビルドとデプロイを行います：

```bash
# プロジェクトルートで実行
cd functions
npm run build
npm run lint
cd ..
firebase deploy --only functions:chatWithGemini
```

## よくある設定変更例

### 口調を変更する場合

**フォーマルな敬語口調に固定する場合：**
```typescript
- 【重要】常にフォーマルな敬語口調で回答してください。
  ため口、ラッパー口調、カジュアルな口調は一切使用しないでください。
  常に「です・ます調」の丁寧な敬語を使用してください。
```

**カジュアルな口調にする場合：**
```typescript
- 親しみやすい、カジュアルな口調で回答してください。
```

### 回答の長さを変更する場合

**簡潔に回答する場合：**
```typescript
- 回答は簡潔に、要点をまとめて説明してください。
```

**詳しく回答する場合：**
```typescript
- 回答は詳しく、具体例を含めて説明してください。
```

### 機能範囲を変更する場合

**対応している機能を追加：**
```typescript
【このアプリで対応している機能】

1. 各種申請手続き：
   - 入社時申請
   - 扶養家族追加申請
   - ...
   - 新しい申請タイプ  // ← 追加
```

**対応していない機能を追加：**
```typescript
【このアプリで対応していない機能】

- 雇用保険の申請・手続き
- 雇用保険の給付金申請
- 新しい非対応機能  // ← 追加
```

### 重要な情報を追加する場合

**新しい情報セクションを追加：**
```typescript
【重要な情報（正確に回答すること）】

基礎年金番号について：
- 基礎年金番号は10桁の数字で構成されています
...

新しい情報について：  // ← 追加
- 新しい情報の説明
```

## プロンプトの構造

現在のプロンプトは以下の構造になっています：

1. **役割の定義** - AIアシスタントの役割を説明
2. **機能範囲の定義** - 対応している機能と対応していない機能
3. **回答時の注意事項** - 回答方法のガイドライン
4. **重要な情報** - 正確に回答すべき情報

## 注意事項

- プロンプトを変更した後は、必ずビルドとデプロイを行ってください
- プロンプトが長すぎると、AIの応答が遅くなる可能性があります
- 変更後は、必ずテストを行って動作を確認してください
- 重要な変更は、バックアップを取ってから行うことを推奨します

## トラブルシューティング

### デプロイエラーが発生した場合

1. リンターエラーを確認：
   ```bash
   cd functions
   npm run lint
   ```

2. ビルドエラーを確認：
   ```bash
   npm run build
   ```

3. エラーメッセージを確認して修正

### 変更が反映されない場合

1. デプロイが成功したか確認
2. ブラウザのキャッシュをクリア
3. 数分待ってから再度テスト

## 参考

- システムプロンプトの場所: `functions/src/index.ts` (約206行目)
- デプロイコマンド: `firebase deploy --only functions:chatWithGemini`
- ビルドコマンド: `cd functions && npm run build`

