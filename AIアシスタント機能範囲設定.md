# AIアシスタント機能範囲設定

## 概要
AIアシスタントがアプリの実際の機能に合わせて回答するように、システムプロンプトを改善しました。

## 改善内容

### 対応している機能を明確に定義

システムプロンプトに以下の情報を追加しました：

#### 1. 各種申請手続き（従業員画面の「各種申請」タブ）
- 入社時申請
- 扶養家族追加申請
- 扶養削除申請
- 住所変更申請
- 氏名変更申請
- 産前産後休業申請
- 退職申請

#### 2. 情報照会（従業員画面の「情報照会」タブ）
- 個人情報の確認
- 住所情報の確認
- 扶養家族情報の確認

#### 3. 保険・扶養（従業員画面の「保険・扶養」タブ）
- 健康保険情報の確認
- 厚生年金情報の確認
- 扶養家族情報の確認

#### 4. 給与関連（給与担当者画面）
- 給与計算
- 賞与計算
- 社会保険料計算

### 対応していない機能を明確に定義

以下の機能については、アプリでは対応していないことを明確に伝えるように設定しました：

- 雇用保険の申請・手続き
- 雇用保険の給付金申請
- その他、上記の「対応している機能」に記載されていない申請・手続き

## 回答時の動作

### 対応している機能について質問された場合
- アプリ内のどのタブから操作できるかを具体的に説明
- 申請手続きの流れを分かりやすく説明
- 必要な書類や情報があれば説明

### 対応していない機能について質問された場合
- 「申し訳ございませんが、このアプリでは[機能名]には対応していません」と明確に伝える
- 必要に応じて「人事部門に直接お問い合わせください」と促す
- 一般的な情報を提供する場合は、「このアプリでは対応していませんが、一般的には...」と前置きする

## 実装方法

システムプロンプトを`functions/src/index.ts`の`chatWithGemini`関数内で設定しています。

### プロンプトの構造

```
1. 役割の定義
2. 【重要】機能範囲の理解を促す
3. 【このアプリで対応している機能】- 詳細な機能一覧
4. 【このアプリで対応していない機能】- 非対応機能の明示
5. 【回答時の注意事項】- 回答方法のガイドライン
```

## 今後の拡張方法

### 新しい機能を追加した場合

1. `functions/src/index.ts`のシステムプロンプトを更新
2. 「対応している機能」セクションに新しい機能を追加
3. 必要に応じて「対応していない機能」セクションを更新
4. 関数を再デプロイ

### 例：雇用保険の申請機能を追加した場合

```typescript
// システムプロンプト内の「対応している機能」セクションに追加
1. 各種申請手続き：
   - 入社時申請
   - 扶養家族追加申請
   - ...
   - 雇用保険の申請・手続き  // ← 追加
```

## テスト方法

### 対応している機能のテスト
1. 「健康保険について教えてください」と質問
2. アプリ内の「保険・扶養」タブについて説明されることを確認

### 対応していない機能のテスト
1. 「雇用保険の申請について教えてください」と質問
2. 「このアプリでは対応していません」と明確に伝えられることを確認
3. 人事部門への問い合わせを促されることを確認

## 注意事項

- システムプロンプトは長すぎると、AIの応答が遅くなる可能性があります
- 機能一覧は定期的に見直し、アプリの更新に合わせて更新してください
- プロンプトの変更後は、必ずテストを行って動作を確認してください

## 参考

- システムプロンプトの場所: `functions/src/index.ts` (line 206-260)
- デプロイコマンド: `firebase deploy --only functions:chatWithGemini`

