# Gemini APIキー設定 - コマンド実行手順

## 前提条件
- Firebase CLIがインストールされていること
- Firebaseにログインしていること

## 手順

### ステップ1: Firebaseにログイン（未ログインの場合）

```bash
firebase login
```

ブラウザが開くので、Googleアカウントでログインしてください。

### ステップ2: プロジェクトルートに移動

```bash
cd C:\Users\takashi.izhitsu_path\Desktop\SIApp
```

### ステップ3: Firebase Secretsで環境変数を設定

```bash
firebase functions:secrets:set GEMINI_API_KEY
```

**実行時の操作：**
1. コマンドを実行すると、以下のプロンプトが表示されます：
   ```
   ? Enter a value for GEMINI_API_KEY:
   ```
2. 以下のAPIキーをコピー＆ペーストしてEnterキーを押してください：
   ```
   AIzaSyCUiMgoBgUJl8NSgzPdWz3i0ubuyMjx2Po
   ```
3. 確認プロンプトが表示されたら、`y`を入力してEnterキーを押してください

**注意：** APIキーは画面に表示されないので、慎重に入力してください。

### ステップ4: 関数を再デプロイ

環境変数を設定した後、関数を再デプロイする必要があります：

```bash
firebase deploy --only functions:chatWithGemini
```

**重要：** コードを修正してFirebase Secretsに対応したため、必ず再デプロイしてください。

### ステップ5: 動作確認

1. アプリを開いて「ナレッジ」タブをクリック
2. チャット機能をテスト
3. 質問を入力して、AIアシスタントからの応答を確認

## コマンド一覧（コピー＆ペースト用）

以下のコマンドを順番に実行してください：

```bash
# 1. ログイン確認（必要に応じて）
firebase login

# 2. プロジェクトルートに移動
cd C:\Users\takashi.izhitsu_path\Desktop\SIApp

# 3. 環境変数を設定（対話的にAPIキーを入力）
#    プロンプトが表示されたら、以下を入力：
#    AIzaSyCUiMgoBgUJl8NSgzPdWz3i0ubuyMjx2Po
firebase functions:secrets:set GEMINI_API_KEY

# 4. 関数を再デプロイ（重要：必ず実行してください）
firebase deploy --only functions:chatWithGemini
```

## 注意事項

- `firebase functions:secrets:set`コマンドは対話的なので、プロンプトが表示されたらAPIキーを入力してください
- APIキーは画面に表示されないので、慎重に入力してください
- 環境変数を設定した後は、必ず関数を再デプロイしてください

## トラブルシューティング

### エラー: "firebase: command not found"
- Firebase CLIがインストールされていない可能性があります
- 以下のコマンドでインストール：
  ```bash
  npm install -g firebase-tools
  ```

### エラー: "Please login to continue"
- `firebase login`を実行してログインしてください

### エラー: "Gemini API key is not configured"
- 環境変数が正しく設定されているか確認してください
- 関数を再デプロイしたか確認してください
- Firebase Functionsのログを確認してください：
  ```bash
  firebase functions:log --only chatWithGemini
  ```

