<div class="dashboard-wrapper">
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header class="dashboard-header">
    <div class="header-left">
      <h1 class="app-name">SIApp</h1>
    </div>
    <div class="header-right">
      <span class="employee-info">
        <span class="employee-number">ç¤¾å“¡ç•ªå·: {{ employeeNumber }}</span>
        <span class="employee-name">{{ employeeName }}</span>
      </span>
      <button class="logout-button" (click)="logout()" [attr.disabled]="isSubmittingOnboardingApplication ? '' : null" [title]="isSubmittingOnboardingApplication ? 'ç”³è«‹ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚' : ''">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
    </div>
  </header>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ -->
  <div class="dashboard-body">
    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <button
          *ngFor="let tab of tabs"
          class="sidebar-item"
          [class.active]="currentTab === tab.name"
          (click)="switchTab(tab.name)"
          [attr.disabled]="isSubmittingOnboardingApplication ? '' : null"
          [title]="isSubmittingOnboardingApplication ? 'ç”³è«‹ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚' : ''"
        >
          {{ tab.name }}
        </button>
      </nav>
    </aside>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="main-content">
      <div class="content-area">
        <!-- æƒ…å ±ç…§ä¼šãƒšãƒ¼ã‚¸ -->
        <ng-container *ngIf="currentTab === 'æƒ…å ±ç…§ä¼š'">
          <div class="page-header">
            <h2 class="page-title">ç¤¾å“¡æƒ…å ±</h2>
          </div>

          <form [formGroup]="settingsForm" class="settings-form">
            
            <!-- åŸºæœ¬æƒ…å ±æ¬„ -->
            <section class="form-section">
              <h3 class="section-title">åŸºæœ¬æƒ…å ±</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="lastName">å§“</label>
                  <input 
                    type="text" 
                    id="lastName" 
                    formControlName="lastName" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="firstName">å</label>
                  <input 
                    type="text" 
                    id="firstName" 
                    formControlName="firstName" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="lastNameKana">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
                  <input 
                    type="text" 
                    id="lastNameKana" 
                    formControlName="lastNameKana" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="firstNameKana">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
                  <input 
                    type="text" 
                    id="firstNameKana" 
                    formControlName="firstNameKana" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="birthDate">ç”Ÿå¹´æœˆæ—¥</label>
                  <div class="birth-date-container">
                    <input 
                      type="date" 
                      id="birthDate" 
                      formControlName="birthDate" 
                      class="form-input"
                      [readonly]="true"
                      (change)="onBirthDateChange()"
                    >
                    <span *ngIf="age !== null" class="age-display">ï¼ˆ{{ age }}æ­³ï¼‰</span>
                  </div>
                </div>
                <div class="form-group">
                  <label for="gender">æˆ¸ç±ä¸Šã®æ€§åˆ¥</label>
                  <select 
                    id="gender" 
                    formControlName="gender" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let g of genders" [value]="g">{{ g }}</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                  <input 
                    type="email" 
                    id="email" 
                    formControlName="email" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group full-width">
                  <label>æœ¬äººç¢ºèªæ›¸é¡æ·»ä»˜</label>
                  <div *ngIf="employeeData?.idDocumentFileUrl" class="file-info">
                    <a [href]="employeeData.idDocumentFileUrl" target="_blank" class="file-link">
                      {{ employeeData.idDocumentFile || 'æœ¬äººç¢ºèªæ›¸é¡ã‚’é–‹ã' }}
                    </a>
                  </div>
                  <div *ngIf="!employeeData?.idDocumentFileUrl" class="file-info">
                    <span class="no-file-message">æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“</span>
                  </div>
                </div>
              </div>
            </section>

            <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼æ¬„ -->
            <section class="form-section">
              <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼</h3>
              <div class="form-grid">
                <div class="form-group full-width">
                  <!-- <label for="myNumberPart1">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼</label> -->
                  <div class="my-number-container">
                    <div class="my-number-inputs">
                      <input 
                        type="text" 
                        id="myNumberPart1" 
                        [value]="getMyNumberDisplayValue(1)"
                        class="form-input my-number-part"
                        [readonly]="true"
                        maxlength="4"
                        (input)="formatMyNumberInput($event, 1)"
                        placeholder="0000"
                      >
                      <span class="my-number-separator">-</span>
                      <input 
                        type="text" 
                        id="myNumberPart2" 
                        [value]="getMyNumberDisplayValue(2)"
                        class="form-input my-number-part"
                        [readonly]="true"
                        maxlength="4"
                        (input)="formatMyNumberInput($event, 2)"
                        placeholder="0000"
                      >
                      <span class="my-number-separator">-</span>
                      <input 
                        type="text" 
                        id="myNumberPart3" 
                        [value]="getMyNumberDisplayValue(3)"
                        class="form-input my-number-part"
                        [readonly]="true"
                        maxlength="4"
                        (input)="formatMyNumberInput($event, 3)"
                        placeholder="0000"
                      >
                    </div>
                    <button 
                      type="button" 
                      class="toggle-button" 
                      (click)="toggleMyNumber()"
                    >
                      {{ showMyNumber ? 'éè¡¨ç¤º' : 'è¡¨ç¤º' }}
                    </button>
                  </div>
                </div>
                <div class="form-group full-width">
                  <label>ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰æ·»ä»˜</label>
                  <div *ngIf="employeeData?.myNumberCardFileUrl" class="file-info">
                    <a [href]="employeeData.myNumberCardFileUrl" target="_blank" class="file-link">
                      {{ employeeData.myNumberCardFile || 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ã‚’é–‹ã' }}
                    </a>
                  </div>
                  <div *ngIf="!employeeData?.myNumberCardFileUrl" class="file-info">
                    <span class="no-file-message">æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“</span>
                  </div>
                </div>
              </div>
            </section>

            <!-- å…¥é€€ç¤¾æƒ…å ±æ¬„ -->
            <section class="form-section">
              <h3 class="section-title">å…¥é€€ç¤¾æƒ…å ±</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="employmentStatus">åœ¨ç±çŠ¶æ³</label>
                  <select 
                    id="employmentStatus" 
                    formControlName="employmentStatus" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let status of employmentStatuses" [value]="status">{{ status }}</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="joinDate">å…¥ç¤¾å¹´æœˆæ—¥</label>
                  <input 
                    type="date" 
                    id="joinDate" 
                    formControlName="joinDate" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="resignationDate">é€€è·å¹´æœˆæ—¥</label>
                  <input 
                    type="date" 
                    id="resignationDate" 
                    formControlName="resignationDate" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group full-width">
                  <label for="resignationReason">é€€è·äº‹ç”±</label>
                  <textarea 
                    id="resignationReason" 
                    formControlName="resignationReason" 
                    class="form-input" 
                    rows="3"
                    [readonly]="true"
                  ></textarea>
                </div>
              </div>
            </section>

            <!-- æ¥­å‹™æƒ…å ±æ¬„ -->
            <section class="form-section">
              <h3 class="section-title">æ¥­å‹™æƒ…å ±</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="employeeNumber">ç¤¾å“¡ç•ªå·</label>
                  <input 
                    type="text" 
                    id="employeeNumber" 
                    formControlName="employeeNumber" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="office">äº‹æ¥­æ‰€</label>
                  <select 
                    id="office" 
                    formControlName="office" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let office of offices" [value]="office">{{ office }}</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="workContent">æ¥­å‹™å†…å®¹</label>
                  <select 
                    id="workContent" 
                    formControlName="workContent" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let content of workContents" [value]="content">{{ content }}</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="employmentType">é›‡ç”¨å½¢æ…‹</label>
                  <select 
                    id="employmentType" 
                    formControlName="employmentType" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let type of employmentTypes" [value]="type">{{ type }}</option>
                  </select>
                </div>
                <!-- <div class="form-group">
                  <label for="paymentType">çµ¦ä¸æ”¯çµ¦å½¢æ…‹</label>
                  <select 
                    id="paymentType" 
                    formControlName="paymentType" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let type of paymentTypes" [value]="type">{{ type }}</option>
                  </select>
                </div> -->
              </div>
            </section>

            <!-- éƒ¨ç½²ãƒ»å½¹è·æƒ…å ± -->
            <section class="form-section">
              <h3 class="section-title">éƒ¨ç½²ãƒ»å½¹è·æƒ…å ±</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="department">éƒ¨ç½²</label>
                  <select 
                    id="department" 
                    formControlName="department" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="position">å½¹è·</label>
                  <select 
                    id="position" 
                    formControlName="position" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let pos of positions" [value]="pos">{{ pos }}</option>
                  </select>
                </div>
              </div>
            </section>

            <!-- ç¾ä½æ‰€ã¨é€£çµ¡å…ˆæ¬„ -->
            <section class="form-section">
              <h3 class="section-title">ç¾ä½æ‰€ã¨é€£çµ¡å…ˆ</h3>
              <div class="form-grid">
                <div class="form-group full-width">
                  <label for="currentAddress">ç¾ä½æ‰€</label>
                  <textarea 
                    id="currentAddress" 
                    formControlName="currentAddress" 
                    class="form-input" 
                    rows="2"
                    [readonly]="true"
                  ></textarea>
                </div>
                <div class="form-group full-width">
                  <label for="currentAddressKana">ç¾ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
                  <textarea 
                    id="currentAddressKana" 
                    formControlName="currentAddressKana" 
                    class="form-input" 
                    rows="2"
                    [readonly]="true"
                  ></textarea>
                </div>
                <div class="form-group">
                  <label for="phoneNumber">é›»è©±ç•ªå·</label>
                  <input 
                    type="tel" 
                    id="phoneNumber" 
                    formControlName="phoneNumber" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="currentHouseholdHead">ä¸–å¸¯ä¸»ï¼ˆæœ¬äºº/è¦ªæ—ï¼‰</label>
                  <select 
                    id="currentHouseholdHead" 
                    formControlName="currentHouseholdHead" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let type of householdHeadTypes" [value]="type">{{ type }}</option>
                  </select>
                </div>
              </div>
            </section>

            <!-- ä½æ°‘ç¥¨ä½æ‰€æ¬„ -->
            <section class="form-section">
              <h3 class="section-title">ä½æ°‘ç¥¨ä½æ‰€</h3>
              <div class="form-grid">
                <div class="form-group full-width">
                  <label class="checkbox-label">
                    <input 
                      type="checkbox" 
                      [checked]="sameAsCurrentAddress" 
                      [disabled]="true"
                    >
                    ä½æ‰€ï¼ˆç¾ä½æ‰€ã¨åŒã˜ï¼‰
                  </label>
                </div>
                <div class="form-group full-width">
                  <label for="residentAddress">ä½æ‰€</label>
                  <textarea 
                    id="residentAddress" 
                    formControlName="residentAddress" 
                    class="form-input" 
                    rows="2"
                    [readonly]="!isEditMode || sameAsCurrentAddress"
                  ></textarea>
                </div>
                <div class="form-group full-width">
                  <label for="residentAddressKana">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
                  <textarea 
                    id="residentAddressKana" 
                    formControlName="residentAddressKana" 
                    class="form-input" 
                    rows="2"
                    [readonly]="!isEditMode || sameAsCurrentAddress"
                  ></textarea>
                </div>
                <div class="form-group">
                  <label for="residentHouseholdHead">ä¸–å¸¯ä¸»ï¼ˆæœ¬äºº/è¦ªæ—ï¼‰</label>
                  <select 
                    id="residentHouseholdHead" 
                    formControlName="residentHouseholdHead" 
                    class="form-input"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let type of householdHeadTypes" [value]="type">{{ type }}</option>
                  </select>
                </div>
              </div>
            </section>

            <!-- å±¥æ­´æ›¸ãƒ»è·å‹™çµŒæ­´æ›¸æ¬„ -->
            <section class="form-section">
              <h3 class="section-title">å±¥æ­´æ›¸ãƒ»è·å‹™çµŒæ­´æ›¸</h3>
              <div class="form-grid">
                <div class="form-group full-width">
                  <label>å±¥æ­´æ›¸æ·»ä»˜</label>
                  <div *ngIf="employeeData?.resumeFileUrl" class="file-info">
                    <a [href]="employeeData.resumeFileUrl" target="_blank" class="file-link">
                      {{ employeeData.resumeFile || 'å±¥æ­´æ›¸ã‚’é–‹ã' }}
                    </a>
                  </div>
                  <div *ngIf="!employeeData?.resumeFileUrl" class="file-info">
                    <span class="no-file-message">æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“</span>
                  </div>
                </div>
                <div class="form-group full-width">
                  <label>è·å‹™çµŒæ­´æ›¸æ·»ä»˜</label>
                  <div *ngIf="employeeData?.careerHistoryFileUrl" class="file-info">
                    <a [href]="employeeData.careerHistoryFileUrl" target="_blank" class="file-link">
                      {{ employeeData.careerHistoryFile || 'è·å‹™çµŒæ­´æ›¸ã‚’é–‹ã' }}
                    </a>
                  </div>
                  <div *ngIf="!employeeData?.careerHistoryFileUrl" class="file-info">
                    <span class="no-file-message">æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“</span>
                  </div>
                </div>
              </div>
            </section>

            <!-- ç·Šæ€¥é€£çµ¡å…ˆæ¬„ -->
            <section class="form-section">
              <h3 class="section-title">ç·Šæ€¥é€£çµ¡å…ˆ</h3>
              <div formGroupName="emergencyContact" class="nested-form">
                <div class="form-grid">
                  <div class="form-group">
                    <label for="emergencyName">æ°å</label>
                    <input 
                      type="text" 
                      id="emergencyName" 
                      formControlName="name" 
                      class="form-input"
                      [readonly]="true"
                    >
                  </div>
                  <div class="form-group">
                    <label for="emergencyNameKana">æ°åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
                    <input 
                      type="text" 
                      id="emergencyNameKana" 
                      formControlName="nameKana" 
                      class="form-input"
                      [readonly]="true"
                    >
                  </div>
                  <div class="form-group">
                    <label for="emergencyRelationship">ç¶šæŸ„</label>
                    <input 
                      type="text" 
                      id="emergencyRelationship" 
                      formControlName="relationship" 
                      class="form-input"
                      [readonly]="true"
                    >
                  </div>
                  <div class="form-group">
                    <label for="emergencyPhone">ç·Šæ€¥é€£çµ¡å…ˆé›»è©±ç•ªå·</label>
                    <input 
                      type="tel" 
                      id="emergencyPhone" 
                      formControlName="phone" 
                      class="form-input"
                      [readonly]="true"
                    >
                  </div>
                  <div class="form-group full-width">
                    <label>
                      <input 
                        type="checkbox" 
                        [checked]="sameAsCurrentAddressForEmergency"
                        (change)="onSameAddressForEmergencyChange($event)"
                        [disabled]="true"
                        class="checkbox-input"
                      >
                      ç¾ä½æ‰€ã¨åŒã˜
                    </label>
                  </div>
                  <div class="form-group full-width">
                    <label for="emergencyAddress">ä½æ‰€</label>
                    <textarea 
                      id="emergencyAddress" 
                      formControlName="address" 
                      class="form-input" 
                      rows="2"
                      [readonly]="!isEditMode || sameAsCurrentAddressForEmergency"
                    ></textarea>
                  </div>
                  <div class="form-group full-width">
                    <label for="emergencyAddressKana">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
                    <textarea 
                      id="emergencyAddressKana" 
                      formControlName="addressKana" 
                      class="form-input" 
                      rows="2"
                      [readonly]="!isEditMode || sameAsCurrentAddressForEmergency"
                    ></textarea>
                  </div>
                </div>
              </div>
            </section>

            <!-- å£åº§æƒ…å ±æ¬„ -->
            <section class="form-section">
              <h3 class="section-title">å£åº§æƒ…å ±</h3>
              <div formGroupName="bankAccount" class="nested-form">
                <div class="form-grid">
                  <div class="form-group">
                    <label for="bankName">éŠ€è¡Œå</label>
                    <input 
                      type="text" 
                      id="bankName" 
                      formControlName="bankName" 
                      class="form-input"
                      [readonly]="true"
                    >
                  </div>
                  <div class="form-group">
                    <label for="accountType">é é‡‘ç¨®åˆ¥</label>
                    <select 
                      id="accountType" 
                      formControlName="accountType" 
                      class="form-input"
                    >
                      <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                      <option value="æ™®é€š">æ™®é€š</option>
                      <option value="å½“åº§">å½“åº§</option>
                      <option value="è²¯è“„">è²¯è“„</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="accountHolder">åç¾©ï¼ˆã‚«ã‚¿ã‚«ãƒŠï¼‰</label>
                    <input 
                      type="text" 
                      id="accountHolder" 
                      formControlName="accountHolder" 
                      class="form-input"
                      [readonly]="true"
                    >
                  </div>
                  <div class="form-group">
                    <label for="branchName">æ”¯åº—å</label>
                    <input 
                      type="text" 
                      id="branchName" 
                      formControlName="branchName" 
                      class="form-input"
                      [readonly]="true"
                    >
                  </div>
                  <div class="form-group">
                    <label for="accountNumber">å£åº§ç•ªå·</label>
                    <input 
                      type="text" 
                      id="accountNumber" 
                      formControlName="accountNumber" 
                      class="form-input"
                      [readonly]="true"
                    >
                  </div>
                </div>
              </div>
            </section>

            <!-- ç¤¾ä¼šä¿é™ºæ¬„ -->
            <section class="form-section">
              <h3 class="section-title">ç¤¾ä¼šä¿é™º</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="healthInsuranceNumber">å¥åº·ä¿é™ºã®è¢«ä¿é™ºè€…æ•´ç†ç•ªå·</label>
                  <input 
                    type="text" 
                    id="healthInsuranceNumber" 
                    formControlName="healthInsuranceNumber" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="pensionInsuranceNumber">åšç”Ÿå¹´é‡‘ä¿é™ºã®è¢«ä¿é™ºè€…æ•´ç†ç•ªå·</label>
                  <input 
                    type="text" 
                    id="pensionInsuranceNumber" 
                    formControlName="pensionInsuranceNumber" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="basicPensionNumberPart1">åŸºç¤å¹´é‡‘ç•ªå·</label>
                  <div class="basic-pension-number-container">
                    <input 
                      type="text" 
                      id="basicPensionNumberPart1" 
                      formControlName="basicPensionNumberPart1" 
                      class="form-input basic-pension-part"
                      maxlength="4"
                      (input)="formatBasicPensionNumberInput($event, 1)"
                      placeholder="0000"
                      [readonly]="true"
                    >
                    <span class="basic-pension-separator">-</span>
                    <input 
                      type="text" 
                      id="basicPensionNumberPart2" 
                      formControlName="basicPensionNumberPart2" 
                      class="form-input basic-pension-part"
                      maxlength="6"
                      (input)="formatBasicPensionNumberInput($event, 2)"
                      placeholder="000000"
                      [readonly]="true"
                    >
                  </div>
                </div>
                <div class="form-group">
                  <label for="pensionHistoryStatus">åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´</label>
                  <select 
                    id="pensionHistoryStatus" 
                    formControlName="pensionHistoryStatus" 
                    class="form-input" 
                    (change)="onPensionHistoryChange($event)"
                  >
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let option of pensionHistoryOptions" [value]="option">{{ option }}</option>
                  </select>
                </div>
                <div class="form-group full-width" *ngIf="hasPensionHistory">
                  <label for="pensionHistory">åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´ï¼ˆè©³ç´°ï¼‰</label>
                  <textarea 
                    id="pensionHistory" 
                    formControlName="pensionHistory" 
                    class="form-input" 
                    rows="4"
                    [readonly]="true"
                  ></textarea>
                </div>
                <div class="form-group">
                  <label for="socialInsuranceAcquisitionDate">ç¤¾ä¼šä¿é™ºã®è³‡æ ¼å–å¾—å¹´æœˆæ—¥</label>
                  <input 
                    type="date" 
                    id="socialInsuranceAcquisitionDate" 
                    formControlName="socialInsuranceAcquisitionDate" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group">
                  <label for="socialInsuranceLossDate">ç¤¾ä¼šä¿é™ºã®è³‡æ ¼å–ªå¤±å¹´æœˆæ—¥</label>
                  <input 
                    type="date" 
                    id="socialInsuranceLossDate" 
                    formControlName="socialInsuranceLossDate" 
                    class="form-input"
                    [readonly]="true"
                  >
                </div>
                <div class="form-group full-width">
                  <label>åŸºç¤å¹´é‡‘ç•ªå·ç¢ºèªæ›¸é¡æ·»ä»˜</label>
                  <div *ngIf="employeeData?.basicPensionNumberDocFileUrl" class="file-info">
                    <a [href]="employeeData.basicPensionNumberDocFileUrl" target="_blank" class="file-link">
                      {{ employeeData.basicPensionNumberDocFile || 'åŸºç¤å¹´é‡‘ç•ªå·ãŒã‚ã‹ã‚‹æ›¸é¡ã‚’é–‹ã' }}
                    </a>
                  </div>
                  <div *ngIf="!employeeData?.basicPensionNumberDocFileUrl" class="file-info">
                    <span class="no-file-message">æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“</span>
                  </div>
                </div>
              </div>
            </section>

            <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
            <div class="form-actions" *ngIf="isEditMode">
              <button type="submit" class="submit-button" [disabled]="settingsForm.invalid || isSaving">
                {{ isSaving ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜' }}
              </button>
            </div>
          </form>
        </ng-container>

        <!-- å„ç¨®ç”³è«‹ãƒšãƒ¼ã‚¸ -->
        <ng-container *ngIf="currentTab === 'å„ç¨®ç”³è«‹'">
          <div class="page-header">
            <h2 class="page-title">å„ç¨®ç”³è«‹</h2>
          </div>
          
          <div class="application-grid">
            <button 
              *ngIf="!hasOnboardingApplication"
              class="application-button" 
              (click)="openApplicationModal('å…¥ç¤¾æ™‚ç”³è«‹')"
            >
              <span class="application-icon">ğŸ“</span>
              <span class="application-label">å…¥ç¤¾æ™‚ç”³è«‹</span>
            </button>
            
            <button 
              class="application-button" 
              (click)="openApplicationModal('æ‰¶é¤Šå®¶æ—è¿½åŠ ')"
              [disabled]="!isOnboardingCompleted"
              [title]="!isOnboardingCompleted ? 'å…¥ç¤¾å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§åˆ©ç”¨ã§ãã¾ã›ã‚“' : ''"
            >
              <span class="application-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§</span>
              <span class="application-label">æ‰¶é¤Šå®¶æ—è¿½åŠ </span>
            </button>
            
            <button 
              class="application-button" 
              (click)="openApplicationModal('æ‰¶é¤Šå‰Šé™¤ç”³è«‹')"
              [disabled]="!isOnboardingCompleted"
              [title]="!isOnboardingCompleted ? 'å…¥ç¤¾å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§åˆ©ç”¨ã§ãã¾ã›ã‚“' : ''"
            >
              <span class="application-icon">âŒ</span>
              <span class="application-label">æ‰¶é¤Šå‰Šé™¤ç”³è«‹</span>
            </button>
            
            <button 
              class="application-button" 
              (click)="openApplicationModal('ä½æ‰€å¤‰æ›´ç”³è«‹')"
              [disabled]="!isOnboardingCompleted"
              [title]="!isOnboardingCompleted ? 'å…¥ç¤¾å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§åˆ©ç”¨ã§ãã¾ã›ã‚“' : ''"
            >
              <span class="application-icon">ğŸ </span>
              <span class="application-label">ä½æ‰€å¤‰æ›´ç”³è«‹</span>
            </button>
            
            <button 
              class="application-button" 
              (click)="openApplicationModal('æ°åå¤‰æ›´ç”³è«‹')"
              [disabled]="!isOnboardingCompleted"
              [title]="!isOnboardingCompleted ? 'å…¥ç¤¾å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§åˆ©ç”¨ã§ãã¾ã›ã‚“' : ''"
            >
              <span class="application-icon">âœï¸</span>
              <span class="application-label">æ°åå¤‰æ›´ç”³è«‹</span>
            </button>
            
            <button 
              class="application-button" 
              (click)="openApplicationModal('ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ç”³è«‹')"
              [disabled]="!isOnboardingCompleted"
              [title]="!isOnboardingCompleted ? 'å…¥ç¤¾å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§åˆ©ç”¨ã§ãã¾ã›ã‚“' : ''"
            >
              <span class="application-icon">ğŸ”¢</span>
              <span class="application-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ç”³è«‹</span>
            </button>
            
            <button 
              class="application-button" 
              (click)="openApplicationModal('ç”£å‰ç”£å¾Œä¼‘æ¥­ç”³è«‹')"
              [disabled]="!isOnboardingCompleted"
              [title]="!isOnboardingCompleted ? 'å…¥ç¤¾å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§åˆ©ç”¨ã§ãã¾ã›ã‚“' : ''"
            >
              <span class="application-icon">ğŸ¤°</span>
              <span class="application-label">ç”£å‰ç”£å¾Œä¼‘æ¥­ç”³è«‹</span>
            </button>
            
            <button 
              class="application-button" 
              (click)="openApplicationModal('é€€è·ç”³è«‹')"
              [disabled]="!isOnboardingCompleted"
              [title]="!isOnboardingCompleted ? 'å…¥ç¤¾å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§åˆ©ç”¨ã§ãã¾ã›ã‚“' : ''"
            >
              <span class="application-icon">ğŸšª</span>
              <span class="application-label">é€€è·ç”³è«‹</span>
            </button>
          </div>
        </ng-container>

        <!-- ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ -->
        <ng-container *ngIf="currentTab === 'ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸'">
          <div class="main-page-layout">
            <!-- ä¸Šéƒ¨ã‚¨ãƒªã‚¢ï¼šè‡ªåˆ†ã®æƒ…å ±æ¬„ã¨äººäº‹ã‹ã‚‰ã®ä¾é ¼æ¬„ -->
            <div class="main-page-top">
              <!-- è‡ªåˆ†ã®æƒ…å ±æ¬„ -->
              <div class="info-card my-info-card">
                <h3 class="card-title">è‡ªåˆ†ã®æƒ…å ±</h3>
                <div class="info-content" *ngIf="employeeData">
                  <div class="info-row">
                    <span class="info-label">ç¤¾å“¡ç•ªå·:</span>
                    <span class="info-value">{{ employeeData.employeeNumber || employeeNumber }}</span>
                  </div>
                  <div class="info-row">
                    <span class="info-label">æ°å:</span>
                    <span class="info-value">{{ (employeeData.lastName || '') + (employeeData.firstName || '') || employeeData.name || employeeName }}</span>
                  </div>
                  <div class="info-row">
                    <span class="info-label">éƒ¨ç½²:</span>
                    <span class="info-value">{{ employeeData.department || '-' }}</span>
                  </div>
                  <div class="info-row">
                    <span class="info-label">å½¹è·:</span>
                    <span class="info-value">{{ employeeData.position || '-' }}</span>
                  </div>
                  <div class="info-row">
                    <span class="info-label">é›‡ç”¨å½¢æ…‹:</span>
                    <span class="info-value">{{ employeeData.employmentType || '-' }}</span>
                  </div>
                  <div class="info-row">
                    <span class="info-label">åœ¨ç±çŠ¶æ³:</span>
                    <span class="info-value">{{ employeeData.employmentStatus || 'åœ¨ç±' }}</span>
                  </div>
                </div>
                <div class="info-content" *ngIf="!employeeData">
                  <p class="no-data">æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
                </div>
              </div>

              <!-- äººäº‹ã‹ã‚‰ã®ä¾é ¼æ¬„ -->
              <div class="info-card hr-request-card">
                <h3 class="card-title">
                  äººäº‹ã‹ã‚‰ã®ä¾é ¼
                  <span class="request-badge" *ngIf="hrRequests.length > 0">{{ hrRequests.length }}</span>
                </h3>
                <div class="request-content">
                  <div *ngIf="hrRequests.length === 0" class="no-data">
                    ç¾åœ¨ã€ä¾é ¼ã¯ã‚ã‚Šã¾ã›ã‚“
                  </div>
                  <div *ngFor="let request of hrRequests" class="request-item">
                    <div class="request-header">
                      <span class="request-title">{{ request.title }}</span>
                      <span class="request-date" *ngIf="request.date">{{ request.date | date:'yyyy/MM/dd' }}</span>
                    </div>
                    <p class="request-message">{{ request.message }}</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- ç”³è«‹ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ« -->
            <div class="application-list-section">
              <div class="section-header">
                <h3 class="section-title">ç”³è«‹ä¸€è¦§</h3>
              </div>
              <div class="table-container">
                <table class="application-table">
                  <thead>
                    <tr>
                      <th>ç”³è«‹ID</th>
                      <th>ç”³è«‹ç¨®é¡</th>
                      <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                      <th>ç”³è«‹æ—¥</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let application of applications" class="application-row" (click)="openApplicationDetail(application)">
                      <td>{{ application.applicationId }}</td>
                      <td>{{ application.applicationType }}</td>
                      <td>
                        <span class="status-badge"
                              [class.status-pending]="application.status === 'æ‰¿èªå¾…ã¡'"
                              [class.status-reviewing]="application.status === 'ç¢ºèªä¸­'"
                              [class.status-approved]="application.status === 'æ‰¿èª' || application.status === 'æ‰¿èªæ¸ˆã¿'"
                              [class.status-submitted]="application.status === 'ç”³è«‹æ¸ˆã¿'"
                              [class.status-rejected]="application.status === 'å´ä¸‹' || application.status === 'å·®ã—æˆ»ã—'"
                              [class.status-cancelled]="application.status === 'å–ã‚Šæ¶ˆã—'"
                              [class.status-resubmitted]="application.status === 'å†ç”³è«‹' || application.status === 'å†æå‡º'">
                          {{ application.status }}
                        </span>
                        <div *ngIf="application.status === 'å·®ã—æˆ»ã—' && application.statusComment" class="status-comment-preview">
                          <small>{{ application.statusComment }}</small>
                        </div>
                      </td>
                      <td>{{ getApplicationDate(application) | date:'yyyy/MM/dd' }}</td>
                    </tr>
                    <tr *ngIf="applications.length === 0">
                      <td colspan="4" class="empty-message">ç”³è«‹å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ãƒšãƒ¼ã‚¸ -->
        <ng-container *ngIf="currentTab === 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´'">
          <div class="page-header">
            <h2 class="page-title">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</h2>
          </div>
          
          <form [formGroup]="passwordChangeForm" (ngSubmit)="changePassword()" class="settings-form">
            <section class="form-section">
              <h3 class="section-title">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="currentPassword">ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ <span class="required">*</span></label>
                  <input 
                    type="password" 
                    id="currentPassword" 
                    formControlName="currentPassword" 
                    class="form-input"
                    placeholder="ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›"
                  >
                  <div *ngIf="passwordChangeForm.get('currentPassword')?.invalid && passwordChangeForm.get('currentPassword')?.touched" class="error-message">
                    ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
                <div class="form-group">
                  <label for="newPassword">æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ <span class="required">*</span></label>
                  <input 
                    type="password" 
                    id="newPassword" 
                    formControlName="newPassword" 
                    class="form-input"
                    placeholder="æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ï¼ˆ6æ–‡å­—ä»¥ä¸Šï¼‰"
                  >
                  <div *ngIf="passwordChangeForm.get('newPassword')?.invalid && passwordChangeForm.get('newPassword')?.touched" class="error-message">
                    æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’6æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
                <div class="form-group">
                  <label for="confirmPassword">æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆç¢ºèªï¼‰ <span class="required">*</span></label>
                  <input 
                    type="password" 
                    id="confirmPassword" 
                    formControlName="confirmPassword" 
                    class="form-input"
                    placeholder="æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†å…¥åŠ›"
                  >
                  <div *ngIf="passwordChangeForm.get('confirmPassword')?.invalid && passwordChangeForm.get('confirmPassword')?.touched" class="error-message">
                    æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                  <div *ngIf="passwordChangeForm.get('confirmPassword')?.hasError('passwordMismatch') && passwordChangeForm.get('confirmPassword')?.touched" class="error-message">
                    æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“
                  </div>
                </div>
              </div>
            </section>
            
            <div class="form-actions">
              <button type="submit" class="submit-button" [disabled]="passwordChangeForm.invalid">
                ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´
              </button>
            </div>
          </form>
        </ng-container>

        <!-- ãã®ä»–ã®ã‚¿ãƒ– -->
        <!-- ä¿é™ºãƒ»æ‰¶é¤Šãƒšãƒ¼ã‚¸ -->
        <ng-container *ngIf="currentTab === 'ä¿é™ºãƒ»æ‰¶é¤Š'">
          <div class="insurance-dependents-page">
            <h2 class="page-title">ä¿é™ºãƒ»æ‰¶é¤Šæƒ…å ±</h2>
            
            <!-- ä¿é™ºè€…ç¨®åˆ¥æƒ…å ± -->
            <section class="info-section">
              <h3 class="section-title">ä¿é™ºè€…ç¨®åˆ¥</h3>
              <div class="info-grid">
                <div class="info-item">
                  <span class="info-label">å¥åº·ä¿é™ºè€…ç¨®åˆ¥:</span>
                  <span class="info-value">{{ insuranceData?.healthInsuranceType || 'æœªè¨­å®š' }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">ä»‹è­·ä¿é™ºè€…ç¨®åˆ¥:</span>
                  <span class="info-value">{{ insuranceData?.nursingInsuranceType || 'æœªè¨­å®š' }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">åšç”Ÿå¹´é‡‘ä¿é™ºè€…ç¨®åˆ¥:</span>
                  <span class="info-value">{{ insuranceData?.pensionInsuranceType || 'æœªè¨­å®š' }}</span>
                </div>
              </div>
            </section>

            <!-- æ‰¶é¤Šè€…æƒ…å ± -->
            <section class="info-section">
              <h3 class="section-title">æ‰¶é¤Šè€…æƒ…å ±</h3>
              <div class="dependents-list">
                <div *ngIf="dependentsData.length === 0" class="no-data-message">
                  æ‰¶é¤Šè€…ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
                </div>
                <div *ngFor="let dependent of dependentsData; let i = index" class="dependent-card">
                  <div class="dependent-header" (click)="toggleDependentExpanded(i)" style="cursor: pointer;">
                    <h4 class="dependent-title">æ‰¶é¤Šè€… {{ i + 1 }} <span class="expand-icon">{{ isDependentExpanded(i) ? 'â–¼' : 'â–¶' }}</span></h4>
                  </div>
                  <div class="dependent-info-grid" *ngIf="isDependentExpanded(i)">
                    <div class="dependent-info-item">
                      <span class="dependent-label">æ°å:</span>
                      <span class="dependent-value">{{ dependent.name || '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">æ°åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                      <span class="dependent-value">{{ dependent.nameKana || '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">ç¶šæŸ„:</span>
                      <span class="dependent-value">{{ dependent.relationship || '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">ç”Ÿå¹´æœˆæ—¥:</span>
                      <span class="dependent-value">{{ dependent.birthDate ? (dependent.birthDate | date:'yyyyå¹´MMæœˆddæ—¥') : '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">æ€§åˆ¥:</span>
                      <span class="dependent-value">{{ dependent.gender || '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">é›»è©±ç•ªå·:</span>
                      <span class="dependent-value">{{ dependent.phoneNumber || '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">è·æ¥­:</span>
                      <span class="dependent-value">{{ dependent.occupation || '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">å¹´é–“åå…¥è¦‹è¾¼ã¿é¡:</span>
                      <span class="dependent-value">{{ dependent.annualIncome ? (dependent.annualIncome | number:'1.0-0') + 'å††' : '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">æœˆé¡åå…¥è¦‹è¾¼ã¿é¡:</span>
                      <span class="dependent-value">{{ dependent.monthlyIncome ? (dependent.monthlyIncome | number:'1.0-0') + 'å††' : '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">ç¤¾ä¼šä¿é™ºã®æ‰¶é¤Šè€…ã¨ãªã£ãŸæ—¥:</span>
                      <span class="dependent-value">{{ dependent.dependentStartDate ? (dependent.dependentStartDate | date:'yyyyå¹´MMæœˆddæ—¥') : '-' }}</span>
                    </div>
                    <div class="dependent-info-item full-width">
                      <span class="dependent-label">æ‰¶é¤Šã«è¿½åŠ ã•ã‚ŒãŸç†ç”±:</span>
                      <span class="dependent-value">{{ dependent.dependentReason || '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼:</span>
                      <span class="dependent-value">{{ dependent.myNumber ? 'â—â—â—â—-â—â—â—â—-â—â—â—â—' : '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">åŒå±…/åˆ¥å±…:</span>
                      <span class="dependent-value">{{ dependent.livingTogether || '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">éƒµä¾¿ç•ªå·:</span>
                      <span class="dependent-value">{{ dependent.postalCode || '-' }}</span>
                    </div>
                    <div class="dependent-info-item full-width">
                      <span class="dependent-label">ä½æ‰€:</span>
                      <span class="dependent-value">{{ dependent.address || '-' }}</span>
                    </div>
                    <div class="dependent-info-item full-width">
                      <span class="dependent-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                      <span class="dependent-value">{{ dependent.addressKana || '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">ä½æ‰€å¤‰æ›´å¹´æœˆæ—¥:</span>
                      <span class="dependent-value">{{ dependent.addressChangeDate ? (dependent.addressChangeDate | date:'yyyyå¹´MMæœˆddæ—¥') : '-' }}</span>
                    </div>
                    <div class="dependent-info-item">
                      <span class="dependent-label">åŸºç¤å¹´é‡‘ç•ªå·:</span>
                      <span class="dependent-value">{{ dependent.basicPensionNumber || '-' }}</span>
                    </div>
                    <ng-container *ngIf="dependent.disabilityCategory || dependent.disabilityCardType || dependent.disabilityCardIssueDate">
                      <div class="dependent-info-item">
                        <span class="dependent-label">éšœãŒã„è€…åŒºåˆ†:</span>
                        <span class="dependent-value">{{ dependent.disabilityCategory || '-' }}</span>
                      </div>
                      <div class="dependent-info-item">
                        <span class="dependent-label">éšœãŒã„è€…æ‰‹å¸³ã®ç¨®é¡:</span>
                        <span class="dependent-value">{{ dependent.disabilityCardType || '-' }}</span>
                      </div>
                      <div class="dependent-info-item">
                        <span class="dependent-label">éšœãŒã„è€…æ‰‹å¸³ã®äº¤ä»˜å¹´æœˆæ—¥:</span>
                        <span class="dependent-value">{{ dependent.disabilityCardIssueDate ? (dependent.disabilityCardIssueDate | date:'yyyyå¹´MMæœˆddæ—¥') : '-' }}</span>
                      </div>
                    </ng-container>
                    <!-- æ·»ä»˜æ›¸é¡ -->
                    <ng-container *ngIf="dependent.basicPensionNumberDocFileUrl || dependent.myNumberDocFileUrl || dependent.identityDocFileUrl || dependent.disabilityCardFileUrl">
                      <div class="dependent-info-item full-width">
                        <span class="dependent-label">æ·»ä»˜æ›¸é¡:</span>
                        <div class="dependent-value">
                          <div *ngIf="dependent.basicPensionNumberDocFileUrl" style="margin-bottom: 0.5rem;">
                            <a [href]="dependent.basicPensionNumberDocFileUrl" target="_blank" class="file-link">{{ getFileNameFromUrl(dependent.basicPensionNumberDocFileUrl, dependent.basicPensionNumberDocFileName) }}</a>
                          </div>
                          <div *ngIf="dependent.myNumberDocFileUrl" style="margin-bottom: 0.5rem;">
                            <a [href]="dependent.myNumberDocFileUrl" target="_blank" class="file-link">{{ getFileNameFromUrl(dependent.myNumberDocFileUrl, dependent.myNumberDocFileName) }}</a>
                          </div>
                          <div *ngIf="dependent.identityDocFileUrl" style="margin-bottom: 0.5rem;">
                            <a [href]="dependent.identityDocFileUrl" target="_blank" class="file-link">{{ getFileNameFromUrl(dependent.identityDocFileUrl, dependent.identityDocFileName) }}</a>
                          </div>
                          <div *ngIf="dependent.disabilityCardFileUrl">
                            <a [href]="dependent.disabilityCardFileUrl" target="_blank" class="file-link">{{ getFileNameFromUrl(dependent.disabilityCardFileUrl, dependent.disabilityCardFileName) }}</a>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                    <div class="dependent-info-item full-width" *ngIf="dependent.notes">
                      <span class="dependent-label">å‚™è€ƒ:</span>
                      <span class="dependent-value">{{ dependent.notes }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </ng-container>

        <!-- ãƒŠãƒ¬ãƒƒã‚¸ãƒšãƒ¼ã‚¸ -->
        <ng-container *ngIf="currentTab === 'ãƒŠãƒ¬ãƒƒã‚¸'">
          <div class="knowledge-page">
            <h2 class="page-title">ãƒŠãƒ¬ãƒƒã‚¸ - AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</h2>
            <p class="knowledge-description">
              äººäº‹ãƒ»çµ¦ä¸ã‚·ã‚¹ãƒ†ãƒ ã«é–¢ã™ã‚‹ã”è³ªå•ã«ãŠç­”ãˆã—ã¾ã™ã€‚ã‚ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚Œã°ã€ãŠæ°—è»½ã«ãŠå°‹ã­ãã ã•ã„ã€‚
            </p>
            
            <!-- ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ -->
            <div class="chat-container">
              <div class="chat-messages" #chatMessagesContainer>
                <div *ngIf="chatMessages.length === 0" class="chat-welcome">
                  <p>ã“ã‚“ã«ã¡ã¯ï¼äººäº‹ãƒ»çµ¦ä¸ã‚·ã‚¹ãƒ†ãƒ ã«é–¢ã™ã‚‹ã”è³ªå•ã«ãŠç­”ãˆã—ã¾ã™ã€‚</p>
                  <p>ã©ã®ã‚ˆã†ãªã“ã¨ã§ãŠå›°ã‚Šã§ã—ã‚‡ã†ã‹ï¼Ÿ</p>
                  
                  <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè³ªå• -->
                  <div class="template-questions">
                    <p class="template-questions-title">ã‚ˆãã‚ã‚‹è³ªå•ã‹ã‚‰é¸ã¶ï¼š</p>
                    <div class="template-questions-grid">
                      <button
                        *ngFor="let template of templateQuestions"
                        class="template-question-button"
                        (click)="sendTemplateQuestion(template.question)"
                        [disabled]="isChatLoading"
                      >
                        <span class="template-question-icon">{{ template.icon }}</span>
                        <span class="template-question-text">{{ template.text }}</span>
                      </button>
                    </div>
                  </div>
                </div>
                <div *ngFor="let message of chatMessages" class="chat-message" [class.user-message]="message.role === 'user'" [class.assistant-message]="message.role === 'assistant'">
                  <div class="message-content">
                    <div class="message-role" *ngIf="message.role === 'user'">ã‚ãªãŸ</div>
                    <div class="message-role" *ngIf="message.role === 'assistant'">AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</div>
                    <div class="message-text">{{ message.content }}</div>
                    <!-- ç”³è«‹ãƒœã‚¿ãƒ³ï¼ˆã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã®å¿œç­”ã§ç”³è«‹ã‚¿ã‚¤ãƒ—ãŒã‚ã‚‹å ´åˆï¼‰ -->
                    <div *ngIf="message.role === 'assistant' && message.applicationType" class="application-button-container">
                      <button
                        class="application-action-button"
                        (click)="openApplicationFromChat(message.applicationType!)"
                        [disabled]="!isOnboardingCompleted && message.applicationType !== 'å…¥ç¤¾æ™‚ç”³è«‹'"
                        [title]="!isOnboardingCompleted && message.applicationType !== 'å…¥ç¤¾æ™‚ç”³è«‹' ? 'å…¥ç¤¾å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§åˆ©ç”¨ã§ãã¾ã›ã‚“' : ''"
                      >
                        <span class="application-action-icon">ğŸ“</span>
                        <span class="application-action-text">{{ message.applicationType }}ã‚’é–‹ã</span>
                      </button>
                    </div>
                    <div class="message-time" *ngIf="message.timestamp">
                      {{ message.timestamp | date:'HH:mm' }}
                    </div>
                  </div>
                </div>
                <div *ngIf="isChatLoading" class="chat-message assistant-message">
                  <div class="message-content">
                    <div class="message-role">AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</div>
                    <div class="message-text loading">
                      <span class="loading-dot"></span>
                      <span class="loading-dot"></span>
                      <span class="loading-dot"></span>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- ãƒãƒ£ãƒƒãƒˆå…¥åŠ›ã‚¨ãƒªã‚¢ -->
              <div class="chat-input-container">
                <div class="chat-input-wrapper">
                  <textarea
                    [(ngModel)]="chatInputMessage"
                    (keydown)="onChatInputKeydown($event)"
                    placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆEnterã§é€ä¿¡ã€Shift+Enterã§æ”¹è¡Œï¼‰"
                    class="chat-input"
                    rows="2"
                    [disabled]="isChatLoading"
                  ></textarea>
                  <div class="chat-actions">
                    <button
                      (click)="sendChatMessage()"
                      [disabled]="!chatInputMessage.trim() || isChatLoading"
                      class="chat-send-button"
                    >
                      é€ä¿¡
                    </button>
                    <button
                      (click)="clearChat()"
                      [disabled]="chatMessages.length === 0"
                      class="chat-clear-button"
                    >
                      ã‚¯ãƒªã‚¢
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- ãã®ä»–ã®ãƒšãƒ¼ã‚¸ -->
        <ng-container *ngIf="currentTab !== 'æƒ…å ±ç…§ä¼š' && currentTab !== 'å„ç¨®ç”³è«‹' && currentTab !== 'ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸' && currentTab !== 'ä¿é™ºãƒ»æ‰¶é¤Š' && currentTab !== 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´' && currentTab !== 'ãƒŠãƒ¬ãƒƒã‚¸'">
          <h2 class="page-title">{{ currentTab }}ã®ãƒšãƒ¼ã‚¸ã§ã™</h2>
        </ng-container>
      </div>
    </main>
  </div>
</div>

<!-- å…¥ç¤¾æ™‚ç”³è«‹ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-overlay" *ngIf="showApplicationModal && currentApplicationType === 'å…¥ç¤¾æ™‚ç”³è«‹'">
  <div class="modal-content" [class.form-disabled]="isSubmittingOnboardingApplication">
    <div class="modal-header">
      <h2 class="modal-title">å…¥ç¤¾æ™‚ç”³è«‹</h2>
      <button class="modal-close-button" (click)="closeApplicationModal()" [disabled]="isSubmittingOnboardingApplication" [title]="isSubmittingOnboardingApplication ? 'ç”³è«‹ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚' : ''">Ã—</button>
    </div>
    
    <div *ngIf="isSubmittingOnboardingApplication" class="loading-overlay">
      <div class="loading-spinner"></div>
      <p class="loading-message">ç”³è«‹ã‚’é€ä¿¡ã—ã¦ã„ã¾ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„...</p>
    </div>
    
    <form [formGroup]="onboardingApplicationForm" (ngSubmit)="submitOnboardingApplication()" class="application-form">
      <!-- åŸºæœ¬æƒ…å ±æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">åŸºæœ¬æƒ…å ±</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-lastName">å§“ <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-lastName" 
              formControlName="lastName" 
              class="form-input"
              [readonly]="true"
              style="background: #f5f5f5;"
            >
            <div *ngIf="onboardingApplicationForm.get('lastName')?.invalid && onboardingApplicationForm.get('lastName')?.touched" class="error-message">
              å§“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-firstName">å <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-firstName" 
              formControlName="firstName" 
              class="form-input"
              [readonly]="true"
              style="background: #f5f5f5;"
            >
            <div *ngIf="onboardingApplicationForm.get('firstName')?.invalid && onboardingApplicationForm.get('firstName')?.touched" class="error-message">
              åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-lastNameKana">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-lastNameKana" 
              formControlName="lastNameKana" 
              class="form-input"
              [readonly]="true"
              style="background: #f5f5f5;"
            >
            <div *ngIf="onboardingApplicationForm.get('lastNameKana')?.invalid && onboardingApplicationForm.get('lastNameKana')?.touched" class="error-message">
              <span *ngIf="onboardingApplicationForm.get('lastNameKana')?.errors?.['required']">
                å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
              <span *ngIf="onboardingApplicationForm.get('lastNameKana')?.errors?.['katakana']">
                ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-firstNameKana">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-firstNameKana" 
              formControlName="firstNameKana" 
              class="form-input"
              [readonly]="true"
              style="background: #f5f5f5;"
            >
            <div *ngIf="onboardingApplicationForm.get('firstNameKana')?.invalid && onboardingApplicationForm.get('firstNameKana')?.touched" class="error-message">
              <span *ngIf="onboardingApplicationForm.get('firstNameKana')?.errors?.['required']">
                åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
              <span *ngIf="onboardingApplicationForm.get('firstNameKana')?.errors?.['katakana']">
                ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-birthDate">ç”Ÿå¹´æœˆæ—¥ <span class="required">*</span></label>
            <input 
              type="date" 
              id="onboarding-birthDate" 
              formControlName="birthDate" 
              class="form-input"
            >
            <div *ngIf="onboardingApplicationForm.get('birthDate')?.invalid && onboardingApplicationForm.get('birthDate')?.touched" class="error-message">
              ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-gender">æˆ¸ç±ä¸Šã®æ€§åˆ¥ <span class="required">*</span></label>
            <select 
              id="onboarding-gender" 
              formControlName="gender" 
              class="form-input"
            >
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option *ngFor="let g of genders" [value]="g">{{ g }}</option>
            </select>
            <div *ngIf="onboardingApplicationForm.get('gender')?.invalid && onboardingApplicationForm.get('gender')?.touched" class="error-message">
              æ€§åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="required">*</span></label>
            <input 
              type="email" 
              id="onboarding-email" 
              formControlName="email" 
              class="form-input"
              [readonly]="true"
              style="background: #f5f5f5;"
            >
            <div *ngIf="onboardingApplicationForm.get('email')?.invalid && onboardingApplicationForm.get('email')?.touched" class="error-message">
              æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group full-width">
            <label for="onboarding-idDocument">æœ¬äººç¢ºèªæ›¸é¡æ·»ä»˜</label>
            <input 
              type="file" 
              id="onboarding-idDocument" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'idDocument')"
            >
            <div *ngIf="idDocumentFile" class="file-name">{{ idDocumentFile.name }}</div>
          </div>
        </div>
      </section>

      <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ï¼ˆä»»æ„ï¼‰</h3>
        <div class="form-grid">
          <div class="form-group full-width">
            <div class="my-number-container">
              <div class="my-number-inputs">
                <input 
                  type="text" 
                  id="onboarding-myNumberPart1" 
                  formControlName="myNumberPart1" 
                  class="form-input my-number-part"
                  maxlength="4"
                  placeholder="0000"
                  (input)="onMyNumberInput($event, 'myNumberPart1')"
                >
                <span class="my-number-separator">-</span>
                <input 
                  type="text" 
                  id="onboarding-myNumberPart2" 
                  formControlName="myNumberPart2" 
                  class="form-input my-number-part"
                  maxlength="4"
                  placeholder="0000"
                  (input)="onMyNumberInput($event, 'myNumberPart2')"
                >
                <span class="my-number-separator">-</span>
                <input 
                  type="text" 
                  id="onboarding-myNumberPart3" 
                  formControlName="myNumberPart3" 
                  class="form-input my-number-part"
                  maxlength="4"
                  placeholder="0000"
                  (input)="onMyNumberInput($event, 'myNumberPart3')"
                >
              </div>
            </div>
          </div>
          <div class="form-group full-width">
            <label for="onboardingMyNumberCard">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰æ·»ä»˜</label>
            <input 
              type="file" 
              id="onboardingMyNumberCard" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'myNumberCard')"
            >
            <div *ngIf="myNumberCardFile" class="file-name">{{ myNumberCardFile.name }}</div>
          </div>
        </div>
      </section>

      <!-- ç¾ä½æ‰€ã¨é€£çµ¡å…ˆæ¬„ -->
      <section class="form-section">
        <h3 class="section-title">ç¾ä½æ‰€ã¨é€£çµ¡å…ˆ</h3>
        <div class="form-grid">
          <div class="form-group full-width">
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                formControlName="isOverseasResident"
                (change)="onOverseasResidentChange($event)"
              >
              æµ·å¤–ã«åœ¨ä½
            </label>
          </div>
          <div class="form-group" *ngIf="!onboardingApplicationForm.get('isOverseasResident')?.value">
            <label for="onboarding-postalCode">éƒµä¾¿ç•ªå· <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-postalCode" 
              formControlName="postalCode" 
              class="form-input"
              maxlength="7"
              (input)="formatPostalCode($event)"
              placeholder="1234567"
            >
            <div *ngIf="onboardingApplicationForm.get('postalCode')?.invalid && onboardingApplicationForm.get('postalCode')?.touched" class="error-message">
              <span *ngIf="onboardingApplicationForm.get('postalCode')?.errors?.['pattern']">
                7æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
            </div>
          </div>
          <div class="form-group full-width" *ngIf="!onboardingApplicationForm.get('isOverseasResident')?.value">
            <label for="onboarding-currentAddress">ç¾ä½æ‰€ <span class="required">*</span></label>
            <textarea 
              id="onboarding-currentAddress" 
              formControlName="currentAddress" 
              class="form-input" 
              rows="2"
            ></textarea>
            <div *ngIf="onboardingApplicationForm.get('currentAddress')?.invalid && onboardingApplicationForm.get('currentAddress')?.touched" class="error-message">
              ç¾ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group full-width" *ngIf="!onboardingApplicationForm.get('isOverseasResident')?.value">
            <label for="onboarding-currentAddressKana">ç¾ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required">*</span></label>
            <textarea 
              id="onboarding-currentAddressKana" 
              formControlName="currentAddressKana" 
              class="form-input" 
              rows="2"
            ></textarea>
            <div *ngIf="onboardingApplicationForm.get('currentAddressKana')?.invalid && onboardingApplicationForm.get('currentAddressKana')?.touched" class="error-message">
              <span *ngIf="onboardingApplicationForm.get('currentAddressKana')?.errors?.['required']">
                ç¾ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
              <span *ngIf="onboardingApplicationForm.get('currentAddressKana')?.errors?.['katakana']">
                ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
            </div>
          </div>
          <div class="form-group full-width" *ngIf="onboardingApplicationForm.get('isOverseasResident')?.value">
            <label for="onboarding-overseasAddress">ä½æ‰€ <span class="required">*</span></label>
            <textarea 
              id="onboarding-overseasAddress" 
              formControlName="overseasAddress" 
              class="form-input" 
              rows="2"
              placeholder="æµ·å¤–ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
            ></textarea>
            <div *ngIf="onboardingApplicationForm.get('overseasAddress')?.invalid && onboardingApplicationForm.get('overseasAddress')?.touched" class="error-message">
              ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-phoneNumber">é›»è©±ç•ªå·ï¼ˆãƒã‚¤ãƒ•ãƒ³ãªã—ï¼‰ <span class="required">*</span></label>
            <input 
              type="tel" 
              id="onboarding-phoneNumber" 
              formControlName="phoneNumber" 
              class="form-input"
              maxlength="11"
              (input)="formatPhoneNumber($event)"
            >
            <div *ngIf="onboardingApplicationForm.get('phoneNumber')?.invalid && onboardingApplicationForm.get('phoneNumber')?.touched" class="error-message">
              <span *ngIf="onboardingApplicationForm.get('phoneNumber')?.errors?.['required']">
                é›»è©±ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
              <span *ngIf="onboardingApplicationForm.get('phoneNumber')?.errors?.['pattern']">
                æ•°å­—ã®ã¿ã§å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆæœ€å¤§11æ¡ï¼‰
              </span>
            </div>
          </div>
        </div>
      </section>

      <!-- ä½æ°‘ç¥¨ä½æ‰€æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">ä½æ°‘ç¥¨ä½æ‰€</h3>
        <div class="form-grid">
          <div class="form-group full-width">
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                formControlName="skipResidentAddress"
                [disabled]="onboardingApplicationForm.get('isOverseasResident')?.value"
                (change)="onSkipResidentAddressChange($event)"
              >
              ä½æ°‘ç¥¨ä½æ‰€ã‚’è¨˜è¼‰ã—ãªã„
            </label>
          </div>
          <div class="form-group full-width" *ngIf="onboardingApplicationForm.get('skipResidentAddress')?.value">
            <label for="onboarding-residentAddressSkipReason">ç†ç”± <span class="required">*</span></label>
            <select 
              id="onboarding-residentAddressSkipReason" 
              formControlName="residentAddressSkipReason" 
              class="form-input"
              (change)="onResidentAddressSkipReasonChange($event)"
            >
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="æµ·å¤–åœ¨ä½">æµ·å¤–åœ¨ä½</option>
              <option value="çŸ­æœŸç•™å­¦">çŸ­æœŸç•™å­¦</option>
              <option value="ãã®ä»–">ãã®ä»–</option>
            </select>
            <div *ngIf="onboardingApplicationForm.get('residentAddressSkipReason')?.invalid && onboardingApplicationForm.get('residentAddressSkipReason')?.touched" class="error-message">
              ç†ç”±ã‚’é¸æŠã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group full-width" *ngIf="onboardingApplicationForm.get('skipResidentAddress')?.value && onboardingApplicationForm.get('residentAddressSkipReason')?.value === 'ãã®ä»–'">
            <label for="onboarding-residentAddressSkipReasonOther">ç†ç”±ï¼ˆãã®ä»–ï¼‰ <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-residentAddressSkipReasonOther" 
              formControlName="residentAddressSkipReasonOther" 
              class="form-input"
              placeholder="ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
            >
            <div *ngIf="onboardingApplicationForm.get('residentAddressSkipReasonOther')?.invalid && onboardingApplicationForm.get('residentAddressSkipReasonOther')?.touched" class="error-message">
              ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group full-width" *ngIf="!onboardingApplicationForm.get('skipResidentAddress')?.value">
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                formControlName="sameAsCurrentAddress"
                (change)="onOnboardingSameAddressChange($event)"
              >
              ä½æ‰€ï¼ˆç¾ä½æ‰€ã¨åŒã˜ï¼‰
            </label>
          </div>
          <div class="form-group" *ngIf="!onboardingApplicationForm.get('skipResidentAddress')?.value">
            <label for="onboarding-residentPostalCode">éƒµä¾¿ç•ªå· <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-residentPostalCode" 
              formControlName="residentPostalCode" 
              class="form-input"
              maxlength="7"
              (input)="formatResidentPostalCode($event)"
              placeholder="1234567"
            >
            <div *ngIf="onboardingApplicationForm.get('residentPostalCode')?.invalid && onboardingApplicationForm.get('residentPostalCode')?.touched" class="error-message">
              <span *ngIf="onboardingApplicationForm.get('residentPostalCode')?.errors?.['required']">
                éƒµä¾¿ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
              <span *ngIf="onboardingApplicationForm.get('residentPostalCode')?.errors?.['pattern']">
                7æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
            </div>
          </div>
          <div class="form-group full-width" *ngIf="!onboardingApplicationForm.get('skipResidentAddress')?.value">
            <label for="onboarding-residentAddress">ä½æ‰€ <span class="required">*</span></label>
            <textarea 
              id="onboarding-residentAddress" 
              formControlName="residentAddress" 
              class="form-input" 
              rows="2"
              [readonly]="onboardingApplicationForm.get('sameAsCurrentAddress')?.value"
            ></textarea>
            <div *ngIf="onboardingApplicationForm.get('residentAddress')?.invalid && onboardingApplicationForm.get('residentAddress')?.touched" class="error-message">
              ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group full-width" *ngIf="!onboardingApplicationForm.get('skipResidentAddress')?.value">
            <label for="onboarding-residentAddressKana">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required">*</span></label>
            <textarea 
              id="onboarding-residentAddressKana" 
              formControlName="residentAddressKana" 
              class="form-input" 
              rows="2"
              [readonly]="onboardingApplicationForm.get('sameAsCurrentAddress')?.value"
            ></textarea>
            <div *ngIf="onboardingApplicationForm.get('residentAddressKana')?.invalid && onboardingApplicationForm.get('residentAddressKana')?.touched" class="error-message">
              <span *ngIf="onboardingApplicationForm.get('residentAddressKana')?.errors?.['required']">
                ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
              <span *ngIf="onboardingApplicationForm.get('residentAddressKana')?.errors?.['katakana']">
                ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
            </div>
          </div>
        </div>
      </section>

      <!-- å±¥æ­´æ›¸ãƒ»è·å‹™çµŒæ­´æ›¸æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">å±¥æ­´æ›¸ãƒ»è·å‹™çµŒæ­´æ›¸</h3>
        <div class="form-grid">
          <div class="form-group full-width">
            <label for="onboarding-resume">å±¥æ­´æ›¸æ·»ä»˜</label>
            <input 
              type="file" 
              id="onboarding-resume" 
              class="form-input"
              accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'onboardingResume')"
            >
            <div *ngIf="resumeFile" class="file-name">{{ resumeFile.name }}</div>
          </div>
          <div class="form-group full-width">
            <label for="onboarding-careerHistory">è·å‹™çµŒæ­´æ›¸æ·»ä»˜</label>
            <input 
              type="file" 
              id="onboarding-careerHistory" 
              class="form-input"
              accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'onboardingCareerHistory')"
            >
            <div *ngIf="careerHistoryFile" class="file-name">{{ careerHistoryFile.name }}</div>
          </div>
        </div>
      </section>

      <!-- ç·Šæ€¥é€£çµ¡å…ˆæ¬„ -->
      <section class="form-section">
        <h3 class="section-title">ç·Šæ€¥é€£çµ¡å…ˆ</h3>
        <div formGroupName="emergencyContact" class="nested-form">
          <div class="form-grid">
            <div class="form-group">
              <label for="onboarding-emergencyName">æ°å</label>
              <input 
                type="text" 
                id="onboarding-emergencyName" 
                formControlName="name" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-emergencyNameKana">æ°åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
              <input 
                type="text" 
                id="onboarding-emergencyNameKana" 
                formControlName="nameKana" 
                class="form-input"
              >
              <div *ngIf="onboardingApplicationForm.get('emergencyContact.nameKana')?.invalid && onboardingApplicationForm.get('emergencyContact.nameKana')?.touched" class="error-message">
                <span *ngIf="onboardingApplicationForm.get('emergencyContact.nameKana')?.errors?.['katakana']">
                  ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„
                </span>
              </div>
            </div>
            <div class="form-group">
              <label for="onboarding-emergencyRelationship">ç¶šæŸ„</label>
              <input 
                type="text" 
                id="onboarding-emergencyRelationship" 
                formControlName="relationship" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-emergencyPhone">ç·Šæ€¥é€£çµ¡å…ˆé›»è©±ç•ªå·</label>
              <input 
                type="tel" 
                id="onboarding-emergencyPhone" 
                formControlName="phone" 
                class="form-input"
                maxlength="11"
                (input)="formatEmergencyPhoneNumber($event)"
              >
              <div *ngIf="onboardingApplicationForm.get('emergencyContact.phone')?.invalid && onboardingApplicationForm.get('emergencyContact.phone')?.touched" class="error-message">
                <span *ngIf="onboardingApplicationForm.get('emergencyContact.phone')?.errors?.['pattern']">
                  æ•°å­—ã®ã¿ã§å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆæœ€å¤§11æ¡ï¼‰
                </span>
              </div>
            </div>
          </div>
        </div>
        <div class="form-grid">
          <div class="form-group full-width">
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                formControlName="sameAsCurrentAddressForEmergency"
                (change)="onSameAsCurrentAddressForEmergencyChange($event)"
              >
              ç¾ä½æ‰€ã¨åŒã˜
            </label>
          </div>
        </div>
        <div formGroupName="emergencyContact" class="nested-form">
          <div class="form-grid">
            <div class="form-group full-width">
              <label for="onboarding-emergencyAddress">ä½æ‰€</label>
              <textarea 
                id="onboarding-emergencyAddress" 
                formControlName="address" 
                class="form-input" 
                rows="2"
              ></textarea>
            </div>
            <div class="form-group full-width" *ngIf="!onboardingApplicationForm.get('isOverseasResident')?.value || !onboardingApplicationForm.get('sameAsCurrentAddressForEmergency')?.value">
              <label for="onboarding-emergencyAddressKana">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
              <textarea 
                id="onboarding-emergencyAddressKana" 
                formControlName="addressKana" 
                class="form-input" 
                rows="2"
              ></textarea>
              <div *ngIf="onboardingApplicationForm.get('emergencyContact.addressKana')?.invalid && onboardingApplicationForm.get('emergencyContact.addressKana')?.touched" class="error-message">
                <span *ngIf="onboardingApplicationForm.get('emergencyContact.addressKana')?.errors?.['katakana']">
                  ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„
                </span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- å£åº§æƒ…å ±æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">å£åº§æƒ…å ±</h3>
        <div formGroupName="bankAccount" class="nested-form">
          <div class="form-grid">
            <div class="form-group">
              <label for="onboarding-bankName">éŠ€è¡Œå</label>
              <input 
                type="text" 
                id="onboarding-bankName" 
                formControlName="bankName" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-accountType">é é‡‘ç¨®åˆ¥</label>
              <select 
                id="onboarding-accountType" 
                formControlName="accountType" 
                class="form-input"
              >
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="æ™®é€š">æ™®é€š</option>
                <option value="å½“åº§">å½“åº§</option>
                <option value="è²¯è“„">è²¯è“„</option>
              </select>
            </div>
            <div class="form-group">
              <label for="onboarding-accountHolder">åç¾©ï¼ˆã‚«ã‚¿ã‚«ãƒŠï¼‰</label>
              <input 
                type="text" 
                id="onboarding-accountHolder" 
                formControlName="accountHolder" 
                class="form-input"
              >
              <div *ngIf="onboardingApplicationForm.get('bankAccount.accountHolder')?.invalid && onboardingApplicationForm.get('bankAccount.accountHolder')?.touched" class="error-message">
                <span *ngIf="onboardingApplicationForm.get('bankAccount.accountHolder')?.errors?.['katakana']">
                  ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„
                </span>
              </div>
            </div>
            <div class="form-group">
              <label for="onboarding-branchName">æ”¯åº—å</label>
              <input 
                type="text" 
                id="onboarding-branchName" 
                formControlName="branchName" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-accountNumber">å£åº§ç•ªå·</label>
              <input 
                type="text" 
                id="onboarding-accountNumber" 
                formControlName="accountNumber" 
                class="form-input"
                (input)="formatAccountNumber($event)"
              >
            </div>
          </div>
        </div>
      </section>

      <!-- ç¤¾ä¼šä¿é™ºæ¬„ï¼ˆåŸºç¤å¹´é‡‘ç•ªå·ã€åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´ã®ã¿ï¼‰ -->
      <section class="form-section">
        <h3 class="section-title">ç¤¾ä¼šä¿é™º</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-basicPensionNumberPart1">åŸºç¤å¹´é‡‘ç•ªå· <span class="required">*</span></label>
            <div class="basic-pension-number-container">
              <input 
                type="text" 
                id="onboarding-basicPensionNumberPart1" 
                formControlName="basicPensionNumberPart1" 
                class="form-input basic-pension-part"
                maxlength="4"
                placeholder="0000"
                (input)="formatOnboardingBasicPensionNumberInput($event, 1)"
              >
              <span class="basic-pension-separator">-</span>
              <input 
                type="text" 
                id="onboarding-basicPensionNumberPart2" 
                formControlName="basicPensionNumberPart2" 
                class="form-input basic-pension-part"
                maxlength="6"
                placeholder="000000"
                (input)="formatOnboardingBasicPensionNumberInput($event, 2)"
              >
            </div>
            <div *ngIf="(onboardingApplicationForm.get('basicPensionNumberPart1')?.invalid || onboardingApplicationForm.get('basicPensionNumberPart2')?.invalid) && (onboardingApplicationForm.get('basicPensionNumberPart1')?.touched || onboardingApplicationForm.get('basicPensionNumberPart2')?.touched)" class="error-message">
              <span *ngIf="onboardingApplicationForm.get('basicPensionNumberPart1')?.errors?.['required'] || onboardingApplicationForm.get('basicPensionNumberPart2')?.errors?.['required']">
                åŸºç¤å¹´é‡‘ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
              <span *ngIf="onboardingApplicationForm.get('basicPensionNumberPart1')?.errors?.['pattern'] || onboardingApplicationForm.get('basicPensionNumberPart2')?.errors?.['pattern']">
                åŠè§’æ•°å­—ã®ã¿ã§å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-pensionHistoryStatus">åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´ <span class="required">*</span></label>
            <select 
              id="onboarding-pensionHistoryStatus" 
              formControlName="pensionHistoryStatus" 
              class="form-input" 
              (change)="onPensionHistoryChange($event)"
            >
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option *ngFor="let option of pensionHistoryOptions" [value]="option">{{ option }}</option>
            </select>
            <div *ngIf="onboardingApplicationForm.get('pensionHistoryStatus')?.invalid && onboardingApplicationForm.get('pensionHistoryStatus')?.touched" class="error-message">
              åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´ã‚’é¸æŠã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group full-width">
            <label for="onboarding-basicPensionNumberDoc">åŸºç¤å¹´é‡‘ç•ªå·ç¢ºèªæ›¸é¡æ·»ä»˜</label>
            <input 
              type="file" 
              id="onboarding-basicPensionNumberDoc" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'basicPensionNumberDoc')"
            >
            <div *ngIf="basicPensionNumberDocFile" class="file-name">{{ basicPensionNumberDocFile.name }}</div>
          </div>
          <div class="form-group full-width" *ngIf="hasPensionHistory">
            <label for="onboarding-pensionHistory">åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´ï¼ˆè©³ç´°ï¼‰</label>
            <textarea 
              id="onboarding-pensionHistory" 
              formControlName="pensionHistory" 
              class="form-input" 
              rows="4"
            ></textarea>
          </div>
        </div>
      </section>

      <!-- æ‰¶é¤Šè€…æœ‰ç„¡æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">æ‰¶é¤Šè€…æœ‰ç„¡</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-dependentStatus">è¢«æ‰¶é¤Šè€… <span class="required">*</span></label>
            <select 
              id="onboarding-dependentStatus" 
              formControlName="dependentStatus" 
              class="form-input"
            >
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
            <div *ngIf="onboardingApplicationForm.get('dependentStatus')?.invalid && onboardingApplicationForm.get('dependentStatus')?.touched" class="error-message">
              è¢«æ‰¶é¤Šè€…ã‚’é¸æŠã—ã¦ãã ã•ã„
            </div>
          </div>
        </div>
      </section>

      <!-- è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦</h3>
        <div class="form-grid">
          <div class="form-group">
            <label>è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦ <span class="required">*</span></label>
            <div class="radio-group">
              <label class="radio-label">
                <input 
                  type="radio" 
                  formControlName="qualificationCertificateRequired" 
                  value="å¿…è¦"
                  name="qualificationCertificateRequired"
                >
                å¿…è¦
              </label>
              <label class="radio-label">
                <input 
                  type="radio" 
                  formControlName="qualificationCertificateRequired" 
                  value="ä¸è¦"
                  name="qualificationCertificateRequired"
                >
                ä¸è¦
              </label>
            </div>
            <div *ngIf="onboardingApplicationForm.get('qualificationCertificateRequired')?.invalid && onboardingApplicationForm.get('qualificationCertificateRequired')?.touched" class="error-message">
              è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦ã‚’é¸æŠã—ã¦ãã ã•ã„
            </div>
          </div>
        </div>
      </section>

      <!-- å¹´é‡‘åŸºé‡‘åŠ å…¥æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">å¹´é‡‘åŸºé‡‘åŠ å…¥</h3>
        <div class="form-grid">
          <div class="form-group">
            <label>å¹´é‡‘åŸºé‡‘ã«åŠ å…¥ã—ã¦ã„ã‚‹ã‹ <span class="required">*</span></label>
            <div class="radio-group">
              <label class="radio-label">
                <input 
                  type="radio" 
                  formControlName="pensionFundMembership" 
                  value="ã¯ã„"
                  name="pensionFundMembership"
                >
                ã¯ã„
              </label>
              <label class="radio-label">
                <input 
                  type="radio" 
                  formControlName="pensionFundMembership" 
                  value="ã„ã„ãˆ"
                  name="pensionFundMembership"
                >
                ã„ã„ãˆ
              </label>
            </div>
            <div *ngIf="onboardingApplicationForm.get('pensionFundMembership')?.invalid && onboardingApplicationForm.get('pensionFundMembership')?.touched" class="error-message">
              å¹´é‡‘åŸºé‡‘ã«åŠ å…¥ã—ã¦ã„ã‚‹ã‹ã‚’é¸æŠã—ã¦ãã ã•ã„
            </div>
          </div>
        </div>
      </section>

      <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="closeApplicationModal()" [disabled]="isSubmittingOnboardingApplication">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="submit" class="submit-button" [disabled]="onboardingApplicationForm.invalid || isSubmittingOnboardingApplication">
          {{ isSubmittingOnboardingApplication ? 'ç”³è«‹ä¸­...' : 'ç”³è«‹' }}
        </button>
      </div>
    </form>
  </div>
</div>

<!-- æ‰¶é¤Šå®¶æ—è¿½åŠ ç”³è«‹ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-overlay" *ngIf="showApplicationModal && currentApplicationType === 'æ‰¶é¤Šå®¶æ—è¿½åŠ '">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">æ‰¶é¤Šå®¶æ—è¿½åŠ ç”³è«‹</h2>
      <button class="modal-close-button" (click)="closeApplicationModal()">Ã—</button>
    </div>
    
    <form [formGroup]="dependentApplicationForm" (ngSubmit)="submitDependentApplication()" class="application-form">
      <!-- ç¶šæŸ„æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">ç¶šæŸ„ <span class="required">*</span></h3>
        <div class="form-group">
          <label class="radio-label">
            <input type="radio" formControlName="relationshipType" value="é…å¶è€…" (change)="onRelationshipTypeChange()">
            é…å¶è€…
          </label>
          <label class="radio-label">
            <input type="radio" formControlName="relationshipType" value="é…å¶è€…ä»¥å¤–" (change)="onRelationshipTypeChange()">
            é…å¶è€…ä»¥å¤–
          </label>
        </div>
        <div *ngIf="dependentApplicationForm.get('relationshipType')?.invalid && dependentApplicationForm.get('relationshipType')?.touched" class="error-message">
          ç¶šæŸ„ã‚’é¸æŠã—ã¦ãã ã•ã„
        </div>
        
        <!-- é…å¶è€…é¸æŠæ™‚ -->
        <div *ngIf="dependentApplicationForm.get('relationshipType')?.value === 'é…å¶è€…'" class="form-group">
          <label for="spouseType">é…å¶è€…ã®ç¨®åˆ¥ <span class="required">*</span></label>
          <select 
            id="spouseType" 
            formControlName="spouseType" 
            class="form-input"
            (change)="onSpouseTypeChange()"
          >
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="å¦»">å¦»</option>
            <option value="å¤«">å¤«</option>
          </select>
        </div>
        <div *ngIf="dependentApplicationForm.get('relationshipType')?.value === 'é…å¶è€…' && dependentApplicationForm.get('spouseType')?.invalid && dependentApplicationForm.get('spouseType')?.touched" class="error-message">
          å¦»ã¾ãŸã¯å¤«ã‚’é¸æŠã—ã¦ãã ã•ã„
        </div>
        
        <!-- é…å¶è€…ä»¥å¤–é¸æŠæ™‚ -->
        <div *ngIf="dependentApplicationForm.get('relationshipType')?.value === 'é…å¶è€…ä»¥å¤–'" class="form-group">
          <label for="relationship">ç¶šæŸ„ <span class="required">*</span></label>
          <input type="text" id="relationship" formControlName="relationship" class="form-input" placeholder="ä¾‹: é•·ç”·ã€é•·å¥³">
        </div>
      </section>
      
      <!-- åŸºç¤å¹´é‡‘ç•ªå· -->
      <section class="form-section">
        <h3 class="section-title">åŸºç¤å¹´é‡‘ç•ªå·</h3>
        <div class="form-group">
          <label>åŸºç¤å¹´é‡‘ç•ªå· <span class="required">*</span></label>
          <div class="basic-pension-number-container">
            <input 
              type="text" 
              id="dependentBasicPensionNumberPart1" 
              formControlName="basicPensionNumberPart1" 
              class="form-input basic-pension-part"
              maxlength="4"
              (input)="formatDependentBasicPensionNumberInput($event, 1)"
              placeholder="0000"
              aria-label="åŸºç¤å¹´é‡‘ç•ªå·ï¼ˆå‰åŠ4æ¡ï¼‰"
            >
            <span class="basic-pension-separator">-</span>
            <input 
              type="text" 
              id="dependentBasicPensionNumberPart2" 
              formControlName="basicPensionNumberPart2" 
              class="form-input basic-pension-part"
              maxlength="6"
              (input)="formatDependentBasicPensionNumberInput($event, 2)"
              placeholder="000000"
              aria-label="åŸºç¤å¹´é‡‘ç•ªå·ï¼ˆå¾ŒåŠ6æ¡ï¼‰"
            >
          </div>
          <div *ngIf="(dependentApplicationForm.get('basicPensionNumberPart1')?.invalid || dependentApplicationForm.get('basicPensionNumberPart2')?.invalid) && (dependentApplicationForm.get('basicPensionNumberPart1')?.touched || dependentApplicationForm.get('basicPensionNumberPart2')?.touched)" class="error-message">
            åŸºç¤å¹´é‡‘ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
        <div class="form-group">
          <label for="dependentBasicPensionNumberDoc">åŸºç¤å¹´é‡‘ç•ªå·ç¢ºèªæ›¸é¡æ·»ä»˜</label>
          <input 
            type="file" 
            id="dependentBasicPensionNumberDoc" 
            class="form-input"
            accept=".pdf,.jpg,.jpeg,.png"
            (change)="onDependentFileSelected($event, 'basicPensionNumberDoc')"
          >
          <div *ngIf="dependentBasicPensionNumberDocFile" class="file-name">{{ dependentBasicPensionNumberDocFile.name }}</div>
        </div>
      </section>
      
      <!-- åŸºæœ¬æƒ…å ± -->
      <section class="form-section">
        <h3 class="section-title">åŸºæœ¬æƒ…å ±</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="dependentLastName">å§“ <span class="required">*</span></label>
            <input type="text" id="dependentLastName" formControlName="lastName" class="form-input">
          </div>
          <div class="form-group">
            <label for="dependentFirstName">å <span class="required">*</span></label>
            <input type="text" id="dependentFirstName" formControlName="firstName" class="form-input">
          </div>
          <div class="form-group">
            <label for="dependentLastNameKana">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
            <input type="text" id="dependentLastNameKana" formControlName="lastNameKana" class="form-input">
          </div>
          <div class="form-group">
            <label for="dependentFirstNameKana">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
            <input type="text" id="dependentFirstNameKana" formControlName="firstNameKana" class="form-input">
          </div>
          <div class="form-group">
            <label for="dependentBirthDate">ç”Ÿå¹´æœˆæ—¥ <span class="required">*</span></label>
            <input type="date" id="dependentBirthDate" formControlName="birthDate" class="form-input">
          </div>
          <div class="form-group">
            <label for="dependentGender">æ€§åˆ¥ <span class="required">*</span></label>
            <select id="dependentGender" formControlName="gender" class="form-input">
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="ç”·æ€§">ç”·æ€§</option>
              <option value="å¥³æ€§">å¥³æ€§</option>
            </select>
          </div>
          <div class="form-group">
            <label for="dependentPhoneNumber">é›»è©±ç•ªå·</label>
            <input 
              type="tel" 
              id="dependentPhoneNumber" 
              formControlName="phoneNumber" 
              class="form-input"
              maxlength="11"
              pattern="[a-zA-Z0-9]*"
              (input)="formatDependentPhoneNumber($event)"
            >
          </div>
          <div class="form-group">
            <label for="dependentOccupation">è·æ¥­</label>
            <input type="text" id="dependentOccupation" formControlName="occupation" class="form-input">
          </div>
        </div>
      </section>
      
      <!-- åå…¥æƒ…å ± -->
      <section class="form-section">
        <h3 class="section-title">åå…¥æƒ…å ±</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="dependentAnnualIncome">æ‰¶é¤Šè¿½åŠ æ—¥ã‹ã‚‰ã®å¹´é–“åå…¥è¦‹è¾¼ã¿é¡</label>
            <input type="number" id="dependentAnnualIncome" formControlName="annualIncome" class="form-input" placeholder="å††">
          </div>
          <div class="form-group">
            <label for="dependentMonthlyIncome">æ‰¶é¤Šè¿½åŠ æ—¥ã‹ã‚‰ã®æœˆé¡åå…¥è¦‹è¾¼ã¿é¡</label>
            <input type="number" id="dependentMonthlyIncome" formControlName="monthlyIncome" class="form-input" placeholder="å††">
          </div>
          <div class="form-group">
            <label for="dependentStartDate">ç¤¾ä¼šä¿é™ºã®æ‰¶é¤Šè€…ã¨ãªã£ãŸæ—¥ <span class="required">*</span></label>
            <input type="date" id="dependentStartDate" formControlName="dependentStartDate" class="form-input">
          </div>
          <div class="form-group full-width">
            <label for="dependentReason">æ‰¶é¤Šã«è¿½åŠ ã•ã‚ŒãŸç†ç”±</label>
            <textarea id="dependentReason" formControlName="dependentReason" class="form-input" rows="3"></textarea>
          </div>
        </div>
      </section>
      
      <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ -->
      <section class="form-section">
        <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼</h3>
        <div class="form-group">
          <label>ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã®æä¾› <span class="required">*</span></label>
          <div>
            <label class="radio-label">
              <input type="radio" formControlName="provideMyNumber" value="æä¾›ã™ã‚‹" (change)="onProvideMyNumberChange()">
              æä¾›ã™ã‚‹
            </label>
            <label class="radio-label">
              <input type="radio" formControlName="provideMyNumber" value="æä¾›ã—ãªã„" (change)="onProvideMyNumberChange()">
              æä¾›ã—ãªã„
            </label>
          </div>
          <div *ngIf="dependentApplicationForm.get('provideMyNumber')?.invalid && dependentApplicationForm.get('provideMyNumber')?.touched" class="error-message">
            ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã®æä¾›ã‚’é¸æŠã—ã¦ãã ã•ã„
          </div>
        </div>
        
        <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼æä¾›ã™ã‚‹å ´åˆ -->
        <div *ngIf="dependentApplicationForm.get('provideMyNumber')?.value === 'æä¾›ã™ã‚‹'">
          <div class="form-group">
            <label>ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ <span class="required">*</span></label>
            <div class="my-number-container">
              <div class="my-number-inputs">
                <input 
                  type="text" 
                  id="dependentMyNumberPart1" 
                  formControlName="myNumberPart1" 
                  class="form-input my-number-part"
                  maxlength="4"
                  (input)="formatDependentMyNumberInput($event, 1)"
                  placeholder="0000"
                  aria-label="ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ï¼ˆå‰åŠ4æ¡ï¼‰"
                >
                <span class="my-number-separator">-</span>
                <input 
                  type="text" 
                  id="dependentMyNumberPart2" 
                  formControlName="myNumberPart2" 
                  class="form-input my-number-part"
                  maxlength="4"
                  (input)="formatDependentMyNumberInput($event, 2)"
                  placeholder="0000"
                  aria-label="ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ï¼ˆä¸­ç›¤4æ¡ï¼‰"
                >
                <span class="my-number-separator">-</span>
                <input 
                  type="text" 
                  id="dependentMyNumberPart3" 
                  formControlName="myNumberPart3" 
                  class="form-input my-number-part"
                  maxlength="4"
                  (input)="formatDependentMyNumberInput($event, 3)"
                  placeholder="0000"
                  aria-label="ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ï¼ˆå¾ŒåŠ4æ¡ï¼‰"
                >
              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="dependentMyNumberCard">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰æ·»ä»˜</label>
            <input 
              type="file" 
              id="dependentMyNumberCard" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'dependentMyNumberCard')"
            >
            <div *ngIf="dependentMyNumberCardFile" class="file-name">{{ dependentMyNumberCardFile.name }}</div>
          </div>
          <div class="form-group">
            <label for="dependentMyNumberDoc">ç•ªå·ç¢ºèªæ›¸é¡æ·»ä»˜</label>
            <input 
              type="file" 
              id="dependentMyNumberDoc" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onDependentFileSelected($event, 'myNumberDoc')"
            >
            <div *ngIf="dependentMyNumberDocFile" class="file-name">{{ dependentMyNumberDocFile.name }}</div>
          </div>
          <div class="form-group">
            <label for="dependentIdentityDoc">èº«å…ƒç¢ºèªæ›¸é¡æ·»ä»˜</label>
            <input 
              type="file" 
              id="dependentIdentityDoc" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onDependentFileSelected($event, 'identityDoc')"
            >
            <div *ngIf="dependentIdentityDocFile" class="file-name">{{ dependentIdentityDocFile.name }}</div>
          </div>
        </div>
        
        <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼æä¾›ã—ãªã„å ´åˆ -->
        <div *ngIf="dependentApplicationForm.get('provideMyNumber')?.value === 'æä¾›ã—ãªã„'" class="form-group">
          <label for="dependentMyNumberNotProvidedReason">æœªæä¾›ç†ç”± <span class="required">*</span></label>
          <textarea id="dependentMyNumberNotProvidedReason" formControlName="myNumberNotProvidedReason" class="form-input" rows="3"></textarea>
        </div>
      </section>
      
      <!-- éšœãŒã„è€…æƒ…å ± -->
      <section class="form-section">
        <h3 class="section-title">éšœãŒã„è€…æƒ…å ±</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="dependentDisabilityCategory">éšœãŒã„è€…åŒºåˆ†</label>
            <input type="text" id="dependentDisabilityCategory" formControlName="disabilityCategory" class="form-input">
          </div>
          <div class="form-group">
            <label for="dependentDisabilityCardType">éšœãŒã„è€…æ‰‹å¸³ã®ç¨®é¡</label>
            <input type="text" id="dependentDisabilityCardType" formControlName="disabilityCardType" class="form-input">
          </div>
          <div class="form-group">
            <label for="dependentDisabilityCardIssueDate">éšœãŒã„è€…æ‰‹å¸³ã®äº¤ä»˜å¹´æœˆæ—¥</label>
            <input type="date" id="dependentDisabilityCardIssueDate" formControlName="disabilityCardIssueDate" class="form-input">
          </div>
          <div class="form-group full-width">
            <label for="dependentDisabilityCard">éšœãŒã„è€…æ‰‹å¸³ã®ç”»åƒæ·»ä»˜</label>
            <input 
              type="file" 
              id="dependentDisabilityCard" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onDependentFileSelected($event, 'disabilityCard')"
            >
            <div *ngIf="dependentDisabilityCardFile" class="file-name">{{ dependentDisabilityCardFile.name }}</div>
          </div>
        </div>
      </section>
      
      <!-- ä½æ‰€æƒ…å ± -->
      <section class="form-section">
        <h3 class="section-title">ä½æ‰€æƒ…å ± <span class="required">*</span></h3>
        <div class="form-group">
          <label class="radio-label">
            <input type="radio" formControlName="livingTogether" value="åŒå±…" (change)="onLivingTogetherChange()">
            åŒå±…
          </label>
          <label class="radio-label">
            <input type="radio" formControlName="livingTogether" value="åˆ¥å±…" (change)="onLivingTogetherChange()">
            åˆ¥å±…
          </label>
        </div>
        <div *ngIf="dependentApplicationForm.get('livingTogether')?.invalid && dependentApplicationForm.get('livingTogether')?.touched" class="error-message">
          åŒå±…/åˆ¥å±…ã‚’é¸æŠã—ã¦ãã ã•ã„
        </div>
        
        <!-- åˆ¥å±…ã®å ´åˆ -->
        <div *ngIf="dependentApplicationForm.get('livingTogether')?.value === 'åˆ¥å±…'" class="form-grid">
          <div class="form-group">
            <label for="dependentPostalCode">éƒµä¾¿ç•ªå· <span class="required">*</span></label>
            <input 
              type="text" 
              id="dependentPostalCode" 
              formControlName="postalCode" 
              class="form-input" 
              placeholder="ä¾‹: 1234567"
              maxlength="7"
              pattern="[a-zA-Z0-9]*"
              (input)="formatDependentPostalCode($event)"
            >
          </div>
          <div class="form-group full-width">
            <label for="dependentAddress">ä½æ‰€ <span class="required">*</span></label>
            <textarea id="dependentAddress" formControlName="address" class="form-input" rows="2"></textarea>
          </div>
          <div class="form-group full-width">
            <label for="dependentAddressKana">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
            <textarea id="dependentAddressKana" formControlName="addressKana" class="form-input" rows="2"></textarea>
          </div>
          <div class="form-group">
            <label for="dependentAddressChangeDate">ä½æ‰€å¤‰æ›´å¹´æœˆæ—¥</label>
            <input type="date" id="dependentAddressChangeDate" formControlName="addressChangeDate" class="form-input">
          </div>
        </div>
      </section>
      
      <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="closeApplicationModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="submit" class="submit-button" [disabled]="dependentApplicationForm.invalid">ç”³è«‹</button>
      </div>
    </form>
  </div>
</div>

<!-- æ‰¶é¤Šå‰Šé™¤ç”³è«‹ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-overlay" *ngIf="showApplicationModal && currentApplicationType === 'æ‰¶é¤Šå‰Šé™¤ç”³è«‹'">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">æ‰¶é¤Šå‰Šé™¤ç”³è«‹</h2>
      <button class="modal-close-button" (click)="closeApplicationModal()">Ã—</button>
    </div>
    
    <form [formGroup]="dependentRemovalForm" (ngSubmit)="submitDependentRemovalApplication()" class="application-form">
      <!-- è¢«æ‰¶é¤Šè€…ç§»å‹•æ—¥ -->
      <section class="form-section">
        <h3 class="section-title">è¢«æ‰¶é¤Šè€…ç§»å‹•æ—¥</h3>
        <div class="form-group">
          <label for="removalDate">è¢«æ‰¶é¤Šè€…ç§»å‹•æ—¥ <span class="required">*</span></label>
          <input 
            type="date" 
            id="removalDate" 
            formControlName="removalDate" 
            class="form-input"
          >
          <div *ngIf="dependentRemovalForm.get('removalDate')?.invalid && dependentRemovalForm.get('removalDate')?.touched" class="error-message">
            è¢«æ‰¶é¤Šè€…ç§»å‹•æ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- è¢«æ‰¶é¤Šè€…æƒ…å ± -->
      <section class="form-section">
        <h3 class="section-title">è¢«æ‰¶é¤Šè€…æƒ…å ±</h3>
        <div class="form-group">
          <label for="dependentId">è¢«æ‰¶é¤Šè€… <span class="required">*</span></label>
          <select 
            id="dependentId" 
            formControlName="dependentId" 
            class="form-input"
          >
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option *ngFor="let dependent of dependentsData; let i = index" [value]="i">
              {{ dependent.name || 'ï¼ˆæ°åæœªè¨­å®šï¼‰' }} 
              <span *ngIf="dependent.relationship">ï¼ˆ{{ dependent.relationship }}ï¼‰</span>
            </option>
          </select>
          <div *ngIf="dependentRemovalForm.get('dependentId')?.invalid && dependentRemovalForm.get('dependentId')?.touched" class="error-message">
            è¢«æ‰¶é¤Šè€…ã‚’é¸æŠã—ã¦ãã ã•ã„
          </div>
          <div *ngIf="dependentsData.length === 0" class="info-message">
            ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹æ‰¶é¤Šè€…ãŒã„ã¾ã›ã‚“ã€‚
          </div>
        </div>
      </section>
      
      <!-- æ‰¶é¤Šå‰Šé™¤ã®ç†ç”± -->
      <section class="form-section">
        <h3 class="section-title">æ‰¶é¤Šå‰Šé™¤ã®ç†ç”±</h3>
        <div class="form-group">
          <label for="removalReason">æ‰¶é¤Šå‰Šé™¤ã®ç†ç”± <span class="required">*</span></label>
          <textarea 
            id="removalReason" 
            formControlName="removalReason" 
            class="form-input"
            rows="4"
            placeholder="æ‰¶é¤Šå‰Šé™¤ã®ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
          ></textarea>
          <div *ngIf="dependentRemovalForm.get('removalReason')?.invalid && dependentRemovalForm.get('removalReason')?.touched" class="error-message">
            æ‰¶é¤Šå‰Šé™¤ã®ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="closeApplicationModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="submit" class="submit-button" [disabled]="dependentRemovalForm.invalid || dependentsData.length === 0">
          ç”³è«‹
        </button>
      </div>
    </form>
  </div>
</div>

<!-- ä½æ‰€å¤‰æ›´ç”³è«‹ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-overlay" *ngIf="showApplicationModal && currentApplicationType === 'ä½æ‰€å¤‰æ›´ç”³è«‹'">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">ä½æ‰€å¤‰æ›´ç”³è«‹</h2>
      <button class="modal-close-button" (click)="closeApplicationModal()">Ã—</button>
    </div>
    
    <form [formGroup]="addressChangeForm" (ngSubmit)="submitAddressChangeApplication()" class="application-form">
      <!-- å¼•ã£è¶Šã—ã—ãŸæ—¥ -->
      <section class="form-section">
        <h3 class="section-title">å¼•ã£è¶Šã—ã—ãŸæ—¥</h3>
        <div class="form-group">
          <label for="moveDate">å¼•ã£è¶Šã—ã—ãŸæ—¥ <span class="required">*</span></label>
          <input 
            type="date" 
            id="moveDate" 
            formControlName="moveDate" 
            class="form-input"
          >
          <div *ngIf="addressChangeForm.get('moveDate')?.invalid && addressChangeForm.get('moveDate')?.touched" class="error-message">
            å¼•ã£è¶Šã—ã—ãŸæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- æ–°ã—ã„ä½æ‰€æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">æ–°ã—ã„ä½æ‰€</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="newPostalCode">éƒµä¾¿ç•ªå· <span class="required">*</span></label>
            <input 
              type="text" 
              id="newPostalCode" 
              formControlName="newPostalCode" 
              class="form-input"
              placeholder="1234567"
              maxlength="7"
              pattern="[0-9]{7}"
              (input)="formatAddressPostalCode($event)"
            >
            <div *ngIf="addressChangeForm.get('newPostalCode')?.invalid && addressChangeForm.get('newPostalCode')?.touched" class="error-message">
              <span *ngIf="addressChangeForm.get('newPostalCode')?.errors?.['required']">
                éƒµä¾¿ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
              <span *ngIf="addressChangeForm.get('newPostalCode')?.errors?.['pattern']">
                7æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
              </span>
            </div>
          </div>
          <div class="form-group full-width">
            <label for="newAddress">ä½æ‰€ <span class="required">*</span></label>
            <textarea 
              id="newAddress" 
              formControlName="newAddress" 
              class="form-input"
              rows="2"
            ></textarea>
            <div *ngIf="addressChangeForm.get('newAddress')?.invalid && addressChangeForm.get('newAddress')?.touched" class="error-message">
              ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group full-width">
            <label for="newAddressKana">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
            <textarea 
              id="newAddressKana" 
              formControlName="newAddressKana" 
              class="form-input"
              rows="2"
            ></textarea>
          </div>
        </div>
      </section>
      
      <!-- æ–°ã—ã„ä½æ°‘ç¥¨ä½æ‰€æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">æ–°ã—ã„ä½æ°‘ç¥¨ä½æ‰€</h3>
        <div class="form-group">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              [checked]="sameAsOldAddress"
              (change)="onSameAsOldAddressChange($event)"
            >
            å¤‰æ›´å‰ä½æ‰€ã¨åŒã˜
          </label>
        </div>
        <div class="form-group">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              [checked]="sameAsNewAddress"
              (change)="onSameAsNewAddressChange($event)"
            >
            å¤‰æ›´å¾Œã®ä½æ‰€ã¨åŒã˜
          </label>
        </div>
        <div class="form-grid" *ngIf="!sameAsOldAddress && !sameAsNewAddress">
          <div class="form-group">
            <label for="residentPostalCode">éƒµä¾¿ç•ªå·</label>
            <input 
              type="text" 
              id="residentPostalCode" 
              formControlName="residentPostalCode" 
              class="form-input"
              placeholder="1234567"
              maxlength="7"
              pattern="[0-9]{7}"
              (input)="formatResidentPostalCodeForAddressChange($event)"
            >
          </div>
          <div class="form-group full-width">
            <label for="residentAddress">ä½æ‰€</label>
            <textarea 
              id="residentAddress" 
              formControlName="residentAddress" 
              class="form-input"
              rows="2"
            ></textarea>
          </div>
          <div class="form-group full-width">
            <label for="residentAddressKana">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰</label>
            <textarea 
              id="residentAddressKana" 
              formControlName="residentAddressKana" 
              class="form-input"
              rows="2"
            ></textarea>
          </div>
        </div>
      </section>
      
      <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="closeApplicationModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="submit" class="submit-button" [disabled]="addressChangeForm.invalid">
          ç”³è«‹
        </button>
      </div>
    </form>
  </div>
</div>

<!-- æ°åå¤‰æ›´ç”³è«‹ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-overlay" *ngIf="showApplicationModal && currentApplicationType === 'æ°åå¤‰æ›´ç”³è«‹'">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">æ°åå¤‰æ›´ç”³è«‹</h2>
      <button class="modal-close-button" (click)="closeApplicationModal()">Ã—</button>
    </div>
    
    <form [formGroup]="nameChangeForm" (ngSubmit)="submitNameChangeApplication()" class="application-form">
      <!-- æ°åå¤‰æ›´ã—ãŸæ—¥ -->
      <section class="form-section">
        <h3 class="section-title">æ°åå¤‰æ›´ã—ãŸæ—¥</h3>
        <div class="form-group">
          <label for="changeDate">æ°åå¤‰æ›´ã—ãŸæ—¥ <span class="required">*</span></label>
          <input 
            type="date" 
            id="changeDate" 
            formControlName="changeDate" 
            class="form-input"
          >
          <div *ngIf="nameChangeForm.get('changeDate')?.invalid && nameChangeForm.get('changeDate')?.touched" class="error-message">
            æ°åå¤‰æ›´ã—ãŸæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- æ–°ã—ã„æ°åæ¬„ -->
      <section class="form-section">
        <h3 class="section-title">æ–°ã—ã„æ°å</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="newLastName">å§“ <span class="required">*</span></label>
            <input 
              type="text" 
              id="newLastName" 
              formControlName="newLastName" 
              class="form-input"
            >
            <div *ngIf="nameChangeForm.get('newLastName')?.invalid && nameChangeForm.get('newLastName')?.touched" class="error-message">
              å§“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="newFirstName">å <span class="required">*</span></label>
            <input 
              type="text" 
              id="newFirstName" 
              formControlName="newFirstName" 
              class="form-input"
            >
            <div *ngIf="nameChangeForm.get('newFirstName')?.invalid && nameChangeForm.get('newFirstName')?.touched" class="error-message">
              åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="newLastNameKana">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required">*</span></label>
            <input 
              type="text" 
              id="newLastNameKana" 
              formControlName="newLastNameKana" 
              class="form-input"
            >
            <div *ngIf="nameChangeForm.get('newLastNameKana')?.invalid && nameChangeForm.get('newLastNameKana')?.touched" class="error-message">
              å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="newFirstNameKana">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required">*</span></label>
            <input 
              type="text" 
              id="newFirstNameKana" 
              formControlName="newFirstNameKana" 
              class="form-input"
            >
            <div *ngIf="nameChangeForm.get('newFirstNameKana')?.invalid && nameChangeForm.get('newFirstNameKana')?.touched" class="error-message">
              åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
        </div>
      </section>
      
      <!-- æœ¬äººç¢ºèªæ›¸é¡æ·»ä»˜ -->
      <section class="form-section">
        <h3 class="section-title">æœ¬äººç¢ºèªæ›¸é¡æ·»ä»˜</h3>
        <div class="form-group">
          <label for="nameChangeIdDocument">æœ¬äººç¢ºèªæ›¸é¡æ·»ä»˜</label>
          <input 
            type="file" 
            id="nameChangeIdDocument" 
            class="form-input"
            accept=".pdf,.jpg,.jpeg,.png"
            (change)="onFileSelected($event, 'nameChangeIdDocument')"
          >
          <div *ngIf="nameChangeIdDocumentFile" class="file-name">{{ nameChangeIdDocumentFile.name }}</div>
        </div>
      </section>
      
      <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="closeApplicationModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="submit" class="submit-button" [disabled]="nameChangeForm.invalid">
          ç”³è«‹
        </button>
      </div>
    </form>
  </div>
</div>

<!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ç”³è«‹ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-overlay" *ngIf="showApplicationModal && currentApplicationType === 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ç”³è«‹'">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ç”³è«‹</h2>
      <button class="modal-close-button" (click)="closeApplicationModal()">Ã—</button>
    </div>
    
    <form [formGroup]="myNumberChangeForm" (ngSubmit)="submitMyNumberChangeApplication()" class="application-form">
      <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥ -->
      <section class="form-section">
        <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥</h3>
        <div class="form-group">
          <label for="changeDate">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥ <span class="required">*</span></label>
          <input 
            type="date" 
            id="changeDate" 
            formControlName="changeDate" 
            class="form-input"
          >
          <div *ngIf="myNumberChangeForm.get('changeDate')?.invalid && myNumberChangeForm.get('changeDate')?.touched" class="error-message">
            ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- æ–°ã—ã„ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼æ¬„ -->
      <section class="form-section">
        <h3 class="section-title">æ–°ã—ã„ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="newMyNumberPart1">1-4æ¡ç›® <span class="required">*</span></label>
            <input 
              type="text" 
              id="newMyNumberPart1" 
              formControlName="newMyNumberPart1" 
              class="form-input"
              maxlength="4"
              pattern="[0-9]*"
              inputmode="numeric"
            >
            <div *ngIf="myNumberChangeForm.get('newMyNumberPart1')?.invalid && myNumberChangeForm.get('newMyNumberPart1')?.touched" class="error-message">
              4æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="newMyNumberPart2">5-8æ¡ç›® <span class="required">*</span></label>
            <input 
              type="text" 
              id="newMyNumberPart2" 
              formControlName="newMyNumberPart2" 
              class="form-input"
              maxlength="4"
              pattern="[0-9]*"
              inputmode="numeric"
            >
            <div *ngIf="myNumberChangeForm.get('newMyNumberPart2')?.invalid && myNumberChangeForm.get('newMyNumberPart2')?.touched" class="error-message">
              4æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group">
            <label for="newMyNumberPart3">9-12æ¡ç›® <span class="required">*</span></label>
            <input 
              type="text" 
              id="newMyNumberPart3" 
              formControlName="newMyNumberPart3" 
              class="form-input"
              maxlength="4"
              pattern="[0-9]*"
              inputmode="numeric"
            >
            <div *ngIf="myNumberChangeForm.get('newMyNumberPart3')?.invalid && myNumberChangeForm.get('newMyNumberPart3')?.touched" class="error-message">
              4æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </div>
          </div>
          <div class="form-group full-width">
            <label for="myNumberChangeCard">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰æ·»ä»˜</label>
            <input 
              type="file" 
              id="myNumberChangeCard" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'myNumberChangeCard')"
            >
            <div *ngIf="myNumberChangeCardFile" class="file-name">{{ myNumberChangeCardFile.name }}</div>
          </div>
        </div>
      </section>
      
      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="closeApplicationModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="submit" class="submit-button" [disabled]="myNumberChangeForm.invalid">
          ç”³è«‹
        </button>
      </div>
    </form>
  </div>
</div>

<!-- ç”£å‰ç”£å¾Œä¼‘æ¥­ç”³è«‹ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-overlay" *ngIf="showApplicationModal && currentApplicationType === 'ç”£å‰ç”£å¾Œä¼‘æ¥­ç”³è«‹'">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">ç”£å‰ç”£å¾Œä¼‘æ¥­ç”³è«‹</h2>
      <button class="modal-close-button" (click)="closeApplicationModal()">Ã—</button>
    </div>
    
    <form [formGroup]="maternityLeaveForm" (ngSubmit)="submitMaternityLeaveApplication()" class="application-form">
      <!-- å‡ºç”£äºˆå®šæ—¥ -->
      <section class="form-section">
        <h3 class="section-title">å‡ºç”£äºˆå®šæ—¥</h3>
        <div class="form-group">
          <label for="expectedDeliveryDate">å‡ºç”£äºˆå®šæ—¥ <span class="required">*</span></label>
          <input 
            type="date" 
            id="expectedDeliveryDate" 
            formControlName="expectedDeliveryDate" 
            class="form-input"
          >
          <div *ngIf="maternityLeaveForm.get('expectedDeliveryDate')?.invalid && maternityLeaveForm.get('expectedDeliveryDate')?.touched" class="error-message">
            å‡ºç”£äºˆå®šæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- åŒå­ä»¥ä¸Šã‹ -->
      <section class="form-section">
        <h3 class="section-title">åŒå­ä»¥ä¸Šã‹ <span class="required">*</span></h3>
        <div class="form-group">
          <label class="radio-label">
            <input type="radio" formControlName="isMultipleBirth" value="ã¯ã„">
            ã¯ã„
          </label>
          <label class="radio-label">
            <input type="radio" formControlName="isMultipleBirth" value="ã„ã„ãˆ">
            ã„ã„ãˆ
          </label>
          <div *ngIf="maternityLeaveForm.get('isMultipleBirth')?.invalid && maternityLeaveForm.get('isMultipleBirth')?.touched" class="error-message">
            é¸æŠã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- ç”£å‰ç”£å¾Œä¼‘æ¥­æœŸé–“ -->
      <section class="form-section">
        <h3 class="section-title">ç”£å‰ç”£å¾Œä¼‘æ¥­æœŸé–“</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="maternityLeaveStartDate">ç”£å‰ç”£å¾Œä¼‘æ¥­é–‹å§‹æ—¥</label>
            <input 
              type="date" 
              id="maternityLeaveStartDate" 
              formControlName="maternityLeaveStartDate" 
              class="form-input"
              [disabled]="!maternityLeaveForm.get('expectedDeliveryDate')?.value"
            >
            <small class="form-hint" *ngIf="!maternityLeaveForm.get('expectedDeliveryDate')?.value">
              å‡ºç”£äºˆå®šæ—¥ã‚’å…¥åŠ›ã™ã‚‹ã¨è‡ªå‹•ã§è¨­å®šã•ã‚Œã¾ã™
            </small>
          </div>
          <div class="form-group">
            <label for="maternityLeaveEndDate">ç”£å‰ç”£å¾Œä¼‘æ¥­çµ‚äº†æ—¥</label>
            <input 
              type="date" 
              id="maternityLeaveEndDate" 
              formControlName="maternityLeaveEndDate" 
              class="form-input"
              [disabled]="!maternityLeaveForm.get('expectedDeliveryDate')?.value"
            >
            <small class="form-hint" *ngIf="!maternityLeaveForm.get('expectedDeliveryDate')?.value">
              å‡ºç”£äºˆå®šæ—¥ã‚’å…¥åŠ›ã™ã‚‹ã¨è‡ªå‹•ã§è¨­å®šã•ã‚Œã¾ã™
            </small>
          </div>
        </div>
      </section>
      
      <!-- ä¼‘æ¥­ä¸­ã®æ»åœ¨å…ˆ -->
      <section class="form-section">
        <h3 class="section-title">ä¼‘æ¥­ä¸­ã®æ»åœ¨å…ˆ</h3>
        <div class="form-group">
          <label for="stayAddress">ä¼‘æ¥­ä¸­ã®æ»åœ¨å…ˆï¼ˆç¾ä½æ‰€ã¨ç•°ãªã‚‹å ´åˆï¼‰</label>
          <textarea 
            id="stayAddress" 
            formControlName="stayAddress" 
            class="form-input"
            rows="3"
            placeholder="ç¾ä½æ‰€ã¨ç•°ãªã‚‹å ´åˆã®ã¿å…¥åŠ›ã—ã¦ãã ã•ã„"
          ></textarea>
        </div>
      </section>
      
      <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="closeApplicationModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="submit" class="submit-button" [disabled]="maternityLeaveForm.invalid">
          ç”³è«‹
        </button>
      </div>
    </form>
  </div>
</div>

<!-- é€€è·ç”³è«‹ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-overlay" *ngIf="showApplicationModal && currentApplicationType === 'é€€è·ç”³è«‹'">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">é€€è·ç”³è«‹</h2>
      <button class="modal-close-button" (click)="closeApplicationModal()">Ã—</button>
    </div>
    
    <form [formGroup]="resignationForm" (ngSubmit)="submitResignationApplication()" class="application-form">
      <!-- é€€è·æ—¥ -->
      <section class="form-section">
        <h3 class="section-title">é€€è·æ—¥</h3>
        <div class="form-group">
          <label for="resignationDate">é€€è·æ—¥ <span class="required">*</span></label>
          <input 
            type="date" 
            id="resignationDate" 
            formControlName="resignationDate" 
            class="form-input"
            [min]="minResignationDate"
          >
          <div *ngIf="resignationForm.get('resignationDate')?.invalid && resignationForm.get('resignationDate')?.touched" class="error-message">
            <span *ngIf="resignationForm.get('resignationDate')?.errors?.['required']">é€€è·æ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
            <span *ngIf="resignationForm.get('resignationDate')?.errors?.['pastDate']">é€€è·æ—¥ã¯ä»Šæ—¥ä»¥é™ã®æ—¥ä»˜ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
          </div>
        </div>
      </section>
      
      <!-- æœ€çµ‚å‡ºç¤¾æ—¥ -->
      <section class="form-section">
        <h3 class="section-title">æœ€çµ‚å‡ºç¤¾æ—¥</h3>
        <div class="form-group">
          <label for="lastWorkDate">æœ€çµ‚å‡ºç¤¾æ—¥ <span class="required">*</span></label>
          <input 
            type="date" 
            id="lastWorkDate" 
            formControlName="lastWorkDate" 
            class="form-input"
            [max]="maxLastWorkDate"
          >
          <div *ngIf="resignationForm.get('lastWorkDate')?.invalid && resignationForm.get('lastWorkDate')?.touched" class="error-message">
            <span *ngIf="resignationForm.get('lastWorkDate')?.errors?.['required']">æœ€çµ‚å‡ºç¤¾æ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
            <span *ngIf="resignationForm.get('lastWorkDate')?.errors?.['lastWorkDateAfterResignation']">æœ€çµ‚å‡ºç¤¾æ—¥ã¯é€€è·æ—¥ã‚ˆã‚Šå‰ã®æ—¥ä»˜ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
          </div>
        </div>
      </section>
      
      <!-- é€€è·ç†ç”± -->
      <section class="form-section">
        <h3 class="section-title">é€€è·ç†ç”±</h3>
        <div class="form-group">
          <label for="resignationReason">é€€è·ç†ç”± <span class="required">*</span></label>
          <textarea 
            id="resignationReason" 
            formControlName="resignationReason" 
            class="form-input"
            rows="4"
            placeholder="é€€è·ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
          ></textarea>
          <div *ngIf="resignationForm.get('resignationReason')?.invalid && resignationForm.get('resignationReason')?.touched" class="error-message">
            é€€è·ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- é›¢è·ç¥¨ã®ç™ºè¡Œã«ã¤ã„ã¦ -->
      <section class="form-section">
        <h3 class="section-title">é›¢è·ç¥¨ã®ç™ºè¡Œã«ã¤ã„ã¦</h3>
        <div class="form-group">
          <label class="radio-label">
            <input type="radio" formControlName="separationNotice" value="ç™ºè¡Œã‚’å¸Œæœ›ã™ã‚‹">
            ç™ºè¡Œã‚’å¸Œæœ›ã™ã‚‹
          </label>
          <label class="radio-label">
            <input type="radio" formControlName="separationNotice" value="ç™ºè¡Œã‚’å¸Œæœ›ã—ãªã„">
            ç™ºè¡Œã‚’å¸Œæœ›ã—ãªã„
          </label>
          <div *ngIf="resignationForm.get('separationNotice')?.invalid && resignationForm.get('separationNotice')?.touched" class="error-message">
            é¸æŠã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- é€€è·å¾Œã®ä½æ‰€ -->
      <section class="form-section">
        <h3 class="section-title">é€€è·å¾Œã®ä½æ‰€</h3>
        <div class="form-group">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              [checked]="sameAsCurrentAddressForResignation"
              (change)="onSameAsCurrentAddressForResignationChange($event)"
            >
            å¤‰æ›´ãªã—ï¼ˆç¾åœ¨ã®ä½æ‰€ã‚’ä½¿ç”¨ï¼‰
          </label>
        </div>
        <div class="form-group">
          <label for="postResignationAddress">é€€è·å¾Œã®ä½æ‰€ <span class="required" *ngIf="!sameAsCurrentAddressForResignation">*</span></label>
          <textarea 
            id="postResignationAddress" 
            formControlName="postResignationAddress" 
            class="form-input"
            rows="3"
          ></textarea>
          <div *ngIf="!sameAsCurrentAddressForResignation && resignationForm.get('postResignationAddress')?.invalid && resignationForm.get('postResignationAddress')?.touched" class="error-message">
            é€€è·å¾Œã®ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- é€€è·å¾Œã®é›»è©±ç•ªå· -->
      <section class="form-section">
        <h3 class="section-title">é€€è·å¾Œã®é›»è©±ç•ªå·</h3>
        <div class="form-group">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              [checked]="sameAsCurrentPhoneForResignation"
              (change)="onSameAsCurrentPhoneForResignationChange($event)"
            >
            å¤‰æ›´ãªã—ï¼ˆç¾åœ¨ã®é›»è©±ç•ªå·ã‚’ä½¿ç”¨ï¼‰
          </label>
        </div>
        <div class="form-group">
          <label for="postResignationPhone">é€€è·å¾Œã®é›»è©±ç•ªå· <span class="required" *ngIf="!sameAsCurrentPhoneForResignation">*</span></label>
          <input 
            type="tel" 
            id="postResignationPhone" 
            formControlName="postResignationPhone" 
            class="form-input"
          >
          <div *ngIf="!sameAsCurrentPhoneForResignation && resignationForm.get('postResignationPhone')?.invalid && resignationForm.get('postResignationPhone')?.touched" class="error-message">
            é€€è·å¾Œã®é›»è©±ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- é€€è·å¾Œã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ -->
      <section class="form-section">
        <h3 class="section-title">é€€è·å¾Œã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</h3>
        <div class="form-group">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              [checked]="sameAsCurrentEmailForResignation"
              (change)="onSameAsCurrentEmailForResignationChange($event)"
            >
            å¤‰æ›´ãªã—ï¼ˆç¾åœ¨ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ç”¨ï¼‰
          </label>
        </div>
        <div class="form-group">
          <label for="postResignationEmail">é€€è·å¾Œã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="required" *ngIf="!sameAsCurrentEmailForResignation">*</span></label>
          <input 
            type="email" 
            id="postResignationEmail" 
            formControlName="postResignationEmail" 
            class="form-input"
          >
          <div *ngIf="!sameAsCurrentEmailForResignation && resignationForm.get('postResignationEmail')?.invalid && resignationForm.get('postResignationEmail')?.touched" class="error-message">
            <span *ngIf="resignationForm.get('postResignationEmail')?.errors?.['required']">é€€è·å¾Œã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
            <span *ngIf="resignationForm.get('postResignationEmail')?.errors?.['email']">æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
          </div>
        </div>
      </section>
      
      <!-- é€€è·å¾Œã®ç¤¾ä¼šä¿é™ºåŠ å…¥ -->
      <section class="form-section">
        <h3 class="section-title">é€€è·å¾Œã®ç¤¾ä¼šä¿é™ºåŠ å…¥ <span class="required">*</span></h3>
        <div class="form-group">
          <label class="radio-label">
            <input type="radio" formControlName="postResignationInsurance" value="ç¤¾ä¼šä¿é™ºã‚’ä»»æ„ç¶™ç¶šã™ã‚‹">
            ç¤¾ä¼šä¿é™ºã‚’ä»»æ„ç¶™ç¶šã™ã‚‹
          </label>
          <label class="radio-label">
            <input type="radio" formControlName="postResignationInsurance" value="å›½æ°‘å¥åº·ä¿é™ºã«åŠ å…¥ã™ã‚‹">
            å›½æ°‘å¥åº·ä¿é™ºã«åŠ å…¥ã™ã‚‹
          </label>
          <label class="radio-label">
            <input type="radio" formControlName="postResignationInsurance" value="ä»–ç¤¾ã§ç¤¾ä¼šä¿é™ºã«åŠ å…¥ã™ã‚‹">
            ä»–ç¤¾ã§ç¤¾ä¼šä¿é™ºã«åŠ å…¥ã™ã‚‹
          </label>
          <div *ngIf="resignationForm.get('postResignationInsurance')?.invalid && resignationForm.get('postResignationInsurance')?.touched" class="error-message">
            é€€è·å¾Œã®ç¤¾ä¼šä¿é™ºåŠ å…¥ã‚’é¸æŠã—ã¦ãã ã•ã„
          </div>
        </div>
      </section>
      
      <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="closeApplicationModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="submit" class="submit-button" [disabled]="resignationForm.invalid">
          ç”³è«‹
        </button>
      </div>
    </form>
  </div>
</div>

<!-- ç”³è«‹è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div 
  class="modal-overlay" 
  *ngIf="showApplicationDetailModal" 
  [class.modal-disabled]="isSubmittingReapplication"
>
  <div class="modal-content application-detail-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">ç”³è«‹è©³ç´°</h2>
      <button 
        class="modal-close-button" 
        (click)="closeApplicationDetailModal()"
        [disabled]="isSubmittingReapplication"
        [title]="isSubmittingReapplication ? 'å‡¦ç†ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚' : ''"
      >Ã—</button>
    </div>
    
    <div class="application-detail-content" *ngIf="selectedApplication">
      <!-- ç”³è«‹åŸºæœ¬æƒ…å ± -->
      <section class="detail-section">
        <h3 class="section-title">ç”³è«‹åŸºæœ¬æƒ…å ±</h3>
        <div class="detail-grid">
          <div class="detail-item">
            <span class="detail-label">ç”³è«‹ID:</span>
            <span class="detail-value">{{ selectedApplication.applicationId }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">ç”³è«‹ç¨®é¡:</span>
            <span class="detail-value">{{ selectedApplication.applicationType }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</span>
            <span class="detail-value">
              <span class="status-badge" 
                    [class.status-pending]="selectedApplication.status === 'æ‰¿èªå¾…ã¡'"
                    [class.status-approved]="selectedApplication.status === 'æ‰¿èª' || selectedApplication.status === 'æ‰¿èªæ¸ˆã¿'"
                    [class.status-submitted]="selectedApplication.status === 'ç”³è«‹æ¸ˆã¿'"
                    [class.status-rejected]="selectedApplication.status === 'å´ä¸‹' || selectedApplication.status === 'å·®ã—æˆ»ã—'"
                    [class.status-resubmitted]="selectedApplication.status === 'å†ç”³è«‹' || selectedApplication.status === 'å†æå‡º'"
                    [class.status-cancelled]="selectedApplication.status === 'å–ã‚Šæ¶ˆã—'">
                {{ selectedApplication.status }}
              </span>
            </span>
          </div>
          <div class="detail-item full-width" *ngIf="selectedApplication.status === 'å·®ã—æˆ»ã—' && selectedApplication.statusComment">
            <span class="detail-label">å·®ã—æˆ»ã—ã‚³ãƒ¡ãƒ³ãƒˆ:</span>
            <span class="detail-value">{{ selectedApplication.statusComment }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">ç”³è«‹æ—¥:</span>
            <span class="detail-value">{{ getApplicationDate(selectedApplication) | date:'yyyyå¹´MMæœˆddæ—¥' }}</span>
          </div>
        </div>
      </section>
      
      <!-- å·®ã—æˆ»ã—ã®å ´åˆã®ä¿®æ­£ãƒ»å†ç”³è«‹ãƒœã‚¿ãƒ³ -->
      <div class="reapplication-actions" *ngIf="selectedApplication.status === 'å·®ã—æˆ»ã—'">
        <button 
          type="button" 
          class="edit-button" 
          (click)="enableEditMode()"
          *ngIf="!isEditModeForReapplication"
          [disabled]="isSubmittingReapplication"
          [title]="isSubmittingReapplication ? 'å‡¦ç†ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚' : ''"
        >
          ä¿®æ­£
        </button>
        <button 
          type="button" 
          class="resubmit-button" 
          (click)="submitReapplication()"
          *ngIf="isEditModeForReapplication"
          [disabled]="isSubmittingReapplication"
          [title]="isSubmittingReapplication ? 'å‡¦ç†ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚' : ''"
        >
          {{ isSubmittingReapplication ? 'é€ä¿¡ä¸­...' : 'å†ç”³è«‹' }}
        </button>
      </div>
      
      <!-- æ‰¶é¤Šå®¶æ—è¿½åŠ ç”³è«‹ã®è©³ç´°ï¼ˆè¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ãƒ»ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼‰ -->
      <ng-container *ngIf="selectedApplication.applicationType === 'æ‰¶é¤Šå®¶æ—è¿½åŠ '">
        <form [formGroup]="dependentApplicationForm" (ngSubmit)="submitReapplication()" *ngIf="dependentApplicationForm" class="application-detail-form" [class.form-disabled]="isSubmittingReapplication">
        <!-- ç¶šæŸ„æƒ…å ± -->
        <section class="detail-section">
          <h3 class="section-title">ç¶šæŸ„ <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span></h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">ç¶šæŸ„ç¨®åˆ¥:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.relationshipType || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <label class="radio-label">
                  <input type="radio" formControlName="relationshipType" value="é…å¶è€…" (change)="onRelationshipTypeChange()">
                  é…å¶è€…
                </label>
                <label class="radio-label">
                  <input type="radio" formControlName="relationshipType" value="é…å¶è€…ä»¥å¤–" (change)="onRelationshipTypeChange()">
                  é…å¶è€…ä»¥å¤–
                </label>
                <div *ngIf="dependentApplicationForm.get('relationshipType')?.invalid && dependentApplicationForm.get('relationshipType')?.touched" class="error-message">
                  ç¶šæŸ„ã‚’é¸æŠã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item" *ngIf="(selectedApplication.relationshipType === 'é…å¶è€…' || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentApplicationForm?.get('relationshipType')?.value === 'é…å¶è€…'))">
              <span class="detail-label">é…å¶è€…ç¨®åˆ¥:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.spouseType || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <select 
                  formControlName="spouseType" 
                  class="form-input"
                  (change)="onSpouseTypeChange()"
                >
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option value="å¦»">å¦»</option>
                  <option value="å¤«">å¤«</option>
                </select>
                <div *ngIf="dependentApplicationForm.get('spouseType')?.invalid && dependentApplicationForm.get('spouseType')?.touched" class="error-message">
                  å¦»ã¾ãŸã¯å¤«ã‚’é¸æŠã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item" *ngIf="(selectedApplication.relationshipType === 'é…å¶è€…ä»¥å¤–' || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentApplicationForm?.get('relationshipType')?.value === 'é…å¶è€…ä»¥å¤–'))">
              <span class="detail-label">ç¶šæŸ„:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.relationship || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input 
                  type="text" 
                  formControlName="relationship" 
                  class="form-input"
                  placeholder="ä¾‹ï¼šçˆ¶ã€æ¯ã€å­ãªã©"
                >
                <div *ngIf="dependentApplicationForm.get('relationship')?.invalid && dependentApplicationForm.get('relationship')?.touched" class="error-message">
                  ç¶šæŸ„ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- åŸºç¤å¹´é‡‘ç•ªå· -->
        <section class="detail-section">
          <h3 class="section-title">åŸºç¤å¹´é‡‘ç•ªå·</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">åŸºç¤å¹´é‡‘ç•ªå·:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ formatBasicPensionNumberForDisplay(selectedApplication.basicPensionNumber) }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <div class="basic-pension-number-container">
                  <input 
                    type="text" 
                    formControlName="basicPensionNumberPart1" 
                    class="form-input basic-pension-part"
                    maxlength="4"
                    (input)="formatDependentBasicPensionNumberInput($event, 1)"
                    placeholder="0000"
                  >
                  <span class="basic-pension-separator">-</span>
                  <input 
                    type="text" 
                    formControlName="basicPensionNumberPart2" 
                    class="form-input basic-pension-part"
                    maxlength="6"
                    (input)="formatDependentBasicPensionNumberInput($event, 2)"
                    placeholder="000000"
                  >
                </div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- åŸºæœ¬æƒ…å ± -->
        <section class="detail-section">
          <h3 class="section-title">åŸºæœ¬æƒ…å ±</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">å§“ <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span>:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.lastName || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="text" formControlName="lastName" class="form-input">
                <div *ngIf="dependentApplicationForm.get('lastName')?.invalid && dependentApplicationForm.get('lastName')?.touched" class="error-message">
                  å§“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">å <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span>:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.firstName || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="text" formControlName="firstName" class="form-input">
                <div *ngIf="dependentApplicationForm.get('firstName')?.invalid && dependentApplicationForm.get('firstName')?.touched" class="error-message">
                  åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.lastNameKana || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="text" formControlName="lastNameKana" class="form-input">
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.firstNameKana || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="text" formControlName="firstNameKana" class="form-input">
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">ç”Ÿå¹´æœˆæ—¥ <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span>:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.birthDate || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="date" formControlName="birthDate" class="form-input">
                <div *ngIf="dependentApplicationForm.get('birthDate')?.invalid && dependentApplicationForm.get('birthDate')?.touched" class="error-message">
                  ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">æ€§åˆ¥ <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span>:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.gender || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <select formControlName="gender" class="form-input">
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option value="ç”·æ€§">ç”·æ€§</option>
                  <option value="å¥³æ€§">å¥³æ€§</option>
                </select>
                <div *ngIf="dependentApplicationForm.get('gender')?.invalid && dependentApplicationForm.get('gender')?.touched" class="error-message">
                  æ€§åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">é›»è©±ç•ªå·:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.phoneNumber || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input 
                  type="tel" 
                  formControlName="phoneNumber" 
                  class="form-input"
                  maxlength="11"
                  pattern="[a-zA-Z0-9]*"
                  (input)="formatDependentPhoneNumber($event)"
                >
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">è·æ¥­:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.occupation || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="text" formControlName="occupation" class="form-input">
              </div>
            </div>
          </div>
        </section>
        
        <!-- åå…¥æƒ…å ± -->
        <section class="detail-section">
          <h3 class="section-title">åå…¥æƒ…å ±</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">æ‰¶é¤Šè¿½åŠ æ—¥ã‹ã‚‰ã®å¹´é–“åå…¥è¦‹è¾¼ã¿é¡:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.annualIncome ? (selectedApplication.annualIncome | number:'1.0-0') + 'å††' : '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="number" formControlName="annualIncome" class="form-input">
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">æ‰¶é¤Šè¿½åŠ æ—¥ã‹ã‚‰ã®æœˆé¡åå…¥è¦‹è¾¼ã¿é¡:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.monthlyIncome ? (selectedApplication.monthlyIncome | number:'1.0-0') + 'å††' : '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="number" formControlName="monthlyIncome" class="form-input">
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">ç¤¾ä¼šä¿é™ºã®æ‰¶é¤Šè€…ã¨ãªã£ãŸæ—¥ <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span>:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.dependentStartDate || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="date" formControlName="dependentStartDate" class="form-input">
                <div *ngIf="dependentApplicationForm.get('dependentStartDate')?.invalid && dependentApplicationForm.get('dependentStartDate')?.touched" class="error-message">
                  ç¤¾ä¼šä¿é™ºã®æ‰¶é¤Šè€…ã¨ãªã£ãŸæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item full-width">
              <span class="detail-label">æ‰¶é¤Šã«è¿½åŠ ã•ã‚ŒãŸç†ç”±:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.dependentReason || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <textarea formControlName="dependentReason" class="form-input" rows="3"></textarea>
              </div>
            </div>
          </div>
        </section>
        
        <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼æƒ…å ± -->
        <section class="detail-section">
          <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span></h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã®æä¾›:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.provideMyNumber || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <label class="radio-label">
                  <input type="radio" formControlName="provideMyNumber" value="æä¾›ã™ã‚‹" (change)="onProvideMyNumberChange()">
                  æä¾›ã™ã‚‹
                </label>
                <label class="radio-label">
                  <input type="radio" formControlName="provideMyNumber" value="æä¾›ã—ãªã„" (change)="onProvideMyNumberChange()">
                  æä¾›ã—ãªã„
                </label>
                <div *ngIf="dependentApplicationForm.get('provideMyNumber')?.invalid && dependentApplicationForm.get('provideMyNumber')?.touched" class="error-message">
                  ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã®æä¾›ã‚’é¸æŠã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.provideMyNumber === 'æä¾›ã™ã‚‹' || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentApplicationForm?.get('provideMyNumber')?.value === 'æä¾›ã™ã‚‹')">
              <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ formatMyNumberForDisplay(selectedApplication.myNumber) }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <div class="my-number-container">
                  <div class="my-number-inputs">
                    <input 
                      type="text" 
                      formControlName="myNumberPart1" 
                      class="form-input my-number-part"
                      maxlength="4"
                      (input)="formatDependentMyNumberInput($event, 1)"
                      placeholder="0000"
                    >
                    <span class="my-number-separator">-</span>
                    <input 
                      type="text" 
                      formControlName="myNumberPart2" 
                      class="form-input my-number-part"
                      maxlength="4"
                      (input)="formatDependentMyNumberInput($event, 2)"
                      placeholder="0000"
                    >
                    <span class="my-number-separator">-</span>
                    <input 
                      type="text" 
                      formControlName="myNumberPart3" 
                      class="form-input my-number-part"
                      maxlength="4"
                      (input)="formatDependentMyNumberInput($event, 3)"
                      placeholder="0000"
                    >
                  </div>
                </div>
                <div *ngIf="dependentApplicationForm.get('myNumberPart1')?.invalid && dependentApplicationForm.get('myNumberPart1')?.touched" class="error-message">
                  ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item full-width" *ngIf="(selectedApplication.provideMyNumber === 'æä¾›ã™ã‚‹' || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentApplicationForm?.get('provideMyNumber')?.value === 'æä¾›ã™ã‚‹')) && (selectedApplication.myNumberCardFileUrl || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentMyNumberCardFile))">
              <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span>:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                <a *ngIf="selectedApplication.myNumberCardFileUrl" [href]="selectedApplication.myNumberCardFileUrl" target="_blank" class="file-link">
                  {{ selectedApplication.myNumberCardFile || 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ã‚’é–‹ã' }}
                </a>
                <span *ngIf="!selectedApplication.myNumberCardFileUrl">-</span>
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input 
                  type="file" 
                  class="form-input"
                  accept=".pdf,.jpg,.jpeg,.png"
                  (change)="onFileSelected($event, 'dependentMyNumberCard')"
                >
                <div *ngIf="dependentMyNumberCardFile" class="file-name">{{ dependentMyNumberCardFile.name }}</div>
                <div *ngIf="selectedApplication.myNumberCardFileUrl && !dependentMyNumberCardFile" class="file-info" style="margin-top: 0.5rem;">
                  <span>æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«: </span>
                  <a [href]="selectedApplication.myNumberCardFileUrl" target="_blank" class="file-link">
                    {{ selectedApplication.myNumberCardFile || 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ã‚’é–‹ã' }}
                  </a>
                </div>
              </div>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.provideMyNumber === 'æä¾›ã—ãªã„' || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentApplicationForm?.get('provideMyNumber')?.value === 'æä¾›ã—ãªã„')">
              <span class="detail-label">æœªæä¾›ç†ç”± <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span>:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.myNumberNotProvidedReason || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <textarea formControlName="myNumberNotProvidedReason" class="form-input" rows="3"></textarea>
                <div *ngIf="dependentApplicationForm.get('myNumberNotProvidedReason')?.invalid && dependentApplicationForm.get('myNumberNotProvidedReason')?.touched" class="error-message">
                  æœªæä¾›ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- éšœãŒã„è€…æƒ…å ± -->
        <section class="detail-section" *ngIf="selectedApplication.disabilityCategory || selectedApplication.disabilityCardType || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—')">
          <h3 class="section-title">éšœãŒã„è€…æƒ…å ±</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">éšœãŒã„è€…åŒºåˆ†:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.disabilityCategory || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="text" formControlName="disabilityCategory" class="form-input">
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">éšœãŒã„è€…æ‰‹å¸³ã®ç¨®é¡:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.disabilityCardType || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="text" formControlName="disabilityCardType" class="form-input">
              </div>
            </div>
            <div class="detail-item">
              <span class="detail-label">éšœãŒã„è€…æ‰‹å¸³ã®äº¤ä»˜å¹´æœˆæ—¥:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.disabilityCardIssueDate || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="date" formControlName="disabilityCardIssueDate" class="form-input">
              </div>
            </div>
          </div>
        </section>
        
        <!-- ä½æ‰€æƒ…å ± -->
        <section class="detail-section">
          <h3 class="section-title">ä½æ‰€æƒ…å ± <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span></h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">åŒå±…/åˆ¥å±…:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.livingTogether || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <label class="radio-label">
                  <input type="radio" formControlName="livingTogether" value="åŒå±…" (change)="onLivingTogetherChange()">
                  åŒå±…
                </label>
                <label class="radio-label">
                  <input type="radio" formControlName="livingTogether" value="åˆ¥å±…" (change)="onLivingTogetherChange()">
                  åˆ¥å±…
                </label>
                <div *ngIf="dependentApplicationForm.get('livingTogether')?.invalid && dependentApplicationForm.get('livingTogether')?.touched" class="error-message">
                  åŒå±…/åˆ¥å±…ã‚’é¸æŠã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.livingTogether === 'åˆ¥å±…' || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentApplicationForm?.get('livingTogether')?.value === 'åˆ¥å±…')">
              <span class="detail-label">éƒµä¾¿ç•ªå· <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span>:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.postalCode || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input 
                  type="text" 
                  formControlName="postalCode" 
                  class="form-input" 
                  placeholder="ä¾‹: 1234567"
                  maxlength="7"
                  pattern="[a-zA-Z0-9]*"
                  (input)="formatDependentPostalCode($event)"
                >
                <div *ngIf="dependentApplicationForm.get('postalCode')?.invalid && dependentApplicationForm.get('postalCode')?.touched" class="error-message">
                  éƒµä¾¿ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.livingTogether === 'åˆ¥å±…' || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentApplicationForm?.get('livingTogether')?.value === 'åˆ¥å±…')">
              <span class="detail-label">ä½æ‰€ <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span>:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.address || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <textarea formControlName="address" class="form-input" rows="2"></textarea>
                <div *ngIf="dependentApplicationForm.get('address')?.invalid && dependentApplicationForm.get('address')?.touched" class="error-message">
                  ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.livingTogether === 'åˆ¥å±…' || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentApplicationForm?.get('livingTogether')?.value === 'åˆ¥å±…')">
              <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.addressKana || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <textarea formControlName="addressKana" class="form-input" rows="2"></textarea>
              </div>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.livingTogether === 'åˆ¥å±…' || (isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—' && dependentApplicationForm?.get('livingTogether')?.value === 'åˆ¥å±…')">
              <span class="detail-label">ä½æ‰€å¤‰æ›´å¹´æœˆæ—¥:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.addressChangeDate || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="date" formControlName="addressChangeDate" class="form-input">
              </div>
            </div>
          </div>
        </section>
        
        <!-- æ·»ä»˜æ›¸é¡ -->
        <section class="detail-section" *ngIf="selectedApplication.basicPensionNumberDocFileUrl || selectedApplication.myNumberDocFileUrl || selectedApplication.identityDocFileUrl || selectedApplication.disabilityCardFileUrl">
          <h3 class="section-title">æ·»ä»˜æ›¸é¡</h3>
          <div class="detail-grid">
            <div class="detail-item full-width" *ngIf="selectedApplication.basicPensionNumberDocFileUrl">
              <span class="detail-label">åŸºç¤å¹´é‡‘ç•ªå·ç¢ºèªæ›¸é¡:</span>
              <span class="detail-value">
                <a [href]="selectedApplication.basicPensionNumberDocFileUrl" target="_blank" class="file-link">{{ getFileNameFromUrl(selectedApplication.basicPensionNumberDocFileUrl, selectedApplication.basicPensionNumberDocFileName) }}</a>
              </span>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.myNumberDocFileUrl">
              <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ç¢ºèªæ›¸é¡:</span>
              <span class="detail-value">
                <a [href]="selectedApplication.myNumberDocFileUrl" target="_blank" class="file-link">{{ getFileNameFromUrl(selectedApplication.myNumberDocFileUrl, selectedApplication.myNumberDocFileName) }}</a>
              </span>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.identityDocFileUrl">
              <span class="detail-label">èº«å…ƒç¢ºèªæ›¸é¡:</span>
              <span class="detail-value">
                <a [href]="selectedApplication.identityDocFileUrl" target="_blank" class="file-link">{{ getFileNameFromUrl(selectedApplication.identityDocFileUrl, selectedApplication.identityDocFileName) }}</a>
              </span>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.disabilityCardFileUrl">
              <span class="detail-label">éšœãŒã„è€…æ‰‹å¸³ã®ç”»åƒ:</span>
              <span class="detail-value">
                <a [href]="selectedApplication.disabilityCardFileUrl" target="_blank" class="file-link">{{ getFileNameFromUrl(selectedApplication.disabilityCardFileUrl, selectedApplication.disabilityCardFileName) }}</a>
              </span>
            </div>
          </div>
        </section>
        </form>
      </ng-container>
      
      <!-- æ‰¶é¤Šå‰Šé™¤ç”³è«‹ã®è©³ç´° -->
      <ng-container *ngIf="selectedApplication.applicationType === 'æ‰¶é¤Šå‰Šé™¤ç”³è«‹'">
        <form [formGroup]="dependentRemovalForm" (ngSubmit)="submitReapplication()" *ngIf="dependentRemovalForm" class="application-detail-form" [class.form-disabled]="isSubmittingReapplication">
        <!-- è¢«æ‰¶é¤Šè€…ç§»å‹•æ—¥ -->
        <section class="detail-section">
          <h3 class="section-title">è¢«æ‰¶é¤Šè€…ç§»å‹•æ—¥ <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span></h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">è¢«æ‰¶é¤Šè€…ç§»å‹•æ—¥:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.removalDate || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <input type="date" formControlName="removalDate" class="form-input">
                <div *ngIf="dependentRemovalForm.get('removalDate')?.invalid && dependentRemovalForm.get('removalDate')?.touched" class="error-message">
                  è¢«æ‰¶é¤Šè€…ç§»å‹•æ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- æ‰¶é¤Šå‰Šé™¤ã®ç†ç”± -->
        <section class="detail-section">
          <h3 class="section-title">æ‰¶é¤Šå‰Šé™¤ã®ç†ç”± <span class="required" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">*</span></h3>
          <div class="detail-grid">
            <div class="detail-item full-width">
              <span class="detail-label">æ‰¶é¤Šå‰Šé™¤ã®ç†ç”±:</span>
              <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ -->
              <span class="detail-value" *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
                {{ selectedApplication.removalReason || '-' }}
              </span>
              <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ -->
              <div *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="detail-edit-input">
                <textarea formControlName="removalReason" class="form-input" rows="4" placeholder="æ‰¶é¤Šå‰Šé™¤ã®ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
                <div *ngIf="dependentRemovalForm.get('removalReason')?.invalid && dependentRemovalForm.get('removalReason')?.touched" class="error-message">
                  æ‰¶é¤Šå‰Šé™¤ã®ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- è¢«æ‰¶é¤Šè€…æƒ…å ± -->
        <section class="detail-section" *ngIf="selectedApplication.dependent">
          <h3 class="section-title">è¢«æ‰¶é¤Šè€…æƒ…å ±</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">æ°å:</span>
              <span class="detail-value">{{ selectedApplication.dependent.name || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">æ°åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
              <span class="detail-value">{{ selectedApplication.dependent.nameKana || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">ç¶šæŸ„:</span>
              <span class="detail-value">{{ selectedApplication.dependent.relationship || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">ç”Ÿå¹´æœˆæ—¥:</span>
              <span class="detail-value">{{ selectedApplication.dependent.birthDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼:</span>
              <span class="detail-value">{{ selectedApplication.dependent.myNumber ? 'â—â—â—â—-â—â—â—â—-â—â—â—â—' : '-' }}</span>
            </div>
            <div class="detail-item full-width">
              <span class="detail-label">ä½æ‰€:</span>
              <span class="detail-value">{{ selectedApplication.dependent.address || '-' }}</span>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.dependent.notes">
              <span class="detail-label">å‚™è€ƒ:</span>
              <span class="detail-value">{{ selectedApplication.dependent.notes }}</span>
            </div>
          </div>
        </section>
        </form>
      </ng-container>
      
      <!-- ä½æ‰€å¤‰æ›´ç”³è«‹ã®è©³ç´° -->
      <ng-container *ngIf="selectedApplication.applicationType === 'ä½æ‰€å¤‰æ›´ç”³è«‹'">
        <!-- ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆå·®ã—æˆ»ã—ã®å ´åˆï¼‰ -->
        <form [formGroup]="addressChangeForm" (ngSubmit)="submitReapplication()" *ngIf="addressChangeForm && isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="application-detail-form" [class.form-disabled]="isSubmittingReapplication">
          <!-- å¼•ã£è¶Šã—ã—ãŸæ—¥ -->
          <section class="detail-section">
            <h3 class="section-title">å¼•ã£è¶Šã—ã—ãŸæ—¥ <span class="required">*</span></h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">å¼•ã£è¶Šã—ã—ãŸæ—¥:</span>
                <div class="detail-edit-input">
                  <input type="date" formControlName="moveDate" class="form-input">
                  <div *ngIf="addressChangeForm.get('moveDate')?.invalid && addressChangeForm.get('moveDate')?.touched" class="error-message">
                    å¼•ã£è¶Šã—ã—ãŸæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- æ–°ã—ã„ä½æ‰€ -->
          <section class="detail-section">
            <h3 class="section-title">æ–°ã—ã„ä½æ‰€</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">éƒµä¾¿ç•ªå· <span class="required">*</span>:</span>
                <div class="detail-edit-input">
                  <input 
                    type="text" 
                    formControlName="newPostalCode" 
                    class="form-input"
                    placeholder="1234567"
                    maxlength="7"
                    pattern="[0-9]{7}"
                    (input)="formatAddressPostalCode($event)"
                  >
                  <div *ngIf="addressChangeForm.get('newPostalCode')?.invalid && addressChangeForm.get('newPostalCode')?.touched" class="error-message">
                    <span *ngIf="addressChangeForm.get('newPostalCode')?.errors?.['required']">
                      éƒµä¾¿ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                    </span>
                    <span *ngIf="addressChangeForm.get('newPostalCode')?.errors?.['pattern']">
                      7æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                    </span>
                  </div>
                </div>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€ <span class="required">*</span>:</span>
                <div class="detail-edit-input">
                  <textarea formControlName="newAddress" class="form-input" rows="2"></textarea>
                  <div *ngIf="addressChangeForm.get('newAddress')?.invalid && addressChangeForm.get('newAddress')?.touched" class="error-message">
                    ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <div class="detail-edit-input">
                  <textarea formControlName="newAddressKana" class="form-input" rows="2"></textarea>
                </div>
              </div>
            </div>
          </section>
          
          <!-- æ–°ã—ã„ä½æ°‘ç¥¨ä½æ‰€ -->
          <section class="detail-section">
            <h3 class="section-title">æ–°ã—ã„ä½æ°‘ç¥¨ä½æ‰€</h3>
            <div class="form-group">
              <label class="checkbox-label">
                <input 
                  type="checkbox" 
                  [checked]="sameAsOldAddress"
                  (change)="onSameAsOldAddressChange($event)"
                >
                å¤‰æ›´å‰ä½æ‰€ã¨åŒã˜
              </label>
            </div>
            <div class="form-group">
              <label class="checkbox-label">
                <input 
                  type="checkbox" 
                  [checked]="sameAsNewAddress"
                  (change)="onSameAsNewAddressChange($event)"
                >
                å¤‰æ›´å¾Œã®ä½æ‰€ã¨åŒã˜
              </label>
            </div>
            <div class="detail-grid" *ngIf="!sameAsOldAddress && !sameAsNewAddress">
              <div class="detail-item">
                <span class="detail-label">éƒµä¾¿ç•ªå·:</span>
                <div class="detail-edit-input">
                  <input 
                    type="text" 
                    formControlName="residentPostalCode" 
                    class="form-input"
                    placeholder="1234567"
                    maxlength="7"
                    pattern="[0-9]{7}"
                    (input)="formatResidentPostalCodeForAddressChange($event)"
                  >
                </div>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€:</span>
                <div class="detail-edit-input">
                  <textarea formControlName="residentAddress" class="form-input" rows="2"></textarea>
                </div>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <div class="detail-edit-input">
                  <textarea formControlName="residentAddressKana" class="form-input" rows="2"></textarea>
                </div>
              </div>
            </div>
          </section>
        </form>
        
        <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ï¼ˆç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã§ãªã„å ´åˆï¼‰ -->
        <ng-container *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
          <!-- å¼•ã£è¶Šã—ã—ãŸæ—¥ -->
          <section class="detail-section">
            <h3 class="section-title">å¼•ã£è¶Šã—ã—ãŸæ—¥</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">å¼•ã£è¶Šã—ã—ãŸæ—¥:</span>
                <span class="detail-value">{{ selectedApplication.moveDate || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- æ–°ã—ã„ä½æ‰€ -->
          <section class="detail-section" *ngIf="selectedApplication.newAddress">
            <h3 class="section-title">æ–°ã—ã„ä½æ‰€</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">éƒµä¾¿ç•ªå·:</span>
                <span class="detail-value">{{ selectedApplication.newAddress.postalCode || '-' }}</span>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€:</span>
                <span class="detail-value">{{ selectedApplication.newAddress.address || '-' }}</span>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.newAddress.addressKana || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- æ–°ã—ã„ä½æ°‘ç¥¨ä½æ‰€ -->
          <section class="detail-section" *ngIf="selectedApplication.residentAddress">
            <h3 class="section-title">æ–°ã—ã„ä½æ°‘ç¥¨ä½æ‰€</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">ç¾ä½æ‰€ã¨åŒã˜:</span>
                <span class="detail-value">{{ selectedApplication.residentAddress.sameAsNewAddress ? 'ã¯ã„' : 'ã„ã„ãˆ' }}</span>
              </div>
              <div class="detail-item" *ngIf="!selectedApplication.residentAddress.sameAsNewAddress">
                <span class="detail-label">éƒµä¾¿ç•ªå·:</span>
                <span class="detail-value">{{ selectedApplication.residentAddress.postalCode || '-' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="!selectedApplication.residentAddress.sameAsNewAddress">
                <span class="detail-label">ä½æ‰€:</span>
                <span class="detail-value">{{ selectedApplication.residentAddress.address || '-' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="!selectedApplication.residentAddress.sameAsNewAddress">
                <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.residentAddress.addressKana || '-' }}</span>
              </div>
            </div>
          </section>
        </ng-container>
        
        <!-- æ–°ã—ã„ç·Šæ€¥é€£çµ¡å…ˆ -->
        <section class="detail-section" *ngIf="selectedApplication.emergencyContact">
          <h3 class="section-title">æ–°ã—ã„ç·Šæ€¥é€£çµ¡å…ˆ</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">å§“:</span>
              <span class="detail-value">{{ selectedApplication.emergencyContact.lastName || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">å:</span>
              <span class="detail-value">{{ selectedApplication.emergencyContact.firstName || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
              <span class="detail-value">{{ selectedApplication.emergencyContact.lastNameKana || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
              <span class="detail-value">{{ selectedApplication.emergencyContact.firstNameKana || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">ç¶šæŸ„:</span>
              <span class="detail-value">{{ selectedApplication.emergencyContact.relationship || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">é›»è©±ç•ªå·:</span>
              <span class="detail-value">{{ selectedApplication.emergencyContact.phone || '-' }}</span>
            </div>
          </div>
        </section>
      </ng-container>
      
      <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ç”³è«‹ã®è©³ç´° -->
      <ng-container *ngIf="selectedApplication.applicationType === 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ç”³è«‹'">
        <!-- ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆå·®ã—æˆ»ã—ã®å ´åˆï¼‰ -->
        <form [formGroup]="myNumberChangeForm" (ngSubmit)="submitReapplication()" *ngIf="myNumberChangeForm && isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="application-detail-form" [class.form-disabled]="isSubmittingReapplication">
          <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥ -->
          <section class="detail-section">
            <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥ <span class="required">*</span></h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥:</span>
                <div class="detail-edit-input">
                  <input type="date" formControlName="changeDate" class="form-input">
                  <div *ngIf="myNumberChangeForm.get('changeDate')?.invalid && myNumberChangeForm.get('changeDate')?.touched" class="error-message">
                    ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- æ–°ã—ã„ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ -->
          <section class="detail-section">
            <h3 class="section-title">æ–°ã—ã„ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ <span class="required">*</span></h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">1-4æ¡ç›®:</span>
                <div class="detail-edit-input">
                  <input 
                    type="text" 
                    formControlName="newMyNumberPart1" 
                    class="form-input"
                    maxlength="4"
                    pattern="[0-9]*"
                    inputmode="numeric"
                  >
                  <div *ngIf="myNumberChangeForm.get('newMyNumberPart1')?.invalid && myNumberChangeForm.get('newMyNumberPart1')?.touched" class="error-message">
                    4æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">5-8æ¡ç›®:</span>
                <div class="detail-edit-input">
                  <input 
                    type="text" 
                    formControlName="newMyNumberPart2" 
                    class="form-input"
                    maxlength="4"
                    pattern="[0-9]*"
                    inputmode="numeric"
                  >
                  <div *ngIf="myNumberChangeForm.get('newMyNumberPart2')?.invalid && myNumberChangeForm.get('newMyNumberPart2')?.touched" class="error-message">
                    4æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">9-12æ¡ç›®:</span>
                <div class="detail-edit-input">
                  <input 
                    type="text" 
                    formControlName="newMyNumberPart3" 
                    class="form-input"
                    maxlength="4"
                    pattern="[0-9]*"
                    inputmode="numeric"
                  >
                  <div *ngIf="myNumberChangeForm.get('newMyNumberPart3')?.invalid && myNumberChangeForm.get('newMyNumberPart3')?.touched" class="error-message">
                    4æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ -->
          <section class="detail-section">
            <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰</h3>
            <div class="detail-grid">
              <div class="detail-item full-width">
                <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰:</span>
                <div class="detail-edit-input">
                  <input 
                    type="file" 
                    class="form-input"
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelected($event, 'myNumberChangeCard')"
                  >
                  <div *ngIf="myNumberChangeCardFile" class="file-name">{{ myNumberChangeCardFile.name }}</div>
                  <div *ngIf="selectedApplication.myNumberCardFileUrl && !myNumberChangeCardFile" class="file-info" style="margin-top: 0.5rem;">
                    <span>æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«: </span>
                    <a [href]="selectedApplication.myNumberCardFileUrl" target="_blank" class="file-link">
                      {{ selectedApplication.myNumberCardFile || 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ã‚’é–‹ã' }}
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </form>
        
        <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ï¼ˆå·®ã—æˆ»ã—ã§ãªã„å ´åˆã€ã¾ãŸã¯ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã§ãªã„å ´åˆï¼‰ -->
        <ng-container *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
          <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥ -->
          <section class="detail-section">
            <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ã—ãŸæ—¥:</span>
                <span class="detail-value">{{ selectedApplication.changeDate || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- æ–°ã—ã„ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ -->
          <section class="detail-section" *ngIf="selectedApplication.newMyNumber">
            <h3 class="section-title">æ–°ã—ã„ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">1-4æ¡ç›®:</span>
                <span class="detail-value">{{ selectedApplication.newMyNumber.part1 || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">5-8æ¡ç›®:</span>
                <span class="detail-value">{{ selectedApplication.newMyNumber.part2 || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">9-12æ¡ç›®:</span>
                <span class="detail-value">{{ selectedApplication.newMyNumber.part3 || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ -->
          <section class="detail-section" *ngIf="selectedApplication.myNumberCardFileUrl">
            <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰</h3>
            <div class="detail-grid">
              <div class="detail-item full-width">
                <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.myNumberCardFileUrl" target="_blank" class="file-link">
                    {{ selectedApplication.myNumberCardFile || 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ã‚’é–‹ã' }}
                  </a>
                </span>
              </div>
            </div>
          </section>
        </ng-container>
      </ng-container>
      
      <!-- æ°åå¤‰æ›´ç”³è«‹ã®è©³ç´° -->
      <ng-container *ngIf="selectedApplication.applicationType === 'æ°åå¤‰æ›´ç”³è«‹'">
        <!-- ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆå·®ã—æˆ»ã—ã®å ´åˆï¼‰ -->
        <form [formGroup]="nameChangeForm" (ngSubmit)="submitReapplication()" *ngIf="nameChangeForm && isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'" class="application-detail-form" [class.form-disabled]="isSubmittingReapplication">
          <!-- æ°åå¤‰æ›´ã—ãŸæ—¥ -->
          <section class="detail-section">
            <h3 class="section-title">æ°åå¤‰æ›´ã—ãŸæ—¥ <span class="required">*</span></h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">æ°åå¤‰æ›´ã—ãŸæ—¥:</span>
                <div class="detail-edit-input">
                  <input type="date" formControlName="changeDate" class="form-input">
                  <div *ngIf="nameChangeForm.get('changeDate')?.invalid && nameChangeForm.get('changeDate')?.touched" class="error-message">
                    æ°åå¤‰æ›´ã—ãŸæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- æ–°ã—ã„æ°å -->
          <section class="detail-section">
            <h3 class="section-title">æ–°ã—ã„æ°å</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">å§“ <span class="required">*</span>:</span>
                <div class="detail-edit-input">
                  <input type="text" formControlName="newLastName" class="form-input">
                  <div *ngIf="nameChangeForm.get('newLastName')?.invalid && nameChangeForm.get('newLastName')?.touched" class="error-message">
                    å§“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">å <span class="required">*</span>:</span>
                <div class="detail-edit-input">
                  <input type="text" formControlName="newFirstName" class="form-input">
                  <div *ngIf="nameChangeForm.get('newFirstName')?.invalid && nameChangeForm.get('newFirstName')?.touched" class="error-message">
                    åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required">*</span>:</span>
                <div class="detail-edit-input">
                  <input type="text" formControlName="newLastNameKana" class="form-input">
                  <div *ngIf="nameChangeForm.get('newLastNameKana')?.invalid && nameChangeForm.get('newLastNameKana')?.touched" class="error-message">
                    å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required">*</span>:</span>
                <div class="detail-edit-input">
                  <input type="text" formControlName="newFirstNameKana" class="form-input">
                  <div *ngIf="nameChangeForm.get('newFirstNameKana')?.invalid && nameChangeForm.get('newFirstNameKana')?.touched" class="error-message">
                    åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- æœ¬äººç¢ºèªæ›¸é¡ -->
          <section class="detail-section">
            <h3 class="section-title">æœ¬äººç¢ºèªæ›¸é¡æ·»ä»˜</h3>
            <div class="detail-grid">
              <div class="detail-item full-width">
                <span class="detail-label">æœ¬äººç¢ºèªæ›¸é¡:</span>
                <div class="detail-edit-input">
                  <input 
                    type="file" 
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelected($event, 'nameChangeIdDocument')"
                    class="form-input"
                  >
                  <div *ngIf="nameChangeIdDocumentFile" class="file-info">
                    é¸æŠæ¸ˆã¿: {{ nameChangeIdDocumentFile.name }}
                  </div>
                  <div *ngIf="selectedApplication.idDocumentFileUrl && !nameChangeIdDocumentFile" class="file-info">
                    ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«: <a [href]="selectedApplication.idDocumentFileUrl" target="_blank" class="file-link">æœ¬äººç¢ºèªæ›¸é¡ã‚’é–‹ã</a>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </form>
        
        <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ï¼ˆç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã§ãªã„å ´åˆï¼‰ -->
        <ng-container *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
          <!-- æ°åå¤‰æ›´ã—ãŸæ—¥ -->
          <section class="detail-section">
            <h3 class="section-title">æ°åå¤‰æ›´ã—ãŸæ—¥</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">æ°åå¤‰æ›´ã—ãŸæ—¥:</span>
                <span class="detail-value">{{ selectedApplication.changeDate || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- æ–°ã—ã„æ°å -->
          <section class="detail-section" *ngIf="selectedApplication.newName">
            <h3 class="section-title">æ–°ã—ã„æ°å</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">å§“:</span>
                <span class="detail-value">{{ selectedApplication.newName.lastName || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">å:</span>
                <span class="detail-value">{{ selectedApplication.newName.firstName || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.newName.lastNameKana || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.newName.firstNameKana || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- æœ¬äººç¢ºèªæ›¸é¡ -->
          <section class="detail-section">
            <h3 class="section-title">æœ¬äººç¢ºèªæ›¸é¡</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">æœ¬äººç¢ºèªæ›¸é¡æ·»ä»˜:</span>
                <span class="detail-value">{{ selectedApplication.hasIdDocument ? 'ã‚ã‚Š' : 'ãªã—' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.idDocumentFileUrl">
                <span class="detail-label">æœ¬äººç¢ºèªæ›¸é¡:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.idDocumentFileUrl" target="_blank" class="file-link">
                    {{ selectedApplication.idDocumentFile || 'æœ¬äººç¢ºèªæ›¸é¡ã‚’é–‹ã' }}
                  </a>
                </span>
              </div>
            </div>
          </section>
        </ng-container>
      </ng-container>
      
      <!-- ç”£å‰ç”£å¾Œä¼‘æ¥­ç”³è«‹ã®è©³ç´° -->
      <ng-container *ngIf="selectedApplication.applicationType === 'ç”£å‰ç”£å¾Œä¼‘æ¥­ç”³è«‹'">
        <!-- å‡ºç”£äºˆå®šæ—¥ -->
        <section class="detail-section">
          <h3 class="section-title">å‡ºç”£äºˆå®šæ—¥</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">å‡ºç”£äºˆå®šæ—¥:</span>
              <span class="detail-value">{{ selectedApplication.expectedDeliveryDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">åŒå­ä»¥ä¸Šã‹:</span>
              <span class="detail-value">{{ selectedApplication.isMultipleBirth || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">å‡ºç”£äºˆå®šæ—¥ã‚’ç¢ºèªã§ãã‚‹æ›¸é¡æ·»ä»˜:</span>
              <span class="detail-value">{{ selectedApplication.hasDocument ? 'ã‚ã‚Š' : 'ãªã—' }}</span>
            </div>
          </div>
        </section>
        
        <!-- ç”£å‰ç”£å¾Œä¼‘æ¥­æœŸé–“ -->
        <section class="detail-section">
          <h3 class="section-title">ç”£å‰ç”£å¾Œä¼‘æ¥­æœŸé–“</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">ç”£å‰ç”£å¾Œä¼‘æ¥­é–‹å§‹æ—¥:</span>
              <span class="detail-value">{{ selectedApplication.maternityLeaveStartDate || selectedApplication.preMaternityLeaveStartDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">ç”£å‰ç”£å¾Œä¼‘æ¥­çµ‚äº†æ—¥:</span>
              <span class="detail-value">{{ selectedApplication.maternityLeaveEndDate || selectedApplication.postMaternityLeaveEndDate || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- ä¼‘æ¥­ä¸­ã®æ»åœ¨å…ˆ -->
        <section class="detail-section" *ngIf="selectedApplication.stayAddress">
          <h3 class="section-title">ä¼‘æ¥­ä¸­ã®æ»åœ¨å…ˆ</h3>
          <div class="detail-grid">
            <div class="detail-item full-width">
              <span class="detail-label">ä¼‘æ¥­ä¸­ã®æ»åœ¨å…ˆï¼ˆç¾ä½æ‰€ã¨ç•°ãªã‚‹å ´åˆï¼‰:</span>
              <span class="detail-value">{{ selectedApplication.stayAddress }}</span>
            </div>
          </div>
        </section>
      </ng-container>
      
      <!-- é€€è·ç”³è«‹ã®è©³ç´° -->
      <ng-container *ngIf="selectedApplication.applicationType === 'é€€è·ç”³è«‹'">
        <!-- é€€è·æ—¥ãƒ»æœ€çµ‚å‡ºç¤¾æ—¥ -->
        <section class="detail-section">
          <h3 class="section-title">é€€è·æƒ…å ±</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">é€€è·æ—¥:</span>
              <span class="detail-value">{{ selectedApplication.resignationDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">æœ€çµ‚å‡ºç¤¾æ—¥:</span>
              <span class="detail-value">{{ selectedApplication.lastWorkDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">é›¢è·ç¥¨ã®ç™ºè¡Œã«ã¤ã„ã¦:</span>
              <span class="detail-value">{{ selectedApplication.separationNotice || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- é€€è·å¾Œã®é€£çµ¡å…ˆ -->
        <section class="detail-section">
          <h3 class="section-title">é€€è·å¾Œã®é€£çµ¡å…ˆ</h3>
          <div class="detail-grid">
            <div class="detail-item full-width">
              <span class="detail-label">é€€è·å¾Œã®ä½æ‰€:</span>
              <span class="detail-value">{{ selectedApplication.postResignationAddress || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">é€€è·å¾Œã®é›»è©±ç•ªå·:</span>
              <span class="detail-value">{{ selectedApplication.postResignationPhone || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">é€€è·å¾Œã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</span>
              <span class="detail-value">{{ selectedApplication.postResignationEmail || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- é€€è·å¾Œã®ç¤¾ä¼šä¿é™ºåŠ å…¥ -->
        <section class="detail-section">
          <h3 class="section-title">é€€è·å¾Œã®ç¤¾ä¼šä¿é™ºåŠ å…¥</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">é€€è·å¾Œã®ç¤¾ä¼šä¿é™ºåŠ å…¥:</span>
              <span class="detail-value">{{ selectedApplication.postResignationInsurance || '-' }}</span>
            </div>
          </div>
        </section>
      </ng-container>
      
      <!-- å…¥ç¤¾æ™‚ç”³è«‹ã®è©³ç´°ï¼ˆè¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ãƒ»ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼‰ -->
      <ng-container *ngIf="selectedApplication.applicationType === 'å…¥ç¤¾æ™‚ç”³è«‹'">
        <form [formGroup]="onboardingApplicationForm" *ngIf="isEditModeForReapplication && selectedApplication.status === 'å·®ã—æˆ»ã—'">
          <!-- åŸºæœ¬æƒ…å ± -->
          <section class="detail-section">
            <h3 class="section-title">åŸºæœ¬æƒ…å ±</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">å§“:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ getLastName(selectedApplication.name, selectedApplication.lastName) }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input type="text" formControlName="lastName" class="form-input" readonly style="background: #f5f5f5;">
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">å:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ getFirstName(selectedApplication.name, selectedApplication.firstName) }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input type="text" formControlName="firstName" class="form-input" readonly style="background: #f5f5f5;">
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ getLastNameKana(selectedApplication.nameKana, selectedApplication.lastNameKana) }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input type="text" formControlName="lastNameKana" class="form-input">
                  <div *ngIf="onboardingApplicationForm.get('lastNameKana')?.invalid && onboardingApplicationForm.get('lastNameKana')?.touched" class="error-message">
                    <span *ngIf="onboardingApplicationForm.get('lastNameKana')?.errors?.['required']">å§“ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    <span *ngIf="onboardingApplicationForm.get('lastNameKana')?.errors?.['katakana']">ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                  </div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ getFirstNameKana(selectedApplication.nameKana, selectedApplication.firstNameKana) }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input type="text" formControlName="firstNameKana" class="form-input">
                  <div *ngIf="onboardingApplicationForm.get('firstNameKana')?.invalid && onboardingApplicationForm.get('firstNameKana')?.touched" class="error-message">
                    <span *ngIf="onboardingApplicationForm.get('firstNameKana')?.errors?.['required']">åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    <span *ngIf="onboardingApplicationForm.get('firstNameKana')?.errors?.['katakana']">ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                  </div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">ç”Ÿå¹´æœˆæ—¥ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.birthDate || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input type="date" formControlName="birthDate" class="form-input">
                  <div *ngIf="onboardingApplicationForm.get('birthDate')?.invalid && onboardingApplicationForm.get('birthDate')?.touched" class="error-message">ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">æˆ¸ç±ä¸Šã®æ€§åˆ¥ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.gender || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <select formControlName="gender" class="form-input">
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let g of genders" [value]="g">{{ g }}</option>
                  </select>
                  <div *ngIf="onboardingApplicationForm.get('gender')?.invalid && onboardingApplicationForm.get('gender')?.touched" class="error-message">æ€§åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.email || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input type="email" formControlName="email" class="form-input" readonly style="background: #f5f5f5;">
                </div>
              </div>
            </div>
          </section>
          
          <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ -->
          <section class="detail-section">
            <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼</h3>
            <div class="detail-grid">
              <div class="detail-item full-width">
                <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.myNumber ? 'â—â—â—â—-â—â—â—â—-â—â—â—â—' : '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <div class="my-number-container">
                    <div class="my-number-inputs">
                      <input type="text" formControlName="myNumberPart1" class="form-input my-number-part" maxlength="4" placeholder="0000">
                      <span class="my-number-separator">-</span>
                      <input type="text" formControlName="myNumberPart2" class="form-input my-number-part" maxlength="4" placeholder="0000">
                      <span class="my-number-separator">-</span>
                      <input type="text" formControlName="myNumberPart3" class="form-input my-number-part" maxlength="4" placeholder="0000">
                    </div>
                  </div>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.myNumberCardFileUrl || (isInEditMode() && myNumberCardFile)">
                <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰:</span>
                <span class="detail-value" *ngIf="isInViewMode() && selectedApplication.myNumberCardFileUrl">
                  <a [href]="selectedApplication.myNumberCardFileUrl" target="_blank" class="file-link">
                    {{ selectedApplication.myNumberCardFile || 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ã‚’é–‹ã' }}
                  </a>
                </span>
                <span class="detail-value" *ngIf="isInViewMode() && !selectedApplication.myNumberCardFileUrl">-</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input 
                    type="file" 
                    class="form-input"
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelected($event, 'myNumberCard')"
                  >
                  <div *ngIf="myNumberCardFile" class="file-name">{{ myNumberCardFile.name }}</div>
                  <div *ngIf="selectedApplication.myNumberCardFileUrl && !myNumberCardFile" class="file-info" style="margin-top: 0.5rem;">
                    <span>æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«: </span>
                    <a [href]="selectedApplication.myNumberCardFileUrl" target="_blank" class="file-link">
                      {{ selectedApplication.myNumberCardFile || 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ã‚’é–‹ã' }}
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- ç¾ä½æ‰€ã¨é€£çµ¡å…ˆ -->
          <section class="detail-section">
            <h3 class="section-title">ç¾ä½æ‰€ã¨é€£çµ¡å…ˆ</h3>
            <div class="detail-grid">
              <div class="detail-item full-width">
                <span class="detail-label">æµ·å¤–ã«åœ¨ä½:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.isOverseasResident ? 'ã¯ã„' : 'ã„ã„ãˆ' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <label class="checkbox-label">
                    <input type="checkbox" formControlName="isOverseasResident" (change)="onOverseasResidentChange($event)">
                    æµ·å¤–ã«åœ¨ä½
                  </label>
                </div>
              </div>
              <div class="detail-item" *ngIf="!selectedApplication.isOverseasResident || (isInEditMode() && !onboardingApplicationForm.get('isOverseasResident')?.value)">
                <span class="detail-label">éƒµä¾¿ç•ªå·:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.postalCode || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input type="text" formControlName="postalCode" class="form-input" maxlength="7" (input)="formatPostalCode($event)" placeholder="1234567">
                  <div *ngIf="onboardingApplicationForm.get('postalCode')?.invalid && onboardingApplicationForm.get('postalCode')?.touched" class="error-message">
                    <span *ngIf="onboardingApplicationForm.get('postalCode')?.errors?.['pattern']">7æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                  </div>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="!selectedApplication.isOverseasResident || (isInEditMode() && !onboardingApplicationForm.get('isOverseasResident')?.value)">
                <span class="detail-label">ç¾ä½æ‰€ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.currentAddress || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <textarea formControlName="currentAddress" class="form-input" rows="2"></textarea>
                  <div *ngIf="onboardingApplicationForm.get('currentAddress')?.invalid && onboardingApplicationForm.get('currentAddress')?.touched" class="error-message">ç¾ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="!selectedApplication.isOverseasResident || (isInEditMode() && !onboardingApplicationForm.get('isOverseasResident')?.value)">
                <span class="detail-label">ç¾ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.currentAddressKana || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <textarea formControlName="currentAddressKana" class="form-input" rows="2"></textarea>
                  <div *ngIf="onboardingApplicationForm.get('currentAddressKana')?.invalid && onboardingApplicationForm.get('currentAddressKana')?.touched" class="error-message">
                    <span *ngIf="onboardingApplicationForm.get('currentAddressKana')?.errors?.['required']">ç¾ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    <span *ngIf="onboardingApplicationForm.get('currentAddressKana')?.errors?.['katakana']">ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                  </div>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.isOverseasResident || (isInEditMode() && onboardingApplicationForm.get('isOverseasResident')?.value)">
                <span class="detail-label">ä½æ‰€ï¼ˆæµ·å¤–ï¼‰ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.overseasAddress || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <textarea formControlName="overseasAddress" class="form-input" rows="2" placeholder="æµ·å¤–ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
                  <div *ngIf="onboardingApplicationForm.get('overseasAddress')?.invalid && onboardingApplicationForm.get('overseasAddress')?.touched" class="error-message">ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">é›»è©±ç•ªå· <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.phoneNumber || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input type="tel" formControlName="phoneNumber" class="form-input" (input)="formatPhoneNumber($event)">
                  <div *ngIf="onboardingApplicationForm.get('phoneNumber')?.invalid && onboardingApplicationForm.get('phoneNumber')?.touched" class="error-message">
                    <span *ngIf="onboardingApplicationForm.get('phoneNumber')?.errors?.['required']">é›»è©±ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    <span *ngIf="onboardingApplicationForm.get('phoneNumber')?.errors?.['pattern']">æ•°å­—ã®ã¿ã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                  </div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- ä½æ°‘ç¥¨ä½æ‰€ -->
          <section class="detail-section">
            <h3 class="section-title">ä½æ°‘ç¥¨ä½æ‰€</h3>
            <div class="detail-grid">
              <div class="detail-item full-width" *ngIf="!selectedApplication.isOverseasResident || (isInEditMode() && !onboardingApplicationForm.get('isOverseasResident')?.value)">
                <span class="detail-label">ä½æ‰€ï¼ˆç¾ä½æ‰€ã¨åŒã˜ï¼‰:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.sameAsCurrentAddress ? 'ã¯ã„' : 'ã„ã„ãˆ' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <label class="checkbox-label">
                    <input type="checkbox" formControlName="sameAsCurrentAddress" (change)="onOnboardingSameAddressChange($event)">
                    ä½æ‰€ï¼ˆç¾ä½æ‰€ã¨åŒã˜ï¼‰
                  </label>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.isOverseasResident || (isInEditMode() && onboardingApplicationForm.get('isOverseasResident')?.value)">
                <span class="detail-label">ä½æ°‘ç¥¨ä½æ‰€ã‚’è¨˜è¼‰ã—ãªã„:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.skipResidentAddress ? 'ã¯ã„' : 'ã„ã„ãˆ' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <label class="checkbox-label">
                    <input type="checkbox" formControlName="skipResidentAddress" (change)="onSkipResidentAddressChange($event)" [disabled]="onboardingApplicationForm.get('isOverseasResident')?.value">
                    ä½æ°‘ç¥¨ä½æ‰€ã‚’è¨˜è¼‰ã—ãªã„
                  </label>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="(selectedApplication.isOverseasResident || (isInEditMode() && onboardingApplicationForm.get('isOverseasResident')?.value)) && (selectedApplication.skipResidentAddress || (isInEditMode() && onboardingApplicationForm.get('skipResidentAddress')?.value))">
                <span class="detail-label">ä½æ°‘ç¥¨ä½æ‰€ã‚’è¨˜è¼‰ã—ãªã„ç†ç”±:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.residentAddressSkipReason || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <input type="text" formControlName="residentAddressSkipReason" class="form-input" readonly>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="(!selectedApplication.isOverseasResident || (isInEditMode() && !onboardingApplicationForm.get('isOverseasResident')?.value)) && (!selectedApplication.skipResidentAddress || (isInEditMode() && !onboardingApplicationForm.get('skipResidentAddress')?.value))">
                <span class="detail-label">ä½æ‰€ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.residentAddress || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <textarea formControlName="residentAddress" class="form-input" rows="2" [readonly]="onboardingApplicationForm.get('sameAsCurrentAddress')?.value"></textarea>
                  <div *ngIf="onboardingApplicationForm.get('residentAddress')?.invalid && onboardingApplicationForm.get('residentAddress')?.touched" class="error-message">ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="(!selectedApplication.isOverseasResident || (isInEditMode() && !onboardingApplicationForm.get('isOverseasResident')?.value)) && (!selectedApplication.skipResidentAddress || (isInEditMode() && !onboardingApplicationForm.get('skipResidentAddress')?.value))">
                <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.residentAddressKana || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <textarea formControlName="residentAddressKana" class="form-input" rows="2" [readonly]="onboardingApplicationForm.get('sameAsCurrentAddress')?.value"></textarea>
                  <div *ngIf="onboardingApplicationForm.get('residentAddressKana')?.invalid && onboardingApplicationForm.get('residentAddressKana')?.touched" class="error-message">
                    <span *ngIf="onboardingApplicationForm.get('residentAddressKana')?.errors?.['required']">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    <span *ngIf="onboardingApplicationForm.get('residentAddressKana')?.errors?.['katakana']">ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                  </div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- ç·Šæ€¥é€£çµ¡å…ˆ -->
          <section class="detail-section">
            <h3 class="section-title">ç·Šæ€¥é€£çµ¡å…ˆ</h3>
            <div formGroupName="emergencyContact" *ngIf="isInEditMode()">
              <div class="detail-grid">
                <div class="detail-item">
                  <span class="detail-label">æ°å:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.emergencyContact?.name || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <input type="text" formControlName="name" class="form-input">
                  </div>
                </div>
                <div class="detail-item">
                  <span class="detail-label">æ°åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.emergencyContact?.nameKana || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <input type="text" formControlName="nameKana" class="form-input">
                    <div *ngIf="onboardingApplicationForm.get('emergencyContact.nameKana')?.invalid && onboardingApplicationForm.get('emergencyContact.nameKana')?.touched" class="error-message">
                      <span *ngIf="onboardingApplicationForm.get('emergencyContact.nameKana')?.errors?.['katakana']">ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    </div>
                  </div>
                </div>
                <div class="detail-item">
                  <span class="detail-label">ç¶šæŸ„:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.emergencyContact?.relationship || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <input type="text" formControlName="relationship" class="form-input">
                  </div>
                </div>
                <div class="detail-item">
                  <span class="detail-label">ç·Šæ€¥é€£çµ¡å…ˆé›»è©±ç•ªå·:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.emergencyContact?.phone || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <input type="tel" formControlName="phone" class="form-input" (input)="formatEmergencyPhoneNumber($event)">
                    <div *ngIf="onboardingApplicationForm.get('emergencyContact.phone')?.invalid && onboardingApplicationForm.get('emergencyContact.phone')?.touched" class="error-message">
                      <span *ngIf="onboardingApplicationForm.get('emergencyContact.phone')?.errors?.['pattern']">æ•°å­—ã®ã¿ã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    </div>
                  </div>
                </div>
                <div class="detail-item full-width">
                  <span class="detail-label">ä½æ‰€:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.emergencyContact?.address || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <textarea formControlName="address" class="form-input" rows="2"></textarea>
                  </div>
                </div>
                <div class="detail-item full-width">
                  <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.emergencyContact?.addressKana || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <textarea formControlName="addressKana" class="form-input" rows="2"></textarea>
                    <div *ngIf="onboardingApplicationForm.get('emergencyContact.addressKana')?.invalid && onboardingApplicationForm.get('emergencyContact.addressKana')?.touched" class="error-message">
                      <span *ngIf="onboardingApplicationForm.get('emergencyContact.addressKana')?.errors?.['katakana']">ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="isInViewMode()" class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">æ°å:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.name || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">æ°åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.nameKana || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ç¶šæŸ„:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.relationship || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ç·Šæ€¥é€£çµ¡å…ˆé›»è©±ç•ªå·:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.phone || '-' }}</span>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.address || '-' }}</span>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.addressKana || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- å£åº§æƒ…å ± -->
          <section class="detail-section">
            <h3 class="section-title">å£åº§æƒ…å ±</h3>
            <div formGroupName="bankAccount" *ngIf="isInEditMode()">
              <div class="detail-grid">
                <div class="detail-item">
                  <span class="detail-label">éŠ€è¡Œå:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.bankAccount?.bankName || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <input type="text" formControlName="bankName" class="form-input">
                  </div>
                </div>
                <div class="detail-item">
                  <span class="detail-label">é é‡‘ç¨®åˆ¥:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.bankAccount?.accountType || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <select formControlName="accountType" class="form-input">
                      <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                      <option value="æ™®é€š">æ™®é€š</option>
                      <option value="å½“åº§">å½“åº§</option>
                      <option value="è²¯è“„">è²¯è“„</option>
                    </select>
                  </div>
                </div>
                <div class="detail-item">
                  <span class="detail-label">åç¾©ï¼ˆã‚«ã‚¿ã‚«ãƒŠï¼‰:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.bankAccount?.accountHolder || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <input type="text" formControlName="accountHolder" class="form-input">
                    <div *ngIf="onboardingApplicationForm.get('bankAccount.accountHolder')?.invalid && onboardingApplicationForm.get('bankAccount.accountHolder')?.touched" class="error-message">
                      <span *ngIf="onboardingApplicationForm.get('bankAccount.accountHolder')?.errors?.['katakana']">ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    </div>
                  </div>
                </div>
                <div class="detail-item">
                  <span class="detail-label">æ”¯åº—å:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.bankAccount?.branchName || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <input type="text" formControlName="branchName" class="form-input">
                  </div>
                </div>
                <div class="detail-item">
                  <span class="detail-label">å£åº§ç•ªå·:</span>
                  <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.bankAccount?.accountNumber || '-' }}</span>
                  <div *ngIf="isInEditMode()" class="detail-edit-input">
                    <input type="text" formControlName="accountNumber" class="form-input">
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="isInViewMode()" class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">éŠ€è¡Œå:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.bankName || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">é é‡‘ç¨®åˆ¥:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.accountType || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">åç¾©ï¼ˆã‚«ã‚¿ã‚«ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.accountHolder || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">æ”¯åº—å:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.branchName || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">å£åº§ç•ªå·:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.accountNumber || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- ç¤¾ä¼šä¿é™º -->
          <section class="detail-section">
            <h3 class="section-title">ç¤¾ä¼šä¿é™º</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">åŸºç¤å¹´é‡‘ç•ªå· <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ formatBasicPensionNumberForDisplay(selectedApplication.basicPensionNumber) }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <div class="basic-pension-number-container">
                    <input type="text" formControlName="basicPensionNumberPart1" class="form-input basic-pension-part" maxlength="4" placeholder="0000" (input)="formatOnboardingBasicPensionNumberInput($event, 1)">
                    <span class="basic-pension-separator">-</span>
                    <input type="text" formControlName="basicPensionNumberPart2" class="form-input basic-pension-part" maxlength="6" placeholder="000000" (input)="formatOnboardingBasicPensionNumberInput($event, 2)">
                  </div>
                  <div *ngIf="(onboardingApplicationForm.get('basicPensionNumberPart1')?.invalid || onboardingApplicationForm.get('basicPensionNumberPart2')?.invalid) && (onboardingApplicationForm.get('basicPensionNumberPart1')?.touched || onboardingApplicationForm.get('basicPensionNumberPart2')?.touched)" class="error-message">
                    <span *ngIf="onboardingApplicationForm.get('basicPensionNumberPart1')?.errors?.['required'] || onboardingApplicationForm.get('basicPensionNumberPart2')?.errors?.['required']">åŸºç¤å¹´é‡‘ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                    <span *ngIf="onboardingApplicationForm.get('basicPensionNumberPart1')?.errors?.['pattern'] || onboardingApplicationForm.get('basicPensionNumberPart2')?.errors?.['pattern']">åŠè§’æ•°å­—ã®ã¿ã§å…¥åŠ›ã—ã¦ãã ã•ã„</span>
                  </div>
                </div>
              </div>
              <div class="detail-item">
                <span class="detail-label">åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.pensionHistoryStatus || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <select formControlName="pensionHistoryStatus" class="form-input" (change)="onPensionHistoryChange($event)">
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option *ngFor="let option of pensionHistoryOptions" [value]="option">{{ option }}</option>
                  </select>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.pensionHistoryStatus === 'æœ‰' || (isInEditMode() && onboardingApplicationForm.get('pensionHistoryStatus')?.value === 'æœ‰')">
                <span class="detail-label">åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´ï¼ˆè©³ç´°ï¼‰:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.pensionHistory || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <textarea formControlName="pensionHistory" class="form-input" rows="4"></textarea>
                </div>
              </div>
            </div>
          </section>
          
          <!-- æ‰¶é¤Šè€…æœ‰ç„¡ -->
          <section class="detail-section">
            <h3 class="section-title">æ‰¶é¤Šè€…æœ‰ç„¡</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">è¢«æ‰¶é¤Šè€… <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.dependentStatus || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <select formControlName="dependentStatus" class="form-input">
                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                    <option value="æœ‰">æœ‰</option>
                    <option value="ç„¡">ç„¡</option>
                  </select>
                  <div *ngIf="onboardingApplicationForm.get('dependentStatus')?.invalid && onboardingApplicationForm.get('dependentStatus')?.touched" class="error-message">è¢«æ‰¶é¤Šè€…ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦ -->
          <section class="detail-section">
            <h3 class="section-title">è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.qualificationCertificateRequired || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <div class="radio-group">
                    <label class="radio-label">
                      <input 
                        type="radio" 
                        formControlName="qualificationCertificateRequired" 
                        value="å¿…è¦"
                        name="qualificationCertificateRequired"
                      >
                      å¿…è¦
                    </label>
                    <label class="radio-label">
                      <input 
                        type="radio" 
                        formControlName="qualificationCertificateRequired" 
                        value="ä¸è¦"
                        name="qualificationCertificateRequired"
                      >
                      ä¸è¦
                    </label>
                  </div>
                  <div *ngIf="onboardingApplicationForm.get('qualificationCertificateRequired')?.invalid && onboardingApplicationForm.get('qualificationCertificateRequired')?.touched" class="error-message">è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- å¹´é‡‘åŸºé‡‘åŠ å…¥ -->
          <section class="detail-section">
            <h3 class="section-title">å¹´é‡‘åŸºé‡‘åŠ å…¥</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">å¹´é‡‘åŸºé‡‘ã«åŠ å…¥ã—ã¦ã„ã‚‹ã‹ <span class="required" *ngIf="isInEditMode()">*</span>:</span>
                <span class="detail-value" *ngIf="isInViewMode()">{{ selectedApplication.pensionFundMembership || '-' }}</span>
                <div *ngIf="isInEditMode()" class="detail-edit-input">
                  <div class="radio-group">
                    <label class="radio-label">
                      <input 
                        type="radio" 
                        formControlName="pensionFundMembership" 
                        value="ã¯ã„"
                        name="pensionFundMembership"
                      >
                      ã¯ã„
                    </label>
                    <label class="radio-label">
                      <input 
                        type="radio" 
                        formControlName="pensionFundMembership" 
                        value="ã„ã„ãˆ"
                        name="pensionFundMembership"
                      >
                      ã„ã„ãˆ
                    </label>
                  </div>
                  <div *ngIf="onboardingApplicationForm.get('pensionFundMembership')?.invalid && onboardingApplicationForm.get('pensionFundMembership')?.touched" class="error-message">å¹´é‡‘åŸºé‡‘ã«åŠ å…¥ã—ã¦ã„ã‚‹ã‹ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
                </div>
              </div>
            </div>
          </section>
          
          <!-- æ·»ä»˜è³‡æ–™ -->
          <section class="detail-section">
            <h3 class="section-title">æ·»ä»˜è³‡æ–™</h3>
            <div class="detail-grid">
              <div class="detail-item full-width" *ngIf="isInViewMode() && selectedApplication.resumeFileUrl">
                <span class="detail-label">å±¥æ­´æ›¸:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.resumeFileUrl" target="_blank" class="file-link">å±¥æ­´æ›¸ã‚’é–‹ã</a>
                </span>
              </div>
              <div class="detail-item full-width" *ngIf="isInEditMode()">
                <span class="detail-label">å±¥æ­´æ›¸:</span>
                <div class="detail-edit-input">
                  <input 
                    type="file" 
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelected($event, 'resume')"
                    class="form-input"
                  >
                  <div *ngIf="resumeFile" class="file-info">
                    é¸æŠæ¸ˆã¿: {{ resumeFile.name }}
                  </div>
                  <div *ngIf="selectedApplication.resumeFileUrl && !resumeFile" class="file-info">
                    ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«: <a [href]="selectedApplication.resumeFileUrl" target="_blank" class="file-link">å±¥æ­´æ›¸ã‚’é–‹ã</a>
                  </div>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="isInViewMode() && selectedApplication.careerHistoryFileUrl">
                <span class="detail-label">è·å‹™çµŒæ­´æ›¸:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.careerHistoryFileUrl" target="_blank" class="file-link">è·å‹™çµŒæ­´æ›¸ã‚’é–‹ã</a>
                </span>
              </div>
              <div class="detail-item full-width" *ngIf="isInEditMode()">
                <span class="detail-label">è·å‹™çµŒæ­´æ›¸:</span>
                <div class="detail-edit-input">
                  <input 
                    type="file" 
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelected($event, 'careerHistory')"
                    class="form-input"
                  >
                  <div *ngIf="careerHistoryFile" class="file-info">
                    é¸æŠæ¸ˆã¿: {{ careerHistoryFile.name }}
                  </div>
                  <div *ngIf="selectedApplication.careerHistoryFileUrl && !careerHistoryFile" class="file-info">
                    ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«: <a [href]="selectedApplication.careerHistoryFileUrl" target="_blank" class="file-link">è·å‹™çµŒæ­´æ›¸ã‚’é–‹ã</a>
                  </div>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="isInViewMode() && selectedApplication.basicPensionNumberDocFileUrl">
                <span class="detail-label">åŸºç¤å¹´é‡‘ç•ªå·ãŒã‚ã‹ã‚‹æ›¸é¡:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.basicPensionNumberDocFileUrl" target="_blank" class="file-link">åŸºç¤å¹´é‡‘ç•ªå·ãŒã‚ã‹ã‚‹æ›¸é¡ã‚’é–‹ã</a>
                </span>
              </div>
              <div class="detail-item full-width" *ngIf="isInEditMode()">
                <span class="detail-label">åŸºç¤å¹´é‡‘ç•ªå·ãŒã‚ã‹ã‚‹æ›¸é¡:</span>
                <div class="detail-edit-input">
                  <input 
                    type="file" 
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelected($event, 'basicPensionNumberDoc')"
                    class="form-input"
                  >
                  <div *ngIf="basicPensionNumberDocFile" class="file-info">
                    é¸æŠæ¸ˆã¿: {{ basicPensionNumberDocFile.name }}
                  </div>
                  <div *ngIf="selectedApplication.basicPensionNumberDocFileUrl && !basicPensionNumberDocFile" class="file-info">
                    ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«: <a [href]="selectedApplication.basicPensionNumberDocFileUrl" target="_blank" class="file-link">åŸºç¤å¹´é‡‘ç•ªå·ãŒã‚ã‹ã‚‹æ›¸é¡ã‚’é–‹ã</a>
                  </div>
                </div>
              </div>
              <div class="detail-item full-width" *ngIf="isInViewMode() && selectedApplication.idDocumentFileUrl">
                <span class="detail-label">æœ¬äººç¢ºèªæ›¸é¡:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.idDocumentFileUrl" target="_blank" class="file-link">æœ¬äººç¢ºèªæ›¸é¡ã‚’é–‹ã</a>
                </span>
              </div>
              <div class="detail-item full-width" *ngIf="isInEditMode()">
                <span class="detail-label">æœ¬äººç¢ºèªæ›¸é¡:</span>
                <div class="detail-edit-input">
                  <input 
                    type="file" 
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelected($event, 'idDocument')"
                    class="form-input"
                  >
                  <div *ngIf="idDocumentFile" class="file-info">
                    é¸æŠæ¸ˆã¿: {{ idDocumentFile.name }}
                  </div>
                  <div *ngIf="selectedApplication.idDocumentFileUrl && !idDocumentFile" class="file-info">
                    ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«: <a [href]="selectedApplication.idDocumentFileUrl" target="_blank" class="file-link">æœ¬äººç¢ºèªæ›¸é¡ã‚’é–‹ã</a>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </form>
        
        <!-- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ï¼ˆç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã§ãªã„å ´åˆï¼‰ -->
        <ng-container *ngIf="!isEditModeForReapplication || selectedApplication.status !== 'å·®ã—æˆ»ã—'">
          <!-- åŸºæœ¬æƒ…å ± -->
          <section class="detail-section">
            <h3 class="section-title">åŸºæœ¬æƒ…å ±</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">æ°å:</span>
                <span class="detail-value">{{ selectedApplication.name || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">æ°åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.nameKana || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ç”Ÿå¹´æœˆæ—¥:</span>
                <span class="detail-value">{{ selectedApplication.birthDate || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">æˆ¸ç±ä¸Šã®æ€§åˆ¥:</span>
                <span class="detail-value">{{ selectedApplication.gender || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</span>
                <span class="detail-value">{{ selectedApplication.email || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ -->
          <section class="detail-section">
            <h3 class="section-title">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼</h3>
            <div class="detail-grid">
              <div class="detail-item full-width">
                <span class="detail-label">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼:</span>
                <span class="detail-value">{{ selectedApplication.myNumber ? 'â—â—â—â—-â—â—â—â—-â—â—â—â—' : '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- ç¾ä½æ‰€ã¨é€£çµ¡å…ˆ -->
          <section class="detail-section">
            <h3 class="section-title">ç¾ä½æ‰€ã¨é€£çµ¡å…ˆ</h3>
            <div class="detail-grid">
              <div class="detail-item full-width">
                <span class="detail-label">æµ·å¤–ã«åœ¨ä½:</span>
                <span class="detail-value">{{ selectedApplication.isOverseasResident ? 'ã¯ã„' : 'ã„ã„ãˆ' }}</span>
              </div>
              <div class="detail-item" *ngIf="!selectedApplication.isOverseasResident">
                <span class="detail-label">éƒµä¾¿ç•ªå·:</span>
                <span class="detail-value">{{ selectedApplication.postalCode || '-' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="!selectedApplication.isOverseasResident">
                <span class="detail-label">ç¾ä½æ‰€:</span>
                <span class="detail-value">{{ selectedApplication.currentAddress || '-' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="!selectedApplication.isOverseasResident">
                <span class="detail-label">ç¾ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.currentAddressKana || '-' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.isOverseasResident">
                <span class="detail-label">ä½æ‰€ï¼ˆæµ·å¤–ï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.overseasAddress || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">é›»è©±ç•ªå·:</span>
                <span class="detail-value">{{ selectedApplication.phoneNumber || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- ä½æ°‘ç¥¨ä½æ‰€ -->
          <section class="detail-section">
            <h3 class="section-title">ä½æ°‘ç¥¨ä½æ‰€</h3>
            <div class="detail-grid">
              <div class="detail-item full-width" *ngIf="!selectedApplication.isOverseasResident">
                <span class="detail-label">ä½æ‰€ï¼ˆç¾ä½æ‰€ã¨åŒã˜ï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.sameAsCurrentAddress ? 'ã¯ã„' : 'ã„ã„ãˆ' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.isOverseasResident">
                <span class="detail-label">ä½æ°‘ç¥¨ä½æ‰€ã‚’è¨˜è¼‰ã—ãªã„:</span>
                <span class="detail-value">{{ selectedApplication.skipResidentAddress ? 'ã¯ã„' : 'ã„ã„ãˆ' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.isOverseasResident && selectedApplication.skipResidentAddress">
                <span class="detail-label">ä½æ°‘ç¥¨ä½æ‰€ã‚’è¨˜è¼‰ã—ãªã„ç†ç”±:</span>
                <span class="detail-value">{{ selectedApplication.residentAddressSkipReason || '-' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="!selectedApplication.isOverseasResident && !selectedApplication.skipResidentAddress">
                <span class="detail-label">ä½æ‰€:</span>
                <span class="detail-value">{{ selectedApplication.residentAddress || '-' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="!selectedApplication.isOverseasResident && !selectedApplication.skipResidentAddress">
                <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.residentAddressKana || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- ç·Šæ€¥é€£çµ¡å…ˆ -->
          <section class="detail-section">
            <h3 class="section-title">ç·Šæ€¥é€£çµ¡å…ˆ</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">æ°å:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.name || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">æ°åï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.nameKana || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ç¶šæŸ„:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.relationship || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">ç·Šæ€¥é€£çµ¡å…ˆé›»è©±ç•ªå·:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.phone || '-' }}</span>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.address || '-' }}</span>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label">ä½æ‰€ï¼ˆãƒ¨ãƒŸã‚¬ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.emergencyContact?.addressKana || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- å£åº§æƒ…å ± -->
          <section class="detail-section">
            <h3 class="section-title">å£åº§æƒ…å ±</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">éŠ€è¡Œå:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.bankName || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">é é‡‘ç¨®åˆ¥:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.accountType || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">åç¾©ï¼ˆã‚«ã‚¿ã‚«ãƒŠï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.accountHolder || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">æ”¯åº—å:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.branchName || '-' }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">å£åº§ç•ªå·:</span>
                <span class="detail-value">{{ selectedApplication.bankAccount?.accountNumber || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- ç¤¾ä¼šä¿é™º -->
          <section class="detail-section">
            <h3 class="section-title">ç¤¾ä¼šä¿é™º</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">åŸºç¤å¹´é‡‘ç•ªå·:</span>
                <span class="detail-value">{{ formatBasicPensionNumberForDisplay(selectedApplication.basicPensionNumber) }}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´:</span>
                <span class="detail-value">{{ selectedApplication.pensionHistoryStatus || '-' }}</span>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.pensionHistoryStatus === 'æœ‰'">
                <span class="detail-label">åšç”Ÿå¹´é‡‘åŠ å…¥å±¥æ­´ï¼ˆè©³ç´°ï¼‰:</span>
                <span class="detail-value">{{ selectedApplication.pensionHistory || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- æ‰¶é¤Šè€…æœ‰ç„¡ -->
          <section class="detail-section">
            <h3 class="section-title">æ‰¶é¤Šè€…æœ‰ç„¡</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">è¢«æ‰¶é¤Šè€…:</span>
                <span class="detail-value">{{ selectedApplication.dependentStatus || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦ -->
          <section class="detail-section">
            <h3 class="section-title">è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label">è³‡æ ¼ç¢ºèªæ›¸ç™ºè¡Œè¦å¦:</span>
                <span class="detail-value">{{ selectedApplication.qualificationCertificateRequired || '-' }}</span>
              </div>
            </div>
          </section>
          
          <!-- æ·»ä»˜è³‡æ–™ -->
          <section class="detail-section" *ngIf="selectedApplication.resumeFileUrl || selectedApplication.careerHistoryFileUrl || selectedApplication.basicPensionNumberDocFileUrl || selectedApplication.idDocumentFileUrl">
            <h3 class="section-title">æ·»ä»˜è³‡æ–™</h3>
            <div class="detail-grid">
              <div class="detail-item full-width" *ngIf="selectedApplication.resumeFileUrl">
                <span class="detail-label">å±¥æ­´æ›¸:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.resumeFileUrl" target="_blank" class="file-link">å±¥æ­´æ›¸ã‚’é–‹ã</a>
                </span>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.careerHistoryFileUrl">
                <span class="detail-label">è·å‹™çµŒæ­´æ›¸:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.careerHistoryFileUrl" target="_blank" class="file-link">è·å‹™çµŒæ­´æ›¸ã‚’é–‹ã</a>
                </span>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.basicPensionNumberDocFileUrl">
                <span class="detail-label">åŸºç¤å¹´é‡‘ç•ªå·ãŒã‚ã‹ã‚‹æ›¸é¡:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.basicPensionNumberDocFileUrl" target="_blank" class="file-link">åŸºç¤å¹´é‡‘ç•ªå·ãŒã‚ã‹ã‚‹æ›¸é¡ã‚’é–‹ã</a>
                </span>
              </div>
              <div class="detail-item full-width" *ngIf="selectedApplication.idDocumentFileUrl">
                <span class="detail-label">æœ¬äººç¢ºèªæ›¸é¡:</span>
                <span class="detail-value">
                  <a [href]="selectedApplication.idDocumentFileUrl" target="_blank" class="file-link">æœ¬äººç¢ºèªæ›¸é¡ã‚’é–‹ã</a>
                </span>
              </div>
            </div>
          </section>
        </ng-container>
      </ng-container>
      
      <!-- ãã®ä»–ã®ç”³è«‹ã‚¿ã‚¤ãƒ—ã®è©³ç´°ï¼ˆä»Šå¾Œå®Ÿè£…ï¼‰ -->
      <ng-container *ngIf="selectedApplication.applicationType !== 'æ‰¶é¤Šå®¶æ—è¿½åŠ ' && selectedApplication.applicationType !== 'æ‰¶é¤Šå‰Šé™¤ç”³è«‹' && selectedApplication.applicationType !== 'ä½æ‰€å¤‰æ›´ç”³è«‹' && selectedApplication.applicationType !== 'æ°åå¤‰æ›´ç”³è«‹' && selectedApplication.applicationType !== 'ç”£å‰ç”£å¾Œä¼‘æ¥­ç”³è«‹' && selectedApplication.applicationType !== 'é€€è·ç”³è«‹' && selectedApplication.applicationType !== 'ä¿é™ºè¨¼å†ç™ºè¡Œç”³è«‹' && selectedApplication.applicationType !== 'å…¥ç¤¾æ™‚ç”³è«‹' && selectedApplication.applicationType !== 'ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼å¤‰æ›´ç”³è«‹'">
        <section class="detail-section">
          <p class="no-detail-message">ã“ã®ç”³è«‹ã‚¿ã‚¤ãƒ—ã®è©³ç´°è¡¨ç¤ºã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™ã€‚</p>
        </section>
      </ng-container>
    </div>
    
    <div class="modal-footer">
      <button 
        type="button" 
        class="close-detail-button" 
        (click)="closeApplicationDetailModal()"
        [disabled]="isSubmittingReapplication"
        [title]="isSubmittingReapplication ? 'å‡¦ç†ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚' : ''"
      >é–‰ã˜ã‚‹</button>
    </div>
  </div>
</div>
