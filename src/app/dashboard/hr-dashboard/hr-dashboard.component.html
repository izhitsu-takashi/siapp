<div class="dashboard-wrapper">
  <!-- ヘッダー -->
  <header class="dashboard-header">
    <div class="header-left">
      <h1 class="app-name">SIApp</h1>
    </div>
    <div class="header-right">
      <span class="hr-info">
        <span class="hr-name">{{ hrName }}</span>
      </span>
      <button class="logout-button" (click)="logout()">ログアウト</button>
    </div>
  </header>

  <!-- メインコンテンツエリア -->
  <div class="dashboard-body">
    <!-- サイドバー -->
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <button
          *ngFor="let tab of tabs"
          class="sidebar-item"
          [class.active]="currentTab === tab.name"
          (click)="switchTab(tab.name)"
        >
          {{ tab.name }}
        </button>
      </nav>
    </aside>

    <!-- メインコンテンツ -->
    <main class="main-content">
      <div class="content-area">
        <!-- メインページ -->
        <ng-container *ngIf="currentTab === 'メインページ'">
          <h2 class="page-title">{{ currentTab }}のページです</h2>
        </ng-container>

        <!-- 設定ページ -->
        <ng-container *ngIf="currentTab === '設定'">
          <div class="settings-page">
            <h2 class="page-title">設定</h2>
            
            <form [formGroup]="settingsForm">
              <!-- 企業情報設定 -->
              <section class="settings-section">
                <h3 class="section-title">企業情報設定</h3>
                <div class="form-grid">
                  <div class="form-group full-width">
                    <label for="officeName">事業所名称 <span class="required">*</span></label>
                    <input 
                      type="text" 
                      id="officeName" 
                      formControlName="officeName" 
                      class="form-input"
                      placeholder="例: 株式会社サンプル"
                    >
                  </div>
                  <div class="form-group full-width">
                    <label for="officeAddress">事業所住所</label>
                    <textarea 
                      id="officeAddress" 
                      formControlName="officeAddress" 
                      class="form-input" 
                      rows="3"
                      placeholder="住所を入力"
                    ></textarea>
                  </div>
                  <div class="form-group">
                    <label for="officeNumber">事業所番号 <span class="required">*</span></label>
                    <input 
                      type="text" 
                      id="officeNumber" 
                      formControlName="officeNumber" 
                      class="form-input"
                      placeholder="例: 12345"
                      maxlength="5"
                      pattern="[0-9]{5}"
                      title="5桁の数字を入力してください"
                    >
                    <small class="form-hint">5桁の数字で入力してください</small>
                  </div>
                  <div class="form-group">
                    <label for="employerName">事業主氏名</label>
                    <input 
                      type="text" 
                      id="employerName" 
                      formControlName="employerName" 
                      class="form-input"
                      placeholder="例: 山田 太郎"
                    >
                  </div>
                  <div class="form-group">
                    <label for="officePhoneNumber">事業所電話番号</label>
                    <input 
                      type="text" 
                      id="officePhoneNumber" 
                      formControlName="officePhoneNumber" 
                      class="form-input"
                      placeholder="例: 03-1234-5678"
                    >
                  </div>
                  <div class="form-group">
                    <label for="corporateNumber">法人番号</label>
                    <input 
                      type="text" 
                      id="corporateNumber" 
                      formControlName="corporateNumber" 
                      class="form-input"
                      placeholder="例: 1234567890123"
                    >
                  </div>
                  <div class="form-group">
                    <label for="officeCode">事業所整理記号</label>
                    <input 
                      type="text" 
                      id="officeCode" 
                      formControlName="officeCode" 
                      class="form-input"
                      placeholder="例: 1234"
                    >
                  </div>
                </div>
                <div class="section-actions">
                  <button type="button" class="save-section-button" (click)="saveCompanyInfo()">
                    企業情報を保存
                  </button>
                </div>
              </section>

            </form>

            <!-- 人事権限設定 -->
            <section class="settings-section">
              <h3 class="section-title">人事権限設定</h3>
              <div class="hr-permission-section">
                <div class="hr-users-list">
                  <h4>人事権限を持つユーザー</h4>
                  <div class="users-table-container">
                    <table class="users-table">
                      <thead>
                        <tr>
                          <th>社員番号</th>
                          <th>氏名</th>
                          <th>メールアドレス</th>
                          <th>操作</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let user of hrUsers">
                          <td>{{ user.employeeNumber }}</td>
                          <td>{{ user.name }}</td>
                          <td>{{ user.email }}</td>
                          <td>
                            <button 
                              type="button" 
                              class="revoke-button"
                              (click)="revokeHrPermission(user.employeeNumber)"
                            >
                              権限を削除
                            </button>
                          </td>
                        </tr>
                        <tr *ngIf="hrUsers.length === 0">
                          <td colspan="4" class="empty-message">人事権限を持つユーザーがありません</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                
                <div class="all-users-list">
                  <h4>全ユーザー一覧</h4>
                  <div class="users-table-container">
                    <table class="users-table">
                      <thead>
                        <tr>
                          <th>社員番号</th>
                          <th>氏名</th>
                          <th>メールアドレス</th>
                          <th>操作</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let user of allUsers">
                          <td>{{ user.employeeNumber }}</td>
                          <td>{{ user.name }}</td>
                          <td>{{ user.email }}</td>
                          <td>
                            <button 
                              *ngIf="!user.hasHrPermission"
                              type="button" 
                              class="grant-button"
                              (click)="grantHrPermission(user.employeeNumber)"
                            >
                              権限を付与
                            </button>
                            <span *ngIf="user.hasHrPermission" class="has-permission">権限あり</span>
                          </td>
                        </tr>
                        <tr *ngIf="allUsers.length === 0">
                          <td colspan="4" class="empty-message">ユーザーが登録されていません</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </ng-container>

        <!-- 申請管理ページ -->
        <ng-container *ngIf="currentTab === '申請管理'">
          <div class="application-management-page">
            <h2 class="page-title">申請管理</h2>
            <p class="page-description">従業員からの申請を確認・承認・却下できます。</p>
            
            <div class="table-container">
              <table class="application-management-table">
                <thead>
                  <tr>
                    <th>申請ID</th>
                    <th>申請種類</th>
                    <th>申請者</th>
                    <th>社員番号</th>
                    <th>ステータス</th>
                    <th>申請日</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let application of allApplications" class="application-row" (click)="openApplicationDetail(application)">
                    <td>{{ application.applicationId }}</td>
                    <td>{{ application.applicationType }}</td>
                    <td>{{ application.employeeName || '-' }}</td>
                    <td>{{ application.employeeNumber || '-' }}</td>
                    <td>
                      <span class="status-badge" 
                            [class.status-pending]="application.status === '承認待ち'"
                            [class.status-reviewing]="application.status === '確認中'"
                            [class.status-approved]="application.status === '承認' || application.status === '承認済み'"
                            [class.status-rejected]="application.status === '却下' || application.status === '差し戻し'"
                            [class.status-resubmitted]="application.status === '再申請' || application.status === '再提出'">
                        {{ application.status }}
                      </span>
                    </td>
                    <td>{{ getApplicationDate(application) | date:'yyyy/MM/dd' }}</td>
                  </tr>
                  <tr *ngIf="allApplications.length === 0">
                    <td colspan="6" class="empty-message">申請がありません</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </ng-container>

        <!-- 入社手続きページ -->
        <ng-container *ngIf="currentTab === '入社手続き'">
          <div class="page-content">
            <div class="page-header">
              <h2 class="page-title">入社手続き</h2>
              <div class="header-buttons">
                <button 
                  *ngIf="hasReadyEmployees()" 
                  class="onboarding-process-button" 
                  (click)="openOnboardingProcessModal()"
                >
                  入社処理実行
                </button>
                <button class="add-employee-button" (click)="openAddModal()">
                  社員を追加
                </button>
              </div>
            </div>

            <!-- 新入社員一覧表 -->
            <div class="table-container">
              <table class="employee-table">
                <thead>
                  <tr>
                    <th>社員番号</th>
                    <th>氏名</th>
                    <th>メールアドレス</th>
                    <th>雇用形態</th>
                    <th>ステータス</th>
                  </tr>
                </thead>
                <tbody>
                  <tr 
                    *ngFor="let employee of onboardingEmployees" 
                    class="employee-row"
                    (click)="openOnboardingEmployeeModal(employee)"
                  >
                    <td>{{ employee.employeeNumber }}</td>
                    <td>{{ employee.name }}</td>
                    <td>{{ employee.email }}</td>
                    <td>{{ employee.employmentType }}</td>
                    <td>
                      <span class="status-badge" 
                            [class.status-pending]="employee.status === '申請待ち'"
                            [class.status-resubmitted]="employee.status === '申請済み'"
                            [class.status-rejected]="employee.status === '差し戻し'"
                            [class.status-approved]="employee.status === '準備完了'">
                        {{ employee.status }}
                      </span>
                    </td>
                  </tr>
                  <tr *ngIf="onboardingEmployees.length === 0">
                    <td colspan="5" class="empty-message">新入社員がありません</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </ng-container>

        <!-- 文書作成・管理ページ -->
        <ng-container *ngIf="currentTab === '文書作成・管理'">
          <div class="document-management-page">
            <h2 class="page-title">文書作成・管理</h2>
            
            <!-- 文書選択セクション -->
            <section class="document-selection-section">
              <h3 class="section-title">文書を選択</h3>
              <div class="form-group">
                <label for="documentType">文書種類 <span class="required">*</span></label>
                <select 
                  id="documentType" 
                  class="form-input"
                  [(ngModel)]="selectedDocumentType"
                  (change)="onDocumentTypeChange()"
                >
                  <option value="">選択してください</option>
                  <option *ngFor="let docType of documentTypes" [value]="docType">
                    {{ docType }}
                  </option>
                </select>
              </div>
            </section>

            <!-- 従業員選択セクション -->
            <section class="employee-selection-section">
              <h3 class="section-title">従業員を選択</h3>
              
              <!-- 従業員検索 -->
              <div class="form-group">
                <label for="employeeSearch">従業員検索</label>
                <div class="employee-search-container">
                  <input 
                    type="text" 
                    id="employeeSearch" 
                    class="form-input"
                    [(ngModel)]="employeeSearchQuery"
                    (input)="onEmployeeSearch()"
                    placeholder="社員番号、氏名、メールアドレスで検索"
                    [disabled]="!!selectedEmployee"
                  >
                  <button 
                    *ngIf="selectedEmployee" 
                    type="button" 
                    class="clear-button"
                    (click)="clearEmployeeSelection()"
                  >
                    クリア
                  </button>
                </div>
              </div>

              <!-- 選択された従業員表示 -->
              <div *ngIf="selectedEmployee" class="selected-employee-card">
                <div class="selected-employee-info">
                  <div class="employee-info-item">
                    <span class="info-label">社員番号:</span>
                    <span class="info-value">{{ selectedEmployee.employeeNumber }}</span>
                  </div>
                  <div class="employee-info-item">
                    <span class="info-label">氏名:</span>
                    <span class="info-value">{{ selectedEmployee.name }}</span>
                  </div>
                  <div class="employee-info-item">
                    <span class="info-label">メールアドレス:</span>
                    <span class="info-value">{{ selectedEmployee.email }}</span>
                  </div>
                  <div class="employee-info-item">
                    <span class="info-label">雇用形態:</span>
                    <span class="info-value">{{ selectedEmployee.employmentType }}</span>
                  </div>
                </div>
              </div>

              <!-- 従業員検索結果リスト -->
              <div *ngIf="!selectedEmployee && employeeSearchQuery && filteredEmployees.length > 0" class="employee-search-results">
                <div class="search-results-header">
                  <span class="results-count">検索結果: {{ filteredEmployees.length }}件</span>
                </div>
                <div class="employee-list">
                  <div 
                    *ngFor="let employee of filteredEmployees" 
                    class="employee-item"
                    (click)="selectEmployee(employee)"
                  >
                    <div class="employee-item-content">
                      <div class="employee-item-main">
                        <span class="employee-number">{{ employee.employeeNumber }}</span>
                        <span class="employee-name">{{ employee.name }}</span>
                      </div>
                      <div class="employee-item-sub">
                        <span class="employee-email">{{ employee.email }}</span>
                        <span class="employee-type">{{ employee.employmentType }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- 検索結果なし -->
              <div *ngIf="!selectedEmployee && employeeSearchQuery && filteredEmployees.length === 0" class="no-results">
                <p>該当する従業員が見つかりませんでした。</p>
              </div>

              <!-- 検索前のメッセージ -->
              <div *ngIf="!selectedEmployee && !employeeSearchQuery" class="search-prompt">
                <p>上記の検索欄で従業員を検索してください。</p>
              </div>
            </section>

            <!-- 文書作成ボタン -->
            <section class="document-action-section" *ngIf="selectedDocumentType && selectedEmployee">
              <button 
                class="create-document-button" 
                (click)="createDocument()"
                [disabled]="isCreatingDocument"
              >
                <span *ngIf="!isCreatingDocument">文書を作成</span>
                <span *ngIf="isCreatingDocument">作成中...</span>
              </button>
              <button 
                class="show-info-button" 
                (click)="showDocumentInfo()"
                style="background: #2196F3; color: white; padding: 0.5rem 1rem; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem; margin-left: 0.5rem;"
              >
                必要な情報を表示
              </button>
              <p class="action-note" *ngIf="!isCreatingDocument">
                選択した従業員の情報をPDFに記入してダウンロードします
              </p>
            </section>

            <!-- 座標確認用デバッグボタン（開発用） -->
            <section class="document-action-section" *ngIf="selectedDocumentType">
              <button 
                class="debug-button" 
                (click)="debugPdfCoordinates()"
                style="background: #ff9800; color: white; padding: 0.5rem 1rem; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem;"
              >
                座標確認用PDFを生成
              </button>
              <p class="action-note" style="font-size: 0.85rem; color: #666; margin-top: 0.5rem;">
                選択した文書の座標グリッドを表示したPDFをダウンロードします（開発用）
              </p>
              <p class="action-note loading-note" *ngIf="isCreatingDocument">
                PDFを作成しています。しばらくお待ちください...
              </p>
            </section>
          </div>
        </ng-container>

        <!-- 保険証管理ページ -->
        <ng-container *ngIf="currentTab === '保険証管理'">
          <div class="insurance-card-management-page">
            <h2 class="page-title">保険証管理</h2>
            
            <div class="table-container">
              <table class="insurance-card-table">
                <thead>
                  <tr>
                    <th>社員ID</th>
                    <th>氏名</th>
                    <th>被保険者記号</th>
                    <th>被保険者番号</th>
                    <th>発行日</th>
                    <th>回収日</th>
                    <th>ステータス</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let card of insuranceCards">
                    <td>{{ card.employeeNumber }}</td>
                    <td>{{ card.name }}</td>
                    <td>{{ card.insuranceSymbol || '-' }}</td>
                    <td>{{ card.insuranceNumber || '-' }}</td>
                    <td>{{ formatDate(card.issueDate) }}</td>
                    <td>{{ formatDate(card.returnDate) }}</td>
                    <td>
                      <span class="status-badge" 
                            [class.status-preparing]="card.status === '準備中'"
                            [class.status-distributed]="card.status === '配布済み'"
                            [class.status-reissuing]="card.status === '再発行中'"
                            [class.status-returned]="card.status === '回収済み'">
                        {{ card.status || '-' }}
                      </span>
                    </td>
                  </tr>
                  <tr *ngIf="insuranceCards.length === 0">
                    <td colspan="7" class="empty-message">保険証データがありません</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </ng-container>

        <!-- 社員情報管理ページ -->
        <ng-container *ngIf="currentTab === '社員情報管理'">
          <div class="page-header">
            <h2 class="page-title">社員情報管理</h2>
          </div>

          <!-- 社員一覧テーブル -->
          <div class="table-container">
            <table class="employee-table">
              <thead>
                <tr>
                  <th>社員番号</th>
                  <th>氏名</th>
                  <th>メールアドレス</th>
                  <th>雇用形態</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let employee of employees" (click)="openEmployeeEditModal(employee.employeeNumber)" class="employee-row">
                  <td>{{ employee.employeeNumber }}</td>
                  <td>{{ employee.name }}</td>
                  <td>{{ employee.email }}</td>
                  <td>{{ employee.employmentType }}</td>
                </tr>
                <tr *ngIf="employees.length === 0">
                  <td colspan="4" class="empty-message">社員データがありません</td>
                </tr>
              </tbody>
            </table>
          </div>
        </ng-container>
      </div>
    </main>
  </div>

  <!-- 社員追加モーダル -->
  <div *ngIf="showAddModal" class="modal-overlay" (click)="closeAddModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3 class="modal-title">新規社員追加</h3>
        <button class="modal-close" (click)="closeAddModal()">×</button>
      </div>
      
      <form [formGroup]="addEmployeeForm" (ngSubmit)="addEmployees()" class="add-employee-form">
        <div formArrayName="employees">
          <div 
            *ngFor="let employee of employeesFormArray.controls; let i = index"
            [formGroupName]="i"
            class="employee-form-row"
          >
            <div class="form-row-header">
              <h4>社員 {{ i + 1 }}</h4>
              <button 
                *ngIf="employeesFormArray.length > 1"
                type="button" 
                class="remove-row-button" 
                (click)="removeEmployeeRow(i)"
              >
                削除
              </button>
            </div>
            
            <div class="form-grid">
              <div class="form-group">
                <label [for]="'employeeNumber' + i">社員番号 <span class="required">*</span></label>
                <input 
                  type="text" 
                  [id]="'employeeNumber' + i"
                  formControlName="employeeNumber" 
                  class="form-input"
                  placeholder="例: EMP001"
                >
              </div>
              <div class="form-group">
                <label [for]="'name' + i">氏名 <span class="required">*</span></label>
                <input 
                  type="text" 
                  [id]="'name' + i"
                  formControlName="name" 
                  class="form-input"
                  placeholder="例: 山田 太郎"
                >
              </div>
              <div class="form-group">
                <label [for]="'email' + i">メールアドレス <span class="required">*</span></label>
                <input 
                  type="email" 
                  [id]="'email' + i"
                  formControlName="email" 
                  class="form-input"
                  placeholder="例: example@email.com"
                >
              </div>
              <div class="form-group">
                <label [for]="'employmentType' + i">雇用形態 <span class="required">*</span></label>
                <select 
                  [id]="'employmentType' + i"
                  formControlName="employmentType" 
                  class="form-input"
                >
                  <option value="">選択してください</option>
                  <option *ngFor="let type of employmentTypes" [value]="type">{{ type }}</option>
                </select>
              </div>
              <div class="form-group">
                <label [for]="'initialPassword' + i">初期パスワード <span class="required">*</span></label>
                <input 
                  type="password" 
                  [id]="'initialPassword' + i"
                  formControlName="initialPassword" 
                  class="form-input"
                  placeholder="初期パスワードを入力（6文字以上）"
                >
                <div *ngIf="employeesFormArray.at(i).get('initialPassword')?.invalid && employeesFormArray.at(i).get('initialPassword')?.touched" class="error-message">
                  <span *ngIf="employeesFormArray.at(i).get('initialPassword')?.errors?.['required']">
                    初期パスワードを入力してください
                  </span>
                  <span *ngIf="employeesFormArray.at(i).get('initialPassword')?.errors?.['minlength']">
                    パスワードは6文字以上で入力してください
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="add-row-button" (click)="addEmployeeRow()">
            + 行を追加
          </button>
        </div>

        <div class="modal-actions">
          <button type="button" class="cancel-button" (click)="closeAddModal()">
            キャンセル
          </button>
          <button type="submit" class="submit-button" [disabled]="addEmployeeForm.invalid">
            追加
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- 社員情報編集モーダル -->
  <div *ngIf="showEmployeeEditModal" class="modal-overlay" (click)="closeEmployeeEditModal()">
    <div class="modal-content employee-edit-modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3 class="modal-title">社員情報編集</h3>
        <button class="modal-close" (click)="closeEmployeeEditModal()">×</button>
      </div>
      
      <form [formGroup]="employeeEditForm" (ngSubmit)="saveEmployeeData()" class="employee-edit-form">
        <!-- 基本情報欄 -->
        <section class="form-section">
          <h3 class="section-title">基本情報</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="hr-name">氏名 <span class="required">*</span></label>
              <input 
                type="text" 
                id="hr-name" 
                formControlName="name" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="hr-nameKana">氏名（ヨミガナ）</label>
              <input 
                type="text" 
                id="hr-nameKana" 
                formControlName="nameKana" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="hr-birthDate">生年月日 <span class="required">*</span></label>
              <div class="birth-date-container">
                <input 
                  type="date" 
                  id="hr-birthDate" 
                  formControlName="birthDate" 
                  class="form-input"
                  (change)="onBirthDateChange()"
                >
                <span *ngIf="age !== null" class="age-display">（{{ age }}歳）</span>
              </div>
            </div>
            <div class="form-group">
              <label for="hr-gender">戸籍上の性別 <span class="required">*</span></label>
              <select 
                id="hr-gender" 
                formControlName="gender" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let g of genders" [value]="g">{{ g }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="hr-email">メールアドレス <span class="required">*</span></label>
              <input 
                type="email" 
                id="hr-email" 
                formControlName="email" 
                class="form-input"
              >
            </div>
            <div class="form-group full-width">
              <label for="hr-idDocument">本人確認書類添付</label>
              <input 
                type="file" 
                id="hr-idDocument" 
                class="form-input"
                accept=".pdf,.jpg,.jpeg,.png"
                (change)="onFileSelected($event, 'idDocument')"
              >
              <div *ngIf="idDocumentFile" class="file-name">{{ idDocumentFile.name }}</div>
            </div>
          </div>
        </section>

        <!-- マイナンバー欄 -->
        <section class="form-section">
          <h3 class="section-title">マイナンバー</h3>
          <div class="form-grid">
            <div class="form-group full-width">
              <label for="hr-myNumberPart1">マイナンバー</label>
              <div class="my-number-container">
                <div class="my-number-inputs">
                  <input 
                    type="text" 
                    id="hr-myNumberPart1" 
                    formControlName="myNumberPart1" 
                    class="form-input my-number-part"
                    [type]="showMyNumber ? 'text' : 'password'"
                    [readonly]="!showMyNumber"
                    maxlength="4"
                    (input)="formatMyNumberInput($event, 1)"
                    placeholder="0000"
                  >
                  <span class="my-number-separator">-</span>
                  <input 
                    type="text" 
                    id="hr-myNumberPart2" 
                    formControlName="myNumberPart2" 
                    class="form-input my-number-part"
                    [type]="showMyNumber ? 'text' : 'password'"
                    [readonly]="!showMyNumber"
                    maxlength="4"
                    (input)="formatMyNumberInput($event, 2)"
                    placeholder="0000"
                  >
                  <span class="my-number-separator">-</span>
                  <input 
                    type="text" 
                    id="hr-myNumberPart3" 
                    formControlName="myNumberPart3" 
                    class="form-input my-number-part"
                    [type]="showMyNumber ? 'text' : 'password'"
                    [readonly]="!showMyNumber"
                    maxlength="4"
                    (input)="formatMyNumberInput($event, 3)"
                    placeholder="0000"
                  >
                </div>
                <button 
                  type="button" 
                  class="toggle-button" 
                  (click)="toggleMyNumber()"
                >
                  {{ showMyNumber ? '非表示' : '表示' }}
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- 入退社情報欄 -->
        <section class="form-section">
          <h3 class="section-title">入退社情報</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="hr-employmentStatus">在籍状況</label>
              <select 
                id="hr-employmentStatus" 
                formControlName="employmentStatus" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let status of employmentStatuses" [value]="status">{{ status }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="hr-joinDate">入社年月日</label>
              <input 
                type="date" 
                id="hr-joinDate" 
                formControlName="joinDate" 
                class="form-input"
              >
            </div>
            <div class="form-group" *ngIf="employeeEditForm.get('employmentStatus')?.value !== '在籍'">
              <label for="hr-resignationDate">退職年月日</label>
              <input 
                type="date" 
                id="hr-resignationDate" 
                formControlName="resignationDate" 
                class="form-input"
              >
            </div>
            <div class="form-group full-width" *ngIf="employeeEditForm.get('employmentStatus')?.value !== '在籍'">
              <label for="hr-resignationReason">退職事由</label>
              <textarea 
                id="hr-resignationReason" 
                formControlName="resignationReason" 
                class="form-input" 
                rows="3"
              ></textarea>
            </div>
          </div>
        </section>

        <!-- 業務情報欄 -->
        <section class="form-section">
          <h3 class="section-title">業務情報</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="hr-employeeNumber">社員番号 <span class="required">*</span></label>
              <input 
                type="text" 
                id="hr-employeeNumber" 
                formControlName="employeeNumber" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="hr-office">事業所</label>
              <select 
                id="hr-office" 
                formControlName="office" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let office of offices" [value]="office">{{ office }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="hr-workContent">業務内容</label>
              <select 
                id="hr-workContent" 
                formControlName="workContent" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let content of workContents" [value]="content">{{ content }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="hr-employmentType">雇用形態</label>
              <select 
                id="hr-employmentType" 
                formControlName="employmentType" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let type of employmentTypes" [value]="type">{{ type }}</option>
              </select>
            </div>
          </div>
        </section>

        <!-- 部署・役職情報 -->
        <section class="form-section">
          <h3 class="section-title">部署・役職情報</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="hr-department">部署</label>
              <select 
                id="hr-department" 
                formControlName="department" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="hr-position">役職</label>
              <select 
                id="hr-position" 
                formControlName="position" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let pos of positions" [value]="pos">{{ pos }}</option>
              </select>
            </div>
          </div>
        </section>

        <!-- 現住所と連絡先欄 -->
        <section class="form-section">
          <h3 class="section-title">現住所と連絡先</h3>
          <div class="form-grid">
            <div class="form-group full-width">
              <label for="hr-currentAddress">現住所</label>
              <textarea 
                id="hr-currentAddress" 
                formControlName="currentAddress" 
                class="form-input" 
                rows="2"
              ></textarea>
            </div>
            <div class="form-group full-width">
              <label for="hr-currentAddressKana">現住所（ヨミガナ）</label>
              <textarea 
                id="hr-currentAddressKana" 
                formControlName="currentAddressKana" 
                class="form-input" 
                rows="2"
              ></textarea>
            </div>
            <div class="form-group">
              <label for="hr-phoneNumber">電話番号</label>
              <input 
                type="tel" 
                id="hr-phoneNumber" 
                formControlName="phoneNumber" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="hr-currentHouseholdHead">世帯主（本人/親族）</label>
              <select 
                id="hr-currentHouseholdHead" 
                formControlName="currentHouseholdHead" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let type of householdHeadTypes" [value]="type">{{ type }}</option>
              </select>
            </div>
          </div>
        </section>

        <!-- 住民票住所欄 -->
        <section class="form-section">
          <h3 class="section-title">住民票住所</h3>
          <div class="form-grid">
            <div class="form-group full-width">
              <label class="checkbox-label">
                <input 
                  type="checkbox" 
                  [checked]="sameAsCurrentAddress" 
                  (change)="onSameAddressChange($event)"
                >
                住所（現住所と同じ）
              </label>
            </div>
            <div class="form-group full-width">
              <label for="hr-residentAddress">住所</label>
              <textarea 
                id="hr-residentAddress" 
                formControlName="residentAddress" 
                class="form-input" 
                rows="2"
                [readonly]="sameAsCurrentAddress"
              ></textarea>
            </div>
            <div class="form-group full-width">
              <label for="hr-residentAddressKana">住所（ヨミガナ）</label>
              <textarea 
                id="hr-residentAddressKana" 
                formControlName="residentAddressKana" 
                class="form-input" 
                rows="2"
                [readonly]="sameAsCurrentAddress"
              ></textarea>
            </div>
          </div>
        </section>

        <!-- 履歴書・職務経歴書欄 -->
        <section class="form-section">
          <h3 class="section-title">履歴書・職務経歴書</h3>
          <div class="form-grid">
            <div class="form-group full-width">
              <label for="hr-resume">履歴書添付</label>
              <input 
                type="file" 
                id="hr-resume" 
                class="form-input"
                accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                (change)="onFileSelected($event, 'resume')"
              >
              <div *ngIf="resumeFile" class="file-name">{{ resumeFile.name }}</div>
            </div>
            <div class="form-group full-width">
              <label for="hr-careerHistory">職務経歴書添付</label>
              <input 
                type="file" 
                id="hr-careerHistory" 
                class="form-input"
                accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                (change)="onFileSelected($event, 'careerHistory')"
              >
              <div *ngIf="careerHistoryFile" class="file-name">{{ careerHistoryFile.name }}</div>
            </div>
          </div>
        </section>

        <!-- 緊急連絡先欄 -->
        <section class="form-section">
          <h3 class="section-title">緊急連絡先</h3>
          <div formGroupName="emergencyContact" class="nested-form">
            <div class="form-grid">
              <div class="form-group">
                <label for="hr-emergencyName">氏名</label>
                <input 
                  type="text" 
                  id="hr-emergencyName" 
                  formControlName="name" 
                  class="form-input"
                >
              </div>
              <div class="form-group">
                <label for="hr-emergencyNameKana">氏名（ヨミガナ）</label>
                <input 
                  type="text" 
                  id="hr-emergencyNameKana" 
                  formControlName="nameKana" 
                  class="form-input"
                >
              </div>
              <div class="form-group">
                <label for="hr-emergencyRelationship">続柄</label>
                <input 
                  type="text" 
                  id="hr-emergencyRelationship" 
                  formControlName="relationship" 
                  class="form-input"
                >
              </div>
              <div class="form-group">
                <label for="hr-emergencyPhone">緊急連絡先電話番号</label>
                <input 
                  type="tel" 
                  id="hr-emergencyPhone" 
                  formControlName="phone" 
                  class="form-input"
                >
              </div>
              <div class="form-group full-width">
                <label>
                  <input 
                    type="checkbox" 
                    [checked]="sameAsCurrentAddressForEmergency"
                    (change)="onSameAddressForEmergencyChange($event)"
                    class="checkbox-input"
                  >
                  現住所と同じ
                </label>
              </div>
              <div class="form-group full-width">
                <label for="hr-emergencyAddress">住所</label>
                <textarea 
                  id="hr-emergencyAddress" 
                  formControlName="address" 
                  class="form-input" 
                  rows="2"
                  [readonly]="sameAsCurrentAddressForEmergency"
                ></textarea>
              </div>
              <div class="form-group full-width">
                <label for="hr-emergencyAddressKana">住所（ヨミガナ）</label>
                <textarea 
                  id="hr-emergencyAddressKana" 
                  formControlName="addressKana" 
                  class="form-input" 
                  rows="2"
                  [readonly]="sameAsCurrentAddressForEmergency"
                ></textarea>
              </div>
            </div>
          </div>
        </section>

        <!-- 口座情報欄 -->
        <section class="form-section">
          <h3 class="section-title">口座情報</h3>
          <div formGroupName="bankAccount" class="nested-form">
            <div class="form-grid">
              <div class="form-group">
                <label for="hr-bankName">銀行名</label>
                <input 
                  type="text" 
                  id="hr-bankName" 
                  formControlName="bankName" 
                  class="form-input"
                >
              </div>
              <div class="form-group">
                <label for="hr-accountType">預金種別</label>
                <select 
                  id="hr-accountType" 
                  formControlName="accountType" 
                  class="form-input"
                >
                  <option value="">選択してください</option>
                  <option value="普通">普通</option>
                  <option value="当座">当座</option>
                  <option value="貯蓄">貯蓄</option>
                </select>
              </div>
              <div class="form-group">
                <label for="hr-accountHolder">名義（カタカナ）</label>
                <input 
                  type="text" 
                  id="hr-accountHolder" 
                  formControlName="accountHolder" 
                  class="form-input"
                >
              </div>
              <div class="form-group">
                <label for="hr-branchName">支店名</label>
                <input 
                  type="text" 
                  id="hr-branchName" 
                  formControlName="branchName" 
                  class="form-input"
                >
              </div>
              <div class="form-group">
                <label for="hr-accountNumber">口座番号</label>
                <input 
                  type="text" 
                  id="hr-accountNumber" 
                  formControlName="accountNumber" 
                  class="form-input"
                >
              </div>
            </div>
          </div>
        </section>

        <!-- 社会保険欄 -->
        <section class="form-section">
          <h3 class="section-title">社会保険</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="hr-healthInsuranceNumber">健康保険の被保険者整理番号</label>
              <input 
                type="text" 
                id="hr-healthInsuranceNumber" 
                formControlName="healthInsuranceNumber" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="hr-pensionInsuranceNumber">厚生年金保険の被保険者整理番号</label>
              <input 
                type="text" 
                id="hr-pensionInsuranceNumber" 
                formControlName="pensionInsuranceNumber" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="hr-basicPensionNumberPart1">基礎年金番号</label>
              <div class="basic-pension-number-container">
                <input 
                  type="text" 
                  id="hr-basicPensionNumberPart1" 
                  formControlName="basicPensionNumberPart1" 
                  class="form-input basic-pension-part"
                  maxlength="4"
                  (input)="formatBasicPensionNumberInput($event, 1)"
                  placeholder="0000"
                >
                <span class="basic-pension-separator">-</span>
                <input 
                  type="text" 
                  id="hr-basicPensionNumberPart2" 
                  formControlName="basicPensionNumberPart2" 
                  class="form-input basic-pension-part"
                  maxlength="6"
                  (input)="formatBasicPensionNumberInput($event, 2)"
                  placeholder="000000"
                >
              </div>
            </div>
            <div class="form-group">
              <label for="hr-pensionHistoryStatus">厚生年金加入履歴</label>
              <select 
                id="hr-pensionHistoryStatus" 
                formControlName="pensionHistoryStatus" 
                class="form-input" 
                (change)="onPensionHistoryChange($event)"
              >
                <option value="">選択してください</option>
                <option *ngFor="let option of pensionHistoryOptions" [value]="option">{{ option }}</option>
              </select>
            </div>
            <div class="form-group full-width" *ngIf="hasPensionHistory">
              <label for="hr-pensionHistory">厚生年金加入履歴（詳細）</label>
              <textarea 
                id="hr-pensionHistory" 
                formControlName="pensionHistory" 
                class="form-input" 
                rows="4"
              ></textarea>
            </div>
            <div class="form-group">
              <label for="hr-socialInsuranceAcquisitionDate">社会保険の資格取得年月日</label>
              <input 
                type="date" 
                id="hr-socialInsuranceAcquisitionDate" 
                formControlName="socialInsuranceAcquisitionDate" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="hr-socialInsuranceLossDate">社会保険の資格喪失年月日</label>
              <input 
                type="date" 
                id="hr-socialInsuranceLossDate" 
                formControlName="socialInsuranceLossDate" 
                class="form-input"
              >
            </div>
            <div class="form-group full-width">
              <label for="hr-basicPensionNumberDoc">基礎年金番号確認書類添付</label>
              <input 
                type="file" 
                id="hr-basicPensionNumberDoc" 
                class="form-input"
                accept=".pdf,.jpg,.jpeg,.png"
                (change)="onFileSelected($event, 'basicPensionNumberDoc')"
              >
              <div *ngIf="basicPensionNumberDocFile" class="file-name">{{ basicPensionNumberDocFile.name }}</div>
            </div>
          </div>
        </section>

        <!-- 扶養者情報欄 -->
        <section class="form-section">
          <h3 class="section-title">扶養者情報</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="hr-dependentStatus">被扶養者</label>
              <div class="readonly-field">
                {{ employeeDependentStatus || '-' }}
              </div>
            </div>
          </div>
        </section>


        <!-- 保険者種別欄（人事専用） -->
        <section class="form-section hr-only-section">
          <h3 class="section-title">保険者種別（人事専用）</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="hr-healthInsuranceType">健康保険者種別</label>
              <select 
                id="hr-healthInsuranceType" 
                formControlName="healthInsuranceType" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let type of healthInsuranceTypes" [value]="type">{{ type }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="hr-nursingInsuranceType">介護保険者種別</label>
              <select 
                id="hr-nursingInsuranceType" 
                formControlName="nursingInsuranceType" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let type of nursingInsuranceTypes" [value]="type">{{ type }}</option>
              </select>
            </div>
            <div class="form-group">
              <label for="hr-pensionInsuranceType">厚生年金保険者種別</label>
              <select 
                id="hr-pensionInsuranceType" 
                formControlName="pensionInsuranceType" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let type of pensionInsuranceTypes" [value]="type">{{ type }}</option>
              </select>
            </div>
          </div>
        </section>

        <!-- 扶養者情報欄（人事専用） -->
        <section class="form-section hr-only-section">
          <h3 class="section-title">扶養者情報（人事専用）</h3>
          <div class="dependents-container">
            <div class="dependents-header">
              <h4>扶養者一覧</h4>
            </div>
            
            <div *ngFor="let dependent of dependents; let i = index" class="dependent-item">
              <div class="dependent-header" (click)="toggleDependentExpanded(i)" style="cursor: pointer;">
                <h5>扶養者 {{ i + 1 }} <span class="expand-icon">{{ isDependentExpanded(i) ? '▼' : '▶' }}</span></h5>
                <button type="button" class="remove-dependent-button" (click)="removeDependent(i); $event.stopPropagation()">
                  削除
                </button>
              </div>
              <div class="form-grid" *ngIf="isDependentExpanded(i)">
                <div class="form-group">
                  <label [for]="'hr-dependent-name-' + i">氏名</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-name-' + i"
                    [(ngModel)]="dependent.name"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 山田 花子"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-nameKana-' + i">氏名（ヨミガナ）</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-nameKana-' + i"
                    [(ngModel)]="dependent.nameKana"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: ヤマダ ハナコ"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-relationship-' + i">続柄</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-relationship-' + i"
                    [(ngModel)]="dependent.relationship"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 妻、長男"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-birthDate-' + i">生年月日</label>
                  <input 
                    type="date" 
                    [id]="'hr-dependent-birthDate-' + i"
                    [(ngModel)]="dependent.birthDate"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-gender-' + i">性別</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-gender-' + i"
                    [(ngModel)]="dependent.gender"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 男性、女性"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-phoneNumber-' + i">電話番号</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-phoneNumber-' + i"
                    [(ngModel)]="dependent.phoneNumber"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 090-1234-5678"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-occupation-' + i">職業</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-occupation-' + i"
                    [(ngModel)]="dependent.occupation"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 会社員"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-annualIncome-' + i">年間収入見込み額</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-annualIncome-' + i"
                    [(ngModel)]="dependent.annualIncome"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 1000000"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-monthlyIncome-' + i">月額収入見込み額</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-monthlyIncome-' + i"
                    [(ngModel)]="dependent.monthlyIncome"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 100000"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-dependentStartDate-' + i">社会保険の扶養者となった日</label>
                  <input 
                    type="date" 
                    [id]="'hr-dependent-dependentStartDate-' + i"
                    [(ngModel)]="dependent.dependentStartDate"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                  >
                </div>
                <div class="form-group full-width">
                  <label [for]="'hr-dependent-dependentReason-' + i">扶養に追加された理由</label>
                  <textarea 
                    [id]="'hr-dependent-dependentReason-' + i"
                    [(ngModel)]="dependent.dependentReason"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input" 
                    rows="2"
                    placeholder="扶養に追加された理由を入力"
                  ></textarea>
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-myNumber-' + i">マイナンバー</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-myNumber-' + i"
                    [(ngModel)]="dependent.myNumber"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 1234-5678-9012"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-livingTogether-' + i">同居/別居</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-livingTogether-' + i"
                    [(ngModel)]="dependent.livingTogether"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 同居、別居"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-postalCode-' + i">郵便番号</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-postalCode-' + i"
                    [(ngModel)]="dependent.postalCode"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 123-4567"
                  >
                </div>
                <div class="form-group full-width">
                  <label [for]="'hr-dependent-address-' + i">住所</label>
                  <textarea 
                    [id]="'hr-dependent-address-' + i"
                    [(ngModel)]="dependent.address"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input" 
                    rows="2"
                    placeholder="住所を入力"
                  ></textarea>
                </div>
                <div class="form-group full-width">
                  <label [for]="'hr-dependent-addressKana-' + i">住所（ヨミガナ）</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-addressKana-' + i"
                    [(ngModel)]="dependent.addressKana"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: トウキョウトシンジュクク..."
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-addressChangeDate-' + i">住所変更年月日</label>
                  <input 
                    type="date" 
                    [id]="'hr-dependent-addressChangeDate-' + i"
                    [(ngModel)]="dependent.addressChangeDate"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                  >
                </div>
                <div class="form-group">
                  <label [for]="'hr-dependent-basicPensionNumber-' + i">基礎年金番号</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-basicPensionNumber-' + i"
                    [(ngModel)]="dependent.basicPensionNumber"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 0000-000000"
                  >
                </div>
                <div class="form-group" *ngIf="dependent.disabilityCategory || dependent.disabilityCardType || dependent.disabilityCardIssueDate">
                  <label [for]="'hr-dependent-disabilityCategory-' + i">障がい者区分</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-disabilityCategory-' + i"
                    [(ngModel)]="dependent.disabilityCategory"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 身体障害"
                  >
                </div>
                <div class="form-group" *ngIf="dependent.disabilityCategory || dependent.disabilityCardType || dependent.disabilityCardIssueDate">
                  <label [for]="'hr-dependent-disabilityCardType-' + i">障がい者手帳の種類</label>
                  <input 
                    type="text" 
                    [id]="'hr-dependent-disabilityCardType-' + i"
                    [(ngModel)]="dependent.disabilityCardType"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                    placeholder="例: 身体障害者手帳"
                  >
                </div>
                <div class="form-group" *ngIf="dependent.disabilityCategory || dependent.disabilityCardType || dependent.disabilityCardIssueDate">
                  <label [for]="'hr-dependent-disabilityCardIssueDate-' + i">障がい者手帳の交付年月日</label>
                  <input 
                    type="date" 
                    [id]="'hr-dependent-disabilityCardIssueDate-' + i"
                    [(ngModel)]="dependent.disabilityCardIssueDate"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input"
                  >
                </div>
                <div class="form-group full-width">
                  <label [for]="'hr-dependent-notes-' + i">備考</label>
                  <textarea 
                    [id]="'hr-dependent-notes-' + i"
                    [(ngModel)]="dependent.notes"
                    [ngModelOptions]="{standalone: true}"
                    class="form-input" 
                    rows="2"
                    placeholder="備考を入力"
                  ></textarea>
                </div>
              </div>
            </div>
            
            <div *ngIf="dependents.length === 0" class="no-data">
              扶養者が登録されていません。
            </div>
          </div>
        </section>

        <!-- 保険証情報（人事専用）欄 -->
        <section class="form-section hr-only-section">
          <h3 class="section-title">保険証情報（人事専用）</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="hr-insuranceSymbol">被保険者記号 <span class="required">*</span></label>
              <input 
                type="text" 
                id="hr-insuranceSymbol" 
                formControlName="insuranceSymbol" 
                class="form-input"
                maxlength="8"
                pattern="[0-9]*"
                (input)="formatInsuranceSymbolInput($event)"
                placeholder="00000000"
              >
              <div *ngIf="employeeEditForm.get('insuranceSymbol')?.invalid && employeeEditForm.get('insuranceSymbol')?.touched" class="error-message">
                被保険者記号を入力してください（8桁の数字）
              </div>
            </div>
            <div class="form-group">
              <label for="hr-insuranceNumber">被保険者番号 <span class="required">*</span></label>
              <input 
                type="text" 
                id="hr-insuranceNumber" 
                formControlName="insuranceNumber" 
                class="form-input"
                maxlength="3"
                pattern="[0-9]*"
                (input)="formatInsuranceNumberInput($event)"
                placeholder="000"
              >
              <div *ngIf="employeeEditForm.get('insuranceNumber')?.invalid && employeeEditForm.get('insuranceNumber')?.touched" class="error-message">
                被保険者番号を入力してください（3桁の数字）
              </div>
            </div>
            <div class="form-group">
              <label for="hr-insuranceCardIssueDate">発行日</label>
              <input 
                type="date" 
                id="hr-insuranceCardIssueDate" 
                formControlName="insuranceCardIssueDate" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="hr-insuranceCardReturnDate">回収日</label>
              <input 
                type="date" 
                id="hr-insuranceCardReturnDate" 
                formControlName="insuranceCardReturnDate" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="hr-insuranceCardStatus">配布状況</label>
              <select 
                id="hr-insuranceCardStatus" 
                formControlName="insuranceCardStatus" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option *ngFor="let status of insuranceCardStatuses" [value]="status">
                  {{ status }}
                </option>
              </select>
            </div>
          </div>
        </section>

        <!-- 送信ボタン -->
        <div class="modal-actions">
          <button type="button" class="cancel-button" (click)="closeEmployeeEditModal()">
            キャンセル
          </button>
          <button type="submit" class="submit-button" [disabled]="employeeEditForm.invalid || isSaving">
            {{ isSaving ? '保存中...' : '保存' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- 申請詳細モーダル（人事側） -->
<div class="modal-overlay" *ngIf="showApplicationDetailModal">
  <div class="modal-content application-detail-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">申請詳細</h2>
      <button class="modal-close-button" (click)="closeApplicationDetailModal()">×</button>
    </div>
    
    <div class="application-detail-content" *ngIf="selectedApplication">
      <!-- ステータス変更欄 -->
      <section class="status-change-section-top" *ngIf="statusChangeForm">
        <h3 class="section-title">ステータス変更</h3>
        <form [formGroup]="statusChangeForm" (ngSubmit)="updateApplicationStatus()">
          <div class="status-change-form">
            <div class="form-group">
              <label for="statusSelect">ステータス <span class="required">*</span></label>
              <select 
                id="statusSelect" 
                formControlName="status" 
                class="form-input status-select"
                (change)="onStatusChange()"
              >
                <option value="承認待ち">承認待ち</option>
                <option value="確認中">確認中</option>
                <option value="承認済み">承認済み</option>
                <option value="差し戻し">差し戻し</option>
                <option value="再申請">再申請</option>
              </select>
            </div>
            <div class="form-group" *ngIf="statusChangeForm.get('status')?.value === '差し戻し'">
              <label for="statusComment">コメント <span class="required">*</span></label>
              <textarea 
                id="statusComment" 
                formControlName="comment" 
                class="form-input status-comment"
                rows="4"
                placeholder="差し戻し理由を入力してください"
              ></textarea>
              <div *ngIf="statusChangeForm.get('comment')?.invalid && statusChangeForm.get('comment')?.touched" class="error-message">
                コメントを入力してください
              </div>
            </div>
            
            <!-- 文書自動作成欄（承認済みの場合のみ表示） -->
            <div class="document-auto-generation-section" *ngIf="statusChangeForm.get('status')?.value === '承認済み' && availableDocuments.length > 0">
              <h4 class="document-section-title">対応する文書を自動作成</h4>
              <div class="document-checkboxes">
                <label *ngFor="let doc of availableDocuments" class="document-checkbox-label">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="documentCheckboxes[doc]"
                    [ngModelOptions]="{standalone: true}"
                    class="document-checkbox"
                  >
                  <span class="document-name">{{ doc }}</span>
                </label>
              </div>
              <p class="document-note">
                チェックが入った文書は、ステータスを更新すると自動でダウンロードされます。
              </p>
            </div>
            
            <div class="status-change-actions">
              <button type="submit" class="status-update-button">ステータスを更新</button>
            </div>
          </div>
        </form>
      </section>
      
      <!-- 申請基本情報 -->
      <section class="detail-section">
        <h3 class="section-title">申請基本情報</h3>
        <div class="detail-grid">
          <div class="detail-item">
            <span class="detail-label">申請ID:</span>
            <span class="detail-value">{{ selectedApplication.applicationId }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">申請種類:</span>
            <span class="detail-value">{{ selectedApplication.applicationType }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">申請者:</span>
            <span class="detail-value">{{ selectedApplication.employeeName || '-' }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">社員番号:</span>
            <span class="detail-value">{{ selectedApplication.employeeNumber || '-' }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">ステータス:</span>
            <span class="detail-value">
              <span class="status-badge" 
                    [class.status-pending]="selectedApplication.status === '承認待ち'"
                    [class.status-reviewing]="selectedApplication.status === '確認中'"
                    [class.status-approved]="selectedApplication.status === '承認' || selectedApplication.status === '承認済み'"
                    [class.status-rejected]="selectedApplication.status === '却下' || selectedApplication.status === '差し戻し'"
                    [class.status-resubmitted]="selectedApplication.status === '再申請' || selectedApplication.status === '再提出'">
                {{ selectedApplication.status }}
              </span>
            </span>
          </div>
          <div class="detail-item full-width" *ngIf="selectedApplication.status === '差し戻し' && selectedApplication.statusComment">
            <span class="detail-label">差し戻しコメント:</span>
            <span class="detail-value">{{ selectedApplication.statusComment }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">申請日:</span>
            <span class="detail-value">{{ getApplicationDate(selectedApplication) | date:'yyyy年MM月dd日' }}</span>
          </div>
        </div>
      </section>
      
      <!-- 扶養家族追加申請の詳細 -->
      <ng-container *ngIf="selectedApplication.applicationType === '扶養家族追加'">
        <!-- 続柄情報 -->
        <section class="detail-section">
          <h3 class="section-title">続柄</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">続柄種別:</span>
              <span class="detail-value">{{ selectedApplication.relationshipType || '-' }}</span>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.relationshipType === '配偶者'">
              <span class="detail-label">配偶者種別:</span>
              <span class="detail-value">{{ selectedApplication.spouseType || '-' }}</span>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.relationshipType === '配偶者以外'">
              <span class="detail-label">続柄:</span>
              <span class="detail-value">{{ selectedApplication.relationship || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 基礎年金番号 -->
        <section class="detail-section">
          <h3 class="section-title">基礎年金番号</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">基礎年金番号:</span>
              <span class="detail-value">{{ formatBasicPensionNumberForDisplay(selectedApplication.basicPensionNumber) }}</span>
            </div>
          </div>
        </section>
        
        <!-- 基本情報 -->
        <section class="detail-section">
          <h3 class="section-title">基本情報</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">姓:</span>
              <span class="detail-value">{{ selectedApplication.lastName || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">名:</span>
              <span class="detail-value">{{ selectedApplication.firstName || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">姓（ヨミガナ）:</span>
              <span class="detail-value">{{ selectedApplication.lastNameKana || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">名（ヨミガナ）:</span>
              <span class="detail-value">{{ selectedApplication.firstNameKana || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">生年月日:</span>
              <span class="detail-value">{{ selectedApplication.birthDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">性別:</span>
              <span class="detail-value">{{ selectedApplication.gender || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">電話番号:</span>
              <span class="detail-value">{{ selectedApplication.phoneNumber || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">職業:</span>
              <span class="detail-value">{{ selectedApplication.occupation || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 収入情報 -->
        <section class="detail-section">
          <h3 class="section-title">収入情報</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">扶養追加日からの年間収入見込み額:</span>
              <span class="detail-value">{{ selectedApplication.annualIncome ? (selectedApplication.annualIncome | number:'1.0-0') + '円' : '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">扶養追加日からの月額収入見込み額:</span>
              <span class="detail-value">{{ selectedApplication.monthlyIncome ? (selectedApplication.monthlyIncome | number:'1.0-0') + '円' : '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">社会保険の扶養者となった日:</span>
              <span class="detail-value">{{ selectedApplication.dependentStartDate || '-' }}</span>
            </div>
            <div class="detail-item full-width">
              <span class="detail-label">扶養に追加された理由:</span>
              <span class="detail-value">{{ selectedApplication.dependentReason || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- マイナンバー情報 -->
        <section class="detail-section">
          <h3 class="section-title">マイナンバー</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">マイナンバーの提供:</span>
              <span class="detail-value">{{ selectedApplication.provideMyNumber || '-' }}</span>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.provideMyNumber === '提供する'">
              <span class="detail-label">マイナンバー:</span>
              <span class="detail-value">{{ formatMyNumberForDisplay(selectedApplication.myNumber) }}</span>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.provideMyNumber === '提供しない'">
              <span class="detail-label">未提供理由:</span>
              <span class="detail-value">{{ selectedApplication.myNumberNotProvidedReason || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 障がい者情報 -->
        <section class="detail-section" *ngIf="selectedApplication.disabilityCategory || selectedApplication.disabilityCardType || selectedApplication.disabilityCardIssueDate">
          <h3 class="section-title">障がい者情報</h3>
          <div class="detail-grid">
            <div class="detail-item" *ngIf="selectedApplication.disabilityCategory">
              <span class="detail-label">障がい者区分:</span>
              <span class="detail-value">{{ selectedApplication.disabilityCategory }}</span>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.disabilityCardType">
              <span class="detail-label">障がい者手帳の種類:</span>
              <span class="detail-value">{{ selectedApplication.disabilityCardType }}</span>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.disabilityCardIssueDate">
              <span class="detail-label">障がい者手帳の交付年月日:</span>
              <span class="detail-value">{{ selectedApplication.disabilityCardIssueDate }}</span>
            </div>
          </div>
        </section>
        
        <!-- 住所情報 -->
        <section class="detail-section">
          <h3 class="section-title">住所情報</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">同居/別居:</span>
              <span class="detail-value">{{ selectedApplication.livingTogether || '-' }}</span>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.livingTogether === '別居'">
              <span class="detail-label">郵便番号:</span>
              <span class="detail-value">{{ selectedApplication.postalCode || '-' }}</span>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.livingTogether === '別居'">
              <span class="detail-label">住所:</span>
              <span class="detail-value">{{ selectedApplication.address || '-' }}</span>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.livingTogether === '別居'">
              <span class="detail-label">住所（ヨミガナ）:</span>
              <span class="detail-value">{{ selectedApplication.addressKana || '-' }}</span>
            </div>
            <div class="detail-item" *ngIf="selectedApplication.livingTogether === '別居'">
              <span class="detail-label">住所変更年月日:</span>
              <span class="detail-value">{{ selectedApplication.addressChangeDate || '-' }}</span>
            </div>
          </div>
        </section>
      </ng-container>
      
      <!-- 扶養削除申請の詳細 -->
      <ng-container *ngIf="selectedApplication.applicationType === '扶養削除申請'">
        <!-- 被扶養者移動日 -->
        <section class="detail-section">
          <h3 class="section-title">被扶養者移動日</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">被扶養者移動日:</span>
              <span class="detail-value">{{ selectedApplication.removalDate || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 扶養削除の理由 -->
        <section class="detail-section">
          <h3 class="section-title">扶養削除の理由</h3>
          <div class="detail-grid">
            <div class="detail-item full-width">
              <span class="detail-label">扶養削除の理由:</span>
              <span class="detail-value">{{ selectedApplication.removalReason || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 被扶養者情報 -->
        <section class="detail-section" *ngIf="selectedApplication.dependent">
          <h3 class="section-title">被扶養者情報</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">氏名:</span>
              <span class="detail-value">{{ selectedApplication.dependent.name || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">氏名（ヨミガナ）:</span>
              <span class="detail-value">{{ selectedApplication.dependent.nameKana || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">続柄:</span>
              <span class="detail-value">{{ selectedApplication.dependent.relationship || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">生年月日:</span>
              <span class="detail-value">{{ selectedApplication.dependent.birthDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">マイナンバー:</span>
              <span class="detail-value">{{ selectedApplication.dependent.myNumber ? '●●●●-●●●●-●●●●' : '-' }}</span>
            </div>
            <div class="detail-item full-width">
              <span class="detail-label">住所:</span>
              <span class="detail-value">{{ selectedApplication.dependent.address || '-' }}</span>
            </div>
            <div class="detail-item full-width" *ngIf="selectedApplication.dependent.notes">
              <span class="detail-label">備考:</span>
              <span class="detail-value">{{ selectedApplication.dependent.notes }}</span>
            </div>
          </div>
        </section>
      </ng-container>
      
      <!-- 住所変更申請の詳細 -->
      <ng-container *ngIf="selectedApplication.applicationType === '住所変更申請'">
        <!-- 引っ越しした日 -->
        <section class="detail-section">
          <h3 class="section-title">引っ越しした日</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">引っ越しした日:</span>
              <span class="detail-value">{{ selectedApplication.moveDate || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 新しい住所 -->
        <section class="detail-section" *ngIf="selectedApplication.newAddress">
          <h3 class="section-title">新しい住所</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">郵便番号:</span>
              <span class="detail-value">{{ selectedApplication.newAddress.postalCode || '-' }}</span>
            </div>
            <div class="detail-item full-width">
              <span class="detail-label">住所:</span>
              <span class="detail-value">{{ selectedApplication.newAddress.address || '-' }}</span>
            </div>
            <div class="detail-item full-width">
              <span class="detail-label">住所（ヨミガナ）:</span>
              <span class="detail-value">{{ selectedApplication.newAddress.addressKana || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">世帯主の続柄（本人/親族）:</span>
              <span class="detail-value">{{ selectedApplication.newAddress.householdHead || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">世帯主氏名:</span>
              <span class="detail-value">{{ selectedApplication.newAddress.householdHeadName || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 新しい住民票住所 -->
        <section class="detail-section" *ngIf="selectedApplication.residentAddress">
          <h3 class="section-title">新しい住民票住所</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">変更前住所と同じ:</span>
              <span class="detail-value">{{ selectedApplication.residentAddress.sameAsOldAddress ? 'はい' : 'いいえ' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">変更後の住所と同じ:</span>
              <span class="detail-value">{{ selectedApplication.residentAddress.sameAsNewAddress ? 'はい' : 'いいえ' }}</span>
            </div>
            <div class="detail-item" *ngIf="!selectedApplication.residentAddress.sameAsOldAddress && !selectedApplication.residentAddress.sameAsNewAddress">
              <span class="detail-label">郵便番号:</span>
              <span class="detail-value">{{ selectedApplication.residentAddress.postalCode || '-' }}</span>
            </div>
            <div class="detail-item full-width" *ngIf="!selectedApplication.residentAddress.sameAsOldAddress && !selectedApplication.residentAddress.sameAsNewAddress">
              <span class="detail-label">住所:</span>
              <span class="detail-value">{{ selectedApplication.residentAddress.address || '-' }}</span>
            </div>
            <div class="detail-item full-width" *ngIf="!selectedApplication.residentAddress.sameAsOldAddress && !selectedApplication.residentAddress.sameAsNewAddress">
              <span class="detail-label">住所（ヨミガナ）:</span>
              <span class="detail-value">{{ selectedApplication.residentAddress.addressKana || '-' }}</span>
            </div>
            <div class="detail-item" *ngIf="!selectedApplication.residentAddress.sameAsOldAddress && !selectedApplication.residentAddress.sameAsNewAddress">
              <span class="detail-label">世帯主の続柄（本人/親族）:</span>
              <span class="detail-value">{{ selectedApplication.residentAddress.householdHead || '-' }}</span>
            </div>
            <div class="detail-item" *ngIf="!selectedApplication.residentAddress.sameAsOldAddress && !selectedApplication.residentAddress.sameAsNewAddress">
              <span class="detail-label">世帯主氏名:</span>
              <span class="detail-value">{{ selectedApplication.residentAddress.householdHeadName || '-' }}</span>
            </div>
          </div>
        </section>
      </ng-container>
      
      <!-- 氏名変更申請の詳細 -->
      <ng-container *ngIf="selectedApplication.applicationType === '氏名変更申請'">
        <!-- 氏名変更した日 -->
        <section class="detail-section">
          <h3 class="section-title">氏名変更した日</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">氏名変更した日:</span>
              <span class="detail-value">{{ selectedApplication.changeDate || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 新しい氏名 -->
        <section class="detail-section" *ngIf="selectedApplication.newName">
          <h3 class="section-title">新しい氏名</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">姓:</span>
              <span class="detail-value">{{ selectedApplication.newName.lastName || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">名:</span>
              <span class="detail-value">{{ selectedApplication.newName.firstName || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">姓（ヨミガナ）:</span>
              <span class="detail-value">{{ selectedApplication.newName.lastNameKana || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">名（ヨミガナ）:</span>
              <span class="detail-value">{{ selectedApplication.newName.firstNameKana || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 本人確認書類 -->
        <section class="detail-section">
          <h3 class="section-title">本人確認書類</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">本人確認書類添付:</span>
              <span class="detail-value">{{ selectedApplication.hasIdDocument ? 'あり' : 'なし' }}</span>
            </div>
          </div>
        </section>
      </ng-container>
      
      <!-- 産前産後休業申請の詳細 -->
      <ng-container *ngIf="selectedApplication.applicationType === '産前産後休業申請'">
        <!-- 出産予定日 -->
        <section class="detail-section">
          <h3 class="section-title">出産予定日</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">出産予定日:</span>
              <span class="detail-value">{{ selectedApplication.expectedDeliveryDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">双子以上か:</span>
              <span class="detail-value">{{ selectedApplication.isMultipleBirth || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">出産予定日を確認できる書類添付:</span>
              <span class="detail-value">{{ selectedApplication.hasDocument ? 'あり' : 'なし' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 産前休業期間 -->
        <section class="detail-section">
          <h3 class="section-title">産前休業期間</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">産前休業開始日:</span>
              <span class="detail-value">{{ selectedApplication.preMaternityLeaveStartDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">産前休業終了日:</span>
              <span class="detail-value">{{ selectedApplication.preMaternityLeaveEndDate || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 産後休業期間 -->
        <section class="detail-section">
          <h3 class="section-title">産後休業期間</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">産後休業開始日:</span>
              <span class="detail-value">{{ selectedApplication.postMaternityLeaveStartDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">産後休業終了日:</span>
              <span class="detail-value">{{ selectedApplication.postMaternityLeaveEndDate || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 休業中の滞在先 -->
        <section class="detail-section" *ngIf="selectedApplication.stayAddress">
          <h3 class="section-title">休業中の滞在先</h3>
          <div class="detail-grid">
            <div class="detail-item full-width">
              <span class="detail-label">休業中の滞在先（現住所と異なる場合）:</span>
              <span class="detail-value">{{ selectedApplication.stayAddress }}</span>
            </div>
          </div>
        </section>
      </ng-container>
      
      <!-- 退職申請の詳細 -->
      <ng-container *ngIf="selectedApplication.applicationType === '退職申請'">
        <!-- 退職日・最終出社日 -->
        <section class="detail-section">
          <h3 class="section-title">退職情報</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">退職日:</span>
              <span class="detail-value">{{ selectedApplication.resignationDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">最終出社日:</span>
              <span class="detail-value">{{ selectedApplication.lastWorkDate || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">離職票の発行について:</span>
              <span class="detail-value">{{ selectedApplication.resignationCertificatePreference || selectedApplication.separationNotice || '-' }}</span>
            </div>
            <div class="detail-item full-width">
              <span class="detail-label">退職理由:</span>
              <span class="detail-value">{{ selectedApplication.resignationReason || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 退職後の連絡先 -->
        <section class="detail-section">
          <h3 class="section-title">退職後の連絡先</h3>
          <div class="detail-grid">
            <div class="detail-item full-width">
              <span class="detail-label">退職後の住所:</span>
              <span class="detail-value">{{ selectedApplication.postResignationAddress || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">退職後の電話番号:</span>
              <span class="detail-value">{{ selectedApplication.postResignationPhoneNumber || selectedApplication.postResignationPhone || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">退職後のメールアドレス:</span>
              <span class="detail-value">{{ selectedApplication.postResignationEmail || '-' }}</span>
            </div>
          </div>
        </section>
        
        <!-- 退職後の社会保険加入 -->
        <section class="detail-section">
          <h3 class="section-title">退職後の社会保険加入</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">退職後の社会保険加入:</span>
              <span class="detail-value">{{ selectedApplication.postResignationSocialInsurance || selectedApplication.postResignationInsurance || '-' }}</span>
            </div>
          </div>
        </section>
      </ng-container>
      
      <!-- 保険証再発行申請の詳細 -->
      <ng-container *ngIf="selectedApplication.applicationType === '保険証再発行申請'">
        <!-- 紛失情報 -->
        <section class="detail-section">
          <h3 class="section-title">紛失情報</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">紛失した日付:</span>
              <span class="detail-value">{{ selectedApplication.lostDate || '-' }}</span>
            </div>
            <div class="detail-item full-width">
              <span class="detail-label">どこで失くしたか:</span>
              <span class="detail-value">{{ selectedApplication.lostLocation || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">盗難の可能性:</span>
              <span class="detail-value">{{ selectedApplication.theftPossibility || '-' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">保険証再発行までに通院する予定があるか:</span>
              <span class="detail-value">{{ selectedApplication.hasMedicalAppointment || '-' }}</span>
            </div>
          </div>
        </section>
      </ng-container>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="close-detail-button" (click)="closeApplicationDetailModal()">閉じる</button>
    </div>
  </div>
</div>

<!-- 新入社員詳細モーダル -->
<div *ngIf="showOnboardingEmployeeModal" class="modal-overlay" (click)="closeOnboardingEmployeeModal()">
  <div class="modal-content employee-edit-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">新入社員詳細情報</h3>
      <button class="modal-close" (click)="closeOnboardingEmployeeModal()">×</button>
    </div>
    
    <form [formGroup]="onboardingEmployeeEditForm" (ngSubmit)="saveOnboardingEmployeeData()" class="employee-edit-form">
      <!-- ステータス変更欄（一番上） -->
      <section class="form-section">
        <h3 class="section-title">ステータス変更</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-status">ステータス</label>
            <select 
              id="onboarding-status"
              class="form-input"
              [(ngModel)]="selectedOnboardingEmployee.status"
              [ngModelOptions]="{standalone: true}"
              (change)="onOnboardingStatusChange($event)"
            >
              <option value="申請待ち">申請待ち</option>
              <option value="申請済み">申請済み</option>
              <option value="差し戻し">差し戻し</option>
              <option value="準備完了">準備完了</option>
            </select>
          </div>
          <div class="form-group full-width" *ngIf="selectedOnboardingEmployee?.status === '差し戻し'">
            <label for="onboarding-statusComment">コメント（差し戻しの場合）</label>
            <textarea 
              id="onboarding-statusComment"
              class="form-input"
              [(ngModel)]="onboardingStatusComment"
              [ngModelOptions]="{standalone: true}"
              placeholder="差し戻し理由などを入力してください"
              rows="3"
            ></textarea>
          </div>
        </div>
        <div class="form-actions">
          <button 
            type="button" 
            class="status-button status-update"
            (click)="updateOnboardingEmployeeStatus(selectedOnboardingEmployee.status)"
          >
            ステータスを更新
          </button>
        </div>
      </section>

      <!-- 基本情報欄 -->
      <section class="form-section">
        <h3 class="section-title">基本情報</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-name">氏名 <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-name" 
              formControlName="name" 
              class="form-input"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-nameKana">氏名（ヨミガナ）</label>
            <input 
              type="text" 
              id="onboarding-nameKana" 
              formControlName="nameKana" 
              class="form-input"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-birthDate">生年月日 <span class="required">*</span></label>
            <div class="birth-date-container">
              <input 
                type="date" 
                id="onboarding-birthDate" 
                formControlName="birthDate" 
                class="form-input"
                (change)="onOnboardingBirthDateChange()"
              >
              <span *ngIf="onboardingAge !== null" class="age-display">（{{ onboardingAge }}歳）</span>
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-gender">戸籍上の性別 <span class="required">*</span></label>
            <select 
              id="onboarding-gender" 
              formControlName="gender" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let g of genders" [value]="g">{{ g }}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="onboarding-email">メールアドレス <span class="required">*</span></label>
            <input 
              type="email" 
              id="onboarding-email" 
              formControlName="email" 
              class="form-input"
            >
          </div>
          <div class="form-group full-width">
            <label for="onboarding-idDocument">本人確認書類添付</label>
            <input 
              type="file" 
              id="onboarding-idDocument" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'idDocument')"
            >
            <div *ngIf="idDocumentFile" class="file-name">{{ idDocumentFile.name }}</div>
          </div>
        </div>
      </section>

      <!-- マイナンバー欄 -->
      <section class="form-section">
        <h3 class="section-title">マイナンバー</h3>
        <div class="form-grid">
          <div class="form-group full-width">
            <label for="onboarding-myNumberPart1">マイナンバー <span class="required">*</span></label>
            <div class="my-number-container">
              <div class="my-number-inputs">
                <input 
                  type="text" 
                  id="onboarding-myNumberPart1" 
                  formControlName="myNumberPart1" 
                  class="form-input my-number-part"
                  [type]="onboardingShowMyNumber ? 'text' : 'password'"
                  [readonly]="!onboardingShowMyNumber"
                  maxlength="4"
                  (input)="formatMyNumberInput($event, 1)"
                  placeholder="0000"
                >
                <span class="my-number-separator">-</span>
                <input 
                  type="text" 
                  id="onboarding-myNumberPart2" 
                  formControlName="myNumberPart2" 
                  class="form-input my-number-part"
                  [type]="onboardingShowMyNumber ? 'text' : 'password'"
                  [readonly]="!onboardingShowMyNumber"
                  maxlength="4"
                  (input)="formatMyNumberInput($event, 2)"
                  placeholder="0000"
                >
                <span class="my-number-separator">-</span>
                <input 
                  type="text" 
                  id="onboarding-myNumberPart3" 
                  formControlName="myNumberPart3" 
                  class="form-input my-number-part"
                  [type]="onboardingShowMyNumber ? 'text' : 'password'"
                  [readonly]="!onboardingShowMyNumber"
                  maxlength="4"
                  (input)="formatMyNumberInput($event, 3)"
                  placeholder="0000"
                >
              </div>
              <button 
                type="button" 
                class="toggle-button" 
                (click)="toggleOnboardingMyNumber()"
              >
                {{ onboardingShowMyNumber ? '非表示' : '表示' }}
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- 入退社情報（人事専用）欄 -->
      <section class="form-section hr-only-section">
        <h3 class="section-title">入退社情報（人事専用）</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-employmentStatus">在籍状況 <span class="required">*</span></label>
            <select 
              id="onboarding-employmentStatus" 
              formControlName="employmentStatus" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let status of employmentStatuses" [value]="status">{{ status }}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="onboarding-joinDate">入社年月日 <span class="required">*</span></label>
            <input 
              type="date" 
              id="onboarding-joinDate" 
              formControlName="joinDate" 
              class="form-input"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-resignationDate">退職年月日</label>
            <input 
              type="date" 
              id="onboarding-resignationDate" 
              formControlName="resignationDate" 
              class="form-input"
            >
          </div>
          <div class="form-group full-width">
            <label for="onboarding-resignationReason">退職事由</label>
            <textarea 
              id="onboarding-resignationReason" 
              formControlName="resignationReason" 
              class="form-input" 
              rows="3"
            ></textarea>
          </div>
        </div>
      </section>

      <!-- 業務情報（人事専用）欄 -->
      <section class="form-section hr-only-section">
        <h3 class="section-title">業務情報（人事専用）</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-employeeNumber">社員番号 <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-employeeNumber" 
              formControlName="employeeNumber" 
              class="form-input"
              [readonly]="true"
              style="background: #f5f5f5;"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-office">事業所</label>
            <select 
              id="onboarding-office" 
              formControlName="office" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let office of offices" [value]="office">{{ office }}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="onboarding-workContent">業務内容</label>
            <select 
              id="onboarding-workContent" 
              formControlName="workContent" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let content of workContents" [value]="content">{{ content }}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="onboarding-employmentType">雇用形態</label>
            <select 
              id="onboarding-employmentType" 
              formControlName="employmentType" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let type of employmentTypes" [value]="type">{{ type }}</option>
            </select>
          </div>
        </div>
      </section>

      <!-- 部署・役職情報（人事専用） -->
      <section class="form-section hr-only-section">
        <h3 class="section-title">部署・役職情報（人事専用）</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-department">部署</label>
            <select 
              id="onboarding-department" 
              formControlName="department" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="onboarding-position">役職</label>
            <select 
              id="onboarding-position" 
              formControlName="position" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let pos of positions" [value]="pos">{{ pos }}</option>
            </select>
          </div>
        </div>
      </section>

      <!-- 現住所と連絡先欄 -->
      <section class="form-section">
        <h3 class="section-title">現住所と連絡先</h3>
        <div class="form-grid">
          <div class="form-group full-width">
            <label for="onboarding-currentAddress">現住所</label>
            <textarea 
              id="onboarding-currentAddress" 
              formControlName="currentAddress" 
              class="form-input" 
              rows="2"
            ></textarea>
          </div>
          <div class="form-group full-width">
            <label for="onboarding-currentAddressKana">現住所（ヨミガナ）</label>
            <textarea 
              id="onboarding-currentAddressKana" 
              formControlName="currentAddressKana" 
              class="form-input" 
              rows="2"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="onboarding-phoneNumber">電話番号</label>
            <input 
              type="tel" 
              id="onboarding-phoneNumber" 
              formControlName="phoneNumber" 
              class="form-input"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-currentHouseholdHead">世帯主（本人/親族）</label>
            <select 
              id="onboarding-currentHouseholdHead" 
              formControlName="currentHouseholdHead" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let type of householdHeadTypes" [value]="type">{{ type }}</option>
            </select>
          </div>
        </div>
      </section>

      <!-- 住民票住所欄 -->
      <section class="form-section">
        <h3 class="section-title">住民票住所</h3>
        <div class="form-grid">
          <div class="form-group full-width">
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                [checked]="onboardingSameAsCurrentAddress" 
                (change)="onOnboardingSameAddressChange($event)"
              >
              住所（現住所と同じ）
            </label>
          </div>
          <div class="form-group full-width">
            <label for="onboarding-residentAddress">住所</label>
            <textarea 
              id="onboarding-residentAddress" 
              formControlName="residentAddress" 
              class="form-input" 
              rows="2"
              [readonly]="onboardingSameAsCurrentAddress"
            ></textarea>
          </div>
          <div class="form-group full-width">
            <label for="onboarding-residentAddressKana">住所（ヨミガナ）</label>
            <textarea 
              id="onboarding-residentAddressKana" 
              formControlName="residentAddressKana" 
              class="form-input" 
              rows="2"
              [readonly]="onboardingSameAsCurrentAddress"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="onboarding-residentHouseholdHead">世帯主（本人/親族）</label>
            <select 
              id="onboarding-residentHouseholdHead" 
              formControlName="residentHouseholdHead" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let type of householdHeadTypes" [value]="type">{{ type }}</option>
            </select>
          </div>
        </div>
      </section>

      <!-- 履歴書・職務経歴書欄 -->
      <section class="form-section">
        <h3 class="section-title">履歴書・職務経歴書</h3>
        <div class="form-grid">
          <div class="form-group full-width">
            <label for="onboarding-resume">履歴書添付</label>
            <input 
              type="file" 
              id="onboarding-resume" 
              class="form-input"
              accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'resume')"
            >
            <div *ngIf="resumeFile" class="file-name">{{ resumeFile.name }}</div>
          </div>
          <div class="form-group full-width">
            <label for="onboarding-careerHistory">職務経歴書添付</label>
            <input 
              type="file" 
              id="onboarding-careerHistory" 
              class="form-input"
              accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'careerHistory')"
            >
            <div *ngIf="careerHistoryFile" class="file-name">{{ careerHistoryFile.name }}</div>
          </div>
        </div>
      </section>

      <!-- 緊急連絡先欄 -->
      <section class="form-section">
        <h3 class="section-title">緊急連絡先</h3>
        <div formGroupName="emergencyContact" class="nested-form">
          <div class="form-grid">
            <div class="form-group">
              <label for="onboarding-emergencyName">氏名</label>
              <input 
                type="text" 
                id="onboarding-emergencyName" 
                formControlName="name" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-emergencyNameKana">氏名（ヨミガナ）</label>
              <input 
                type="text" 
                id="onboarding-emergencyNameKana" 
                formControlName="nameKana" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-emergencyRelationship">続柄</label>
              <input 
                type="text" 
                id="onboarding-emergencyRelationship" 
                formControlName="relationship" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-emergencyPhone">緊急連絡先電話番号</label>
              <input 
                type="tel" 
                id="onboarding-emergencyPhone" 
                formControlName="phone" 
                class="form-input"
              >
            </div>
            <div class="form-group full-width">
              <label>
                <input 
                  type="checkbox" 
                  [checked]="onboardingSameAsCurrentAddressForEmergency"
                  (change)="onOnboardingSameAddressForEmergencyChange($event)"
                  class="checkbox-input"
                >
                現住所と同じ
              </label>
            </div>
            <div class="form-group full-width">
              <label for="onboarding-emergencyAddress">住所</label>
              <textarea 
                id="onboarding-emergencyAddress" 
                formControlName="address" 
                class="form-input" 
                rows="2"
                [readonly]="onboardingSameAsCurrentAddressForEmergency"
              ></textarea>
            </div>
            <div class="form-group full-width">
              <label for="onboarding-emergencyAddressKana">住所（ヨミガナ）</label>
              <textarea 
                id="onboarding-emergencyAddressKana" 
                formControlName="addressKana" 
                class="form-input" 
                rows="2"
                [readonly]="onboardingSameAsCurrentAddressForEmergency"
              ></textarea>
            </div>
          </div>
        </div>
      </section>

      <!-- 口座情報欄 -->
      <section class="form-section">
        <h3 class="section-title">口座情報</h3>
        <div formGroupName="bankAccount" class="nested-form">
          <div class="form-grid">
            <div class="form-group">
              <label for="onboarding-bankName">銀行名</label>
              <input 
                type="text" 
                id="onboarding-bankName" 
                formControlName="bankName" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-accountType">預金種別</label>
              <select 
                id="onboarding-accountType" 
                formControlName="accountType" 
                class="form-input"
              >
                <option value="">選択してください</option>
                <option value="普通">普通</option>
                <option value="当座">当座</option>
                <option value="貯蓄">貯蓄</option>
              </select>
            </div>
            <div class="form-group">
              <label for="onboarding-accountHolder">名義（カタカナ）</label>
              <input 
                type="text" 
                id="onboarding-accountHolder" 
                formControlName="accountHolder" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-branchName">支店名</label>
              <input 
                type="text" 
                id="onboarding-branchName" 
                formControlName="branchName" 
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label for="onboarding-accountNumber">口座番号</label>
              <input 
                type="text" 
                id="onboarding-accountNumber" 
                formControlName="accountNumber" 
                class="form-input"
              >
            </div>
          </div>
        </div>
      </section>

      <!-- 社会保険（人事専用）欄 -->
      <section class="form-section hr-only-section">
        <h3 class="section-title">社会保険（人事専用）</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-healthInsuranceNumber">健康保険の被保険者整理番号</label>
            <input 
              type="text" 
              id="onboarding-healthInsuranceNumber" 
              formControlName="healthInsuranceNumber" 
              class="form-input"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-pensionInsuranceNumber">厚生年金保険の被保険者整理番号</label>
            <input 
              type="text" 
              id="onboarding-pensionInsuranceNumber" 
              formControlName="pensionInsuranceNumber" 
              class="form-input"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-basicPensionNumberPart1">基礎年金番号</label>
            <div class="basic-pension-number-container">
              <input 
                type="text" 
                id="onboarding-basicPensionNumberPart1" 
                formControlName="basicPensionNumberPart1" 
                class="form-input basic-pension-part"
                maxlength="4"
                (input)="formatBasicPensionNumberInput($event, 1)"
                placeholder="0000"
              >
              <span class="basic-pension-separator">-</span>
              <input 
                type="text" 
                id="onboarding-basicPensionNumberPart2" 
                formControlName="basicPensionNumberPart2" 
                class="form-input basic-pension-part"
                maxlength="6"
                (input)="formatBasicPensionNumberInput($event, 2)"
                placeholder="000000"
              >
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-pensionHistoryStatus">厚生年金加入履歴</label>
            <select 
              id="onboarding-pensionHistoryStatus" 
              formControlName="pensionHistoryStatus" 
              class="form-input" 
              (change)="onOnboardingPensionHistoryChange($event)"
            >
              <option value="">選択してください</option>
              <option *ngFor="let option of pensionHistoryOptions" [value]="option">{{ option }}</option>
            </select>
          </div>
          <div class="form-group full-width" *ngIf="onboardingHasPensionHistory">
            <label for="onboarding-pensionHistory">厚生年金加入履歴（詳細）</label>
            <textarea 
              id="onboarding-pensionHistory" 
              formControlName="pensionHistory" 
              class="form-input" 
              rows="4"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="onboarding-socialInsuranceAcquisitionDate">社会保険の資格取得年月日 <span class="required">*</span></label>
            <input 
              type="date" 
              id="onboarding-socialInsuranceAcquisitionDate" 
              formControlName="socialInsuranceAcquisitionDate" 
              class="form-input"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-socialInsuranceLossDate">社会保険の資格喪失年月日</label>
            <input 
              type="date" 
              id="onboarding-socialInsuranceLossDate" 
              formControlName="socialInsuranceLossDate" 
              class="form-input"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-expectedMonthlySalary">見込み月給額（給与） <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-expectedMonthlySalary" 
              formControlName="expectedMonthlySalary" 
              class="form-input"
              (input)="formatNumericInput($event, 'expectedMonthlySalary')"
              placeholder="例: 300000"
            >
            <div *ngIf="onboardingEmployeeEditForm.get('expectedMonthlySalary')?.invalid && onboardingEmployeeEditForm.get('expectedMonthlySalary')?.touched" class="error-message">
              見込み月給額（給与）は必須です
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-expectedMonthlySalaryInKind">見込み月給額（現物） <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-expectedMonthlySalaryInKind" 
              formControlName="expectedMonthlySalaryInKind" 
              class="form-input"
              (input)="formatNumericInput($event, 'expectedMonthlySalaryInKind')"
              placeholder="例: 50000"
            >
            <div *ngIf="onboardingEmployeeEditForm.get('expectedMonthlySalaryInKind')?.invalid && onboardingEmployeeEditForm.get('expectedMonthlySalaryInKind')?.touched" class="error-message">
              見込み月給額（現物）は必須です
            </div>
          </div>
          <div class="form-group full-width">
            <label for="onboarding-basicPensionNumberDoc">基礎年金番号確認書類添付</label>
            <input 
              type="file" 
              id="onboarding-basicPensionNumberDoc" 
              class="form-input"
              accept=".pdf,.jpg,.jpeg,.png"
              (change)="onFileSelected($event, 'basicPensionNumberDoc')"
            >
            <div *ngIf="basicPensionNumberDocFile" class="file-name">{{ basicPensionNumberDocFile.name }}</div>
          </div>
        </div>
      </section>

      <!-- 保険証情報（人事専用）欄 -->
      <section class="form-section hr-only-section">
        <h3 class="section-title">保険証情報（人事専用）</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="onboarding-insuranceSymbol">被保険者記号 <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-insuranceSymbol" 
              formControlName="insuranceSymbol" 
              class="form-input"
              maxlength="8"
              pattern="[0-9]*"
              (input)="formatInsuranceSymbolInput($event)"
              placeholder="00000000"
            >
            <div *ngIf="onboardingEmployeeEditForm.get('insuranceSymbol')?.invalid && onboardingEmployeeEditForm.get('insuranceSymbol')?.touched" class="error-message">
              <span *ngIf="onboardingEmployeeEditForm.get('insuranceSymbol')?.errors?.['required']">被保険者記号を入力してください</span>
              <span *ngIf="onboardingEmployeeEditForm.get('insuranceSymbol')?.errors?.['pattern']">8桁の数字を入力してください</span>
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-insuranceNumber">被保険者番号 <span class="required">*</span></label>
            <input 
              type="text" 
              id="onboarding-insuranceNumber" 
              formControlName="insuranceNumber" 
              class="form-input"
              maxlength="3"
              pattern="[0-9]*"
              (input)="formatInsuranceNumberInput($event)"
              placeholder="000"
            >
            <div *ngIf="onboardingEmployeeEditForm.get('insuranceNumber')?.invalid && onboardingEmployeeEditForm.get('insuranceNumber')?.touched" class="error-message">
              <span *ngIf="onboardingEmployeeEditForm.get('insuranceNumber')?.errors?.['required']">被保険者番号を入力してください</span>
              <span *ngIf="onboardingEmployeeEditForm.get('insuranceNumber')?.errors?.['pattern']">3桁の数字を入力してください</span>
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-insuranceCardIssueDate">発行日 <span class="required">*</span></label>
            <input 
              type="date" 
              id="onboarding-insuranceCardIssueDate" 
              formControlName="insuranceCardIssueDate" 
              class="form-input"
            >
            <div *ngIf="onboardingEmployeeEditForm.get('insuranceCardIssueDate')?.invalid && onboardingEmployeeEditForm.get('insuranceCardIssueDate')?.touched" class="error-message">
              発行日を入力してください
            </div>
          </div>
          <div class="form-group">
            <label for="onboarding-insuranceCardReturnDate">回収日</label>
            <input 
              type="date" 
              id="onboarding-insuranceCardReturnDate" 
              formControlName="insuranceCardReturnDate" 
              class="form-input"
            >
          </div>
          <div class="form-group">
            <label for="onboarding-insuranceCardDistributionStatus">配布状況 <span class="required">*</span></label>
            <select 
              id="onboarding-insuranceCardDistributionStatus" 
              formControlName="insuranceCardDistributionStatus" 
              class="form-input"
            >
              <option value="">選択してください</option>
              <option *ngFor="let status of insuranceCardStatuses" [value]="status">
                {{ status }}
              </option>
            </select>
            <div *ngIf="onboardingEmployeeEditForm.get('insuranceCardDistributionStatus')?.invalid && onboardingEmployeeEditForm.get('insuranceCardDistributionStatus')?.touched" class="error-message">
              配布状況を選択してください
            </div>
          </div>
        </div>
      </section>

      <!-- 送信ボタン -->
      <div class="modal-actions">
        <button type="button" class="cancel-button" (click)="closeOnboardingEmployeeModal()">
          キャンセル
        </button>
        <button type="submit" class="submit-button" [disabled]="onboardingEmployeeEditForm.invalid || onboardingIsSaving">
          {{ onboardingIsSaving ? '保存中...' : '保存' }}
        </button>
      </div>
    </form>
  </div>
</div>

  <!-- 入社処理実行モーダル -->
  <div *ngIf="showOnboardingProcessModal" class="modal-overlay" (click)="closeOnboardingProcessModal()">
    <div class="modal-content onboarding-process-modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3 class="modal-title">入社処理実行</h3>
        <button class="modal-close" (click)="closeOnboardingProcessModal()">×</button>
      </div>
      
      <div class="modal-body">
        <p class="modal-description">準備完了ステータスの社員を選択して、入社処理を実行してください。</p>
        
        <div class="process-actions">
          <button 
            type="button" 
            class="select-all-button" 
            (click)="toggleAllEmployees()"
          >
            {{ selectedEmployeeNumbers.size === readyEmployees.length ? '全解除' : '全選択' }}
          </button>
        </div>
        
        <div class="ready-employees-list">
          <table class="employee-table">
            <thead>
              <tr>
                <th style="width: 50px;">
                  <input 
                    type="checkbox" 
                    [checked]="selectedEmployeeNumbers.size === readyEmployees.length && readyEmployees.length > 0"
                    (change)="toggleAllEmployees()"
                  >
                </th>
                <th>社員番号</th>
                <th>氏名</th>
                <th>メールアドレス</th>
                <th>雇用形態</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let employee of readyEmployees" class="employee-row">
                <td>
                  <input 
                    type="checkbox" 
                    [checked]="selectedEmployeeNumbers.has(employee.employeeNumber)"
                    (change)="toggleEmployeeSelection(employee.employeeNumber)"
                  >
                </td>
                <td>{{ employee.employeeNumber }}</td>
                <td>{{ employee.name }}</td>
                <td>{{ employee.email }}</td>
                <td>{{ employee.employmentType }}</td>
              </tr>
              <tr *ngIf="readyEmployees.length === 0">
                <td colspan="5" class="empty-message">準備完了の社員がありません</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <div class="modal-actions">
        <button 
          type="button" 
          class="cancel-button" 
          (click)="closeOnboardingProcessModal()"
          [disabled]="isProcessingOnboarding"
        >
          キャンセル
        </button>
        <button 
          type="button" 
          class="submit-button" 
          (click)="executeOnboardingProcess()"
          [disabled]="selectedEmployeeNumbers.size === 0 || isProcessingOnboarding"
        >
          {{ isProcessingOnboarding ? '処理中...' : '入社処理を実行' }}
        </button>
      </div>
    </div>
  </div>


